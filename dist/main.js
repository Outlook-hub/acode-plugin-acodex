(()=>{var Ge=Object.create;var Me=Object.defineProperty;var Xe=Object.getOwnPropertyDescriptor;var Ke=Object.getOwnPropertyNames;var Ve=Object.getPrototypeOf,Ye=Object.prototype.hasOwnProperty;var ce=(q,M)=>()=>(M||q((M={exports:{}}).exports,M),M.exports);var Je=(q,M,P,W)=>{if(M&&typeof M=="object"||typeof M=="function")for(let k of Ke(M))!Ye.call(q,k)&&k!==P&&Me(q,k,{get:()=>M[k],enumerable:!(W=Xe(M,k))||W.enumerable});return q};var de=(q,M,P)=>(P=q!=null?Ge(Ve(q)):{},Je(M||!q||!q.__esModule?Me(P,"default",{value:q,enumerable:!0}):P,q));var Oe=ce((me,Le)=>{(function(q,M){if(typeof me=="object"&&typeof Le=="object")Le.exports=M();else if(typeof define=="function"&&define.amd)define([],M);else{var P=M();for(var W in P)(typeof me=="object"?me:q)[W]=P[W]}})(self,()=>(()=>{"use strict";var q={4567:function(k,t,a){var h=this&&this.__decorate||function(s,d,g,v){var m,c=arguments.length,l=c<3?d:v===null?v=Object.getOwnPropertyDescriptor(d,g):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(s,d,g,v);else for(var S=s.length-1;S>=0;S--)(m=s[S])&&(l=(c<3?m(l):c>3?m(d,g,l):m(d,g))||l);return c>3&&l&&Object.defineProperty(d,g,l),l},u=this&&this.__param||function(s,d){return function(g,v){d(g,v,s)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;let n=a(9042),_=a(6114),p=a(9924),f=a(844),i=a(5596),e=a(4725),r=a(3656),o=class extends f.Disposable{constructor(s,d){super(),this._terminal=s,this._renderService=d,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let g=0;g<this._terminal.rows;g++)this._rowElements[g]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[g]);if(this._topBoundaryFocusListener=g=>this._handleBoundaryFocus(g,0),this._bottomBoundaryFocusListener=g=>this._handleBoundaryFocus(g,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new p.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize(g=>this._handleResize(g.rows))),this.register(this._terminal.onRender(g=>this._refreshRows(g.start,g.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(g=>this._handleChar(g))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(g=>this._handleTab(g))),this.register(this._terminal.onKey(g=>this._handleKey(g.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new i.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,r.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,f.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(s){for(let d=0;d<s;d++)this._handleChar(" ")}_handleChar(s){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==s&&(this._charsToAnnounce+=s):this._charsToAnnounce+=s,s===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=n.tooMuchOutput)),_.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,_.isMac&&this._liveRegion.remove()}_handleKey(s){this._clearLiveRegion(),/\p{Control}/u.test(s)||this._charsToConsume.push(s)}_refreshRows(s,d){this._liveRegionDebouncer.refresh(s,d,this._terminal.rows)}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(s,d){let g=s.target,v=this._rowElements[d===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(d===0?"1":`${this._terminal.buffer.lines.length}`)||s.relatedTarget!==v)return;let m,c;if(d===0?(m=g,c=this._rowElements.pop(),this._rowContainer.removeChild(c)):(m=this._rowElements.shift(),c=g,this._rowContainer.removeChild(m)),m.removeEventListener("focus",this._topBoundaryFocusListener),c.removeEventListener("focus",this._bottomBoundaryFocusListener),d===0){let l=this._createAccessibilityTreeNode();this._rowElements.unshift(l),this._rowContainer.insertAdjacentElement("afterbegin",l)}else{let l=this._createAccessibilityTreeNode();this._rowElements.push(l),this._rowContainer.appendChild(l)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(d===0?-1:1),this._rowElements[d===0?1:this._rowElements.length-2].focus(),s.preventDefault(),s.stopImmediatePropagation()}_handleResize(s){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let d=this._rowContainer.children.length;d<this._terminal.rows;d++)this._rowElements[d]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[d]);for(;this._rowElements.length>s;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let s=document.createElement("div");return s.setAttribute("role","listitem"),s.tabIndex=-1,this._refreshRowDimensions(s),s}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let s=0;s<this._terminal.rows;s++)this._refreshRowDimensions(this._rowElements[s])}}_refreshRowDimensions(s){s.style.height=`${this._renderService.dimensions.css.cell.height}px`}};o=h([u(1,e.IRenderService)],o),t.AccessibilityManager=o},3614:(k,t)=>{function a(_){return _.replace(/\r?\n/g,"\r")}function h(_,p){return p?"\x1B[200~"+_+"\x1B[201~":_}function u(_,p,f){_=h(_=a(_),f.decPrivateModes.bracketedPasteMode),f.triggerDataEvent(_,!0),p.value=""}function n(_,p,f){let i=f.getBoundingClientRect(),e=_.clientX-i.left-10,r=_.clientY-i.top-10;p.style.width="20px",p.style.height="20px",p.style.left=`${e}px`,p.style.top=`${r}px`,p.style.zIndex="1000",p.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=a,t.bracketTextForPaste=h,t.copyHandler=function(_,p){_.clipboardData&&_.clipboardData.setData("text/plain",p.selectionText),_.preventDefault()},t.handlePasteEvent=function(_,p,f){_.stopPropagation(),_.clipboardData&&u(_.clipboardData.getData("text/plain"),p,f)},t.paste=u,t.moveTextAreaUnderMouseCursor=n,t.rightClickHandler=function(_,p,f,i,e){n(_,p,f),e&&i.rightClickSelect(_),p.value=i.selectionText,p.select()}},7239:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;let h=a(1505);t.ColorContrastCache=class{constructor(){this._color=new h.TwoKeyMap,this._css=new h.TwoKeyMap}setCss(u,n,_){this._css.set(u,n,_)}getCss(u,n){return this._css.get(u,n)}setColor(u,n,_){this._color.set(u,n,_)}getColor(u,n){return this._color.get(u,n)}clear(){this._color.clear(),this._css.clear()}}},3656:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(a,h,u,n){a.addEventListener(h,u,n);let _=!1;return{dispose:()=>{_||(_=!0,a.removeEventListener(h,u,n))}}}},6465:function(k,t,a){var h=this&&this.__decorate||function(e,r,o,s){var d,g=arguments.length,v=g<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,o):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(e,r,o,s);else for(var m=e.length-1;m>=0;m--)(d=e[m])&&(v=(g<3?d(v):g>3?d(r,o,v):d(r,o))||v);return g>3&&v&&Object.defineProperty(r,o,v),v},u=this&&this.__param||function(e,r){return function(o,s){r(o,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier2=void 0;let n=a(2585),_=a(8460),p=a(844),f=a(3656),i=class extends p.Disposable{constructor(e){super(),this._bufferService=e,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new _.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new _.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,p.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,p.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}get currentLink(){return this._currentLink}registerLinkProvider(e){return this._linkProviders.push(e),{dispose:()=>{let r=this._linkProviders.indexOf(e);r!==-1&&this._linkProviders.splice(r,1)}}}attachToDom(e,r,o){this._element=e,this._mouseService=r,this._renderService=o,this.register((0,f.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,f.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,f.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,f.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(e){if(this._lastMouseEvent=e,!this._element||!this._mouseService)return;let r=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!r)return;this._isMouseOut=!1;let o=e.composedPath();for(let s=0;s<o.length;s++){let d=o[s];if(d.classList.contains("xterm"))break;if(d.classList.contains("xterm-hover"))return}this._lastBufferCell&&r.x===this._lastBufferCell.x&&r.y===this._lastBufferCell.y||(this._handleHover(r),this._lastBufferCell=r)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(e,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,r){var o,s;this._activeProviderReplies&&r||((o=this._activeProviderReplies)===null||o===void 0||o.forEach(g=>{g?.forEach(v=>{v.link.dispose&&v.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);let d=!1;for(let[g,v]of this._linkProviders.entries())r?!((s=this._activeProviderReplies)===null||s===void 0)&&s.get(g)&&(d=this._checkLinkProviderResult(g,e,d)):v.provideLinks(e.y,m=>{var c,l;if(this._isMouseOut)return;let S=m?.map(b=>({link:b}));(c=this._activeProviderReplies)===null||c===void 0||c.set(g,S),d=this._checkLinkProviderResult(g,e,d),((l=this._activeProviderReplies)===null||l===void 0?void 0:l.size)===this._linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)})}_removeIntersectingLinks(e,r){let o=new Set;for(let s=0;s<r.size;s++){let d=r.get(s);if(d)for(let g=0;g<d.length;g++){let v=d[g],m=v.link.range.start.y<e?0:v.link.range.start.x,c=v.link.range.end.y>e?this._bufferService.cols:v.link.range.end.x;for(let l=m;l<=c;l++){if(o.has(l)){d.splice(g--,1);break}o.add(l)}}}}_checkLinkProviderResult(e,r,o){var s;if(!this._activeProviderReplies)return o;let d=this._activeProviderReplies.get(e),g=!1;for(let v=0;v<e;v++)this._activeProviderReplies.has(v)&&!this._activeProviderReplies.get(v)||(g=!0);if(!g&&d){let v=d.find(m=>this._linkAtPosition(m.link,r));v&&(o=!0,this._handleNewLink(v))}if(this._activeProviderReplies.size===this._linkProviders.length&&!o)for(let v=0;v<this._activeProviderReplies.size;v++){let m=(s=this._activeProviderReplies.get(v))===null||s===void 0?void 0:s.find(c=>this._linkAtPosition(c.link,r));if(m){o=!0,this._handleNewLink(m);break}}return o}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._element||!this._mouseService||!this._currentLink)return;let r=this._positionFromMouseEvent(e,this._element,this._mouseService);r&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,r)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,r){this._element&&this._currentLink&&this._lastMouseEvent&&(!e||!r||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=r)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,p.disposeArray)(this._linkCacheDisposables))}_handleNewLink(e){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;let r=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);r&&this._linkAtPosition(e.link,r)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:e.link.decorations===void 0||e.link.decorations.underline,pointerCursor:e.link.decorations===void 0||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>{var o,s;return(s=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||s===void 0?void 0:s.decorations.pointerCursor},set:o=>{var s,d;!((s=this._currentLink)===null||s===void 0)&&s.state&&this._currentLink.state.decorations.pointerCursor!==o&&(this._currentLink.state.decorations.pointerCursor=o,this._currentLink.state.isHovered&&((d=this._element)===null||d===void 0||d.classList.toggle("xterm-cursor-pointer",o)))}},underline:{get:()=>{var o,s;return(s=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||s===void 0?void 0:s.decorations.underline},set:o=>{var s,d,g;!((s=this._currentLink)===null||s===void 0)&&s.state&&((g=(d=this._currentLink)===null||d===void 0?void 0:d.state)===null||g===void 0?void 0:g.decorations.underline)!==o&&(this._currentLink.state.decorations.underline=o,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,o))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(o=>{if(!this._currentLink)return;let s=o.start===0?0:o.start+1+this._bufferService.buffer.ydisp,d=this._bufferService.buffer.ydisp+1+o.end;if(this._currentLink.link.range.start.y>=s&&this._currentLink.link.range.end.y<=d&&(this._clearCurrentLink(s,d),this._lastMouseEvent&&this._element)){let g=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);g&&this._askForLink(g,!1)}})))}_linkHover(e,r,o){var s;!((s=this._currentLink)===null||s===void 0)&&s.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(r,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),r.hover&&r.hover(o,r.text)}_fireUnderlineEvent(e,r){let o=e.range,s=this._bufferService.buffer.ydisp,d=this._createLinkUnderlineEvent(o.start.x-1,o.start.y-s-1,o.end.x,o.end.y-s-1,void 0);(r?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(d)}_linkLeave(e,r,o){var s;!((s=this._currentLink)===null||s===void 0)&&s.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(r,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),r.leave&&r.leave(o,r.text)}_linkAtPosition(e,r){let o=e.range.start.y*this._bufferService.cols+e.range.start.x,s=e.range.end.y*this._bufferService.cols+e.range.end.x,d=r.y*this._bufferService.cols+r.x;return o<=d&&d<=s}_positionFromMouseEvent(e,r,o){let s=o.getCoords(e,r,this._bufferService.cols,this._bufferService.rows);if(s)return{x:s[0],y:s[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,r,o,s,d){return{x1:e,y1:r,x2:o,y2:s,cols:this._bufferService.cols,fg:d}}};i=h([u(0,n.IBufferService)],i),t.Linkifier2=i},9042:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(k,t,a){var h=this&&this.__decorate||function(i,e,r,o){var s,d=arguments.length,g=d<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,r):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(i,e,r,o);else for(var v=i.length-1;v>=0;v--)(s=i[v])&&(g=(d<3?s(g):d>3?s(e,r,g):s(e,r))||g);return d>3&&g&&Object.defineProperty(e,r,g),g},u=this&&this.__param||function(i,e){return function(r,o){e(r,o,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;let n=a(511),_=a(2585),p=class{constructor(i,e,r){this._bufferService=i,this._optionsService=e,this._oscLinkService=r}provideLinks(i,e){var r;let o=this._bufferService.buffer.lines.get(i-1);if(!o)return void e(void 0);let s=[],d=this._optionsService.rawOptions.linkHandler,g=new n.CellData,v=o.getTrimmedLength(),m=-1,c=-1,l=!1;for(let S=0;S<v;S++)if(c!==-1||o.hasContent(S)){if(o.loadCell(S,g),g.hasExtendedAttrs()&&g.extended.urlId){if(c===-1){c=S,m=g.extended.urlId;continue}l=g.extended.urlId!==m}else c!==-1&&(l=!0);if(l||c!==-1&&S===v-1){let b=(r=this._oscLinkService.getLinkData(m))===null||r===void 0?void 0:r.uri;if(b){let w={start:{x:c+1,y:i},end:{x:S+(l||S!==v-1?0:1),y:i}},y=!1;if(!d?.allowNonHttpProtocols)try{let D=new URL(b);["http:","https:"].includes(D.protocol)||(y=!0)}catch{y=!0}y||s.push({text:b,range:w,activate:(D,B)=>d?d.activate(D,B,w):f(0,B),hover:(D,B)=>{var O;return(O=d?.hover)===null||O===void 0?void 0:O.call(d,D,B,w)},leave:(D,B)=>{var O;return(O=d?.leave)===null||O===void 0?void 0:O.call(d,D,B,w)}})}l=!1,g.hasExtendedAttrs()&&g.extended.urlId?(c=S,m=g.extended.urlId):(c=-1,m=-1)}}e(s)}};function f(i,e){if(confirm(`Do you want to navigate to ${e}?

WARNING: This link could potentially be dangerous`)){let r=window.open();if(r){try{r.opener=null}catch{}r.location.href=e}else console.warn("Opening link blocked as opener could not be cleared")}}p=h([u(0,_.IBufferService),u(1,_.IOptionsService),u(2,_.IOscLinkService)],p),t.OscLinkProvider=p},6193:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(a,h){this._parentWindow=a,this._renderCallback=h,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(a){return this._refreshCallbacks.push(a),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(a,h,u){this._rowCount=u,a=a!==void 0?a:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();let a=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,h),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let a of this._refreshCallbacks)a(0);this._refreshCallbacks=[]}}},5596:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenDprMonitor=void 0;let h=a(844);class u extends h.Disposable{constructor(_){super(),this._parentWindow=_,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,h.toDisposable)(()=>{this.clearListener()}))}setListener(_){this._listener&&this.clearListener(),this._listener=_,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var _;this._outerListener&&((_=this._resolutionMediaMatchList)===null||_===void 0||_.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}t.ScreenDprMonitor=u},3236:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;let h=a(2950),u=a(1680),n=a(3614),_=a(2584),p=a(5435),f=a(9312),i=a(6114),e=a(3656),r=a(9042),o=a(4567),s=a(1296),d=a(7399),g=a(8460),v=a(8437),m=a(3230),c=a(4725),l=a(428),S=a(8934),b=a(6465),w=a(5114),y=a(8969),D=a(8055),B=a(4269),O=a(5941),C=a(3107),L=a(5744),E=a(9074),x=a(2585),I=a(3730),N=a(844),j=a(6731),H=typeof window<"u"?window.document:null;class z extends y.CoreTerminal{constructor(A={}){super(A),this.browser=i,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new g.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new g.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new g.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new g.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new g.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new g.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new g.EventEmitter),this._onBlur=this.register(new g.EventEmitter),this._onA11yCharEmitter=this.register(new g.EventEmitter),this._onA11yTabEmitter=this.register(new g.EventEmitter),this._onWillOpen=this.register(new g.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(b.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(I.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(E.DecorationService),this._instantiationService.setService(x.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((T,F)=>this.refresh(T,F))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(T=>this._reportWindowsOptions(T))),this.register(this._inputHandler.onColor(T=>this._handleColorEvent(T))),this.register((0,g.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,g.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,g.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,g.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(T=>this._afterResize(T.cols,T.rows))),this.register((0,N.toDisposable)(()=>{var T,F;this._customKeyEventHandler=void 0,(F=(T=this.element)===null||T===void 0?void 0:T.parentNode)===null||F===void 0||F.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(A){if(this._themeService)for(let T of A){let F,U="";switch(T.index){case 256:F="foreground",U="10";break;case 257:F="background",U="11";break;case 258:F="cursor",U="12";break;default:F="ansi",U="4;"+T.index}switch(T.type){case 0:let V=D.color.toColorRGB(F==="ansi"?this._themeService.colors.ansi[T.index]:this._themeService.colors[F]);this.coreService.triggerDataEvent(`${_.C0.ESC}]${U};${(0,O.toRgbString)(V)}${_.C1_ESCAPED.ST}`);break;case 1:if(F==="ansi")this._themeService.modifyColors($=>$.ansi[T.index]=D.rgba.toColor(...T.color));else{let $=F;this._themeService.modifyColors(te=>te[$]=D.rgba.toColor(...T.color))}break;case 2:this._themeService.restoreColor(T.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(A){var T;A?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(o.AccessibilityManager,this)):((T=this._accessibilityManager)===null||T===void 0||T.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(A){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(_.C0.ESC+"[I"),this.updateCursorStyle(A),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var A;return(A=this.textarea)===null||A===void 0?void 0:A.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(_.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let A=this.buffer.ybase+this.buffer.y,T=this.buffer.lines.get(A);if(!T)return;let F=Math.min(this.buffer.x,this.cols-1),U=this._renderService.dimensions.css.cell.height,V=T.getWidth(F),$=this._renderService.dimensions.css.cell.width*V,te=this.buffer.y*this._renderService.dimensions.css.cell.height,ie=F*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ie+"px",this.textarea.style.top=te+"px",this.textarea.style.width=$+"px",this.textarea.style.height=U+"px",this.textarea.style.lineHeight=U+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,e.addDisposableDomListener)(this.element,"copy",T=>{this.hasSelection()&&(0,n.copyHandler)(T,this._selectionService)}));let A=T=>(0,n.handlePasteEvent)(T,this.textarea,this.coreService);this.register((0,e.addDisposableDomListener)(this.textarea,"paste",A)),this.register((0,e.addDisposableDomListener)(this.element,"paste",A)),i.isFirefox?this.register((0,e.addDisposableDomListener)(this.element,"mousedown",T=>{T.button===2&&(0,n.rightClickHandler)(T,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,e.addDisposableDomListener)(this.element,"contextmenu",T=>{(0,n.rightClickHandler)(T,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),i.isLinux&&this.register((0,e.addDisposableDomListener)(this.element,"auxclick",T=>{T.button===1&&(0,n.moveTextAreaUnderMouseCursor)(T,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,e.addDisposableDomListener)(this.textarea,"keyup",A=>this._keyUp(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"keydown",A=>this._keyDown(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"keypress",A=>this._keyPress(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionupdate",A=>this._compositionHelper.compositionupdate(A))),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,e.addDisposableDomListener)(this.textarea,"input",A=>this._inputEvent(A),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(A){var T;if(!A)throw new Error("Terminal requires a parent element.");A.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=A.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),A.appendChild(this.element);let F=H.createDocumentFragment();this._viewportElement=H.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),F.appendChild(this._viewportElement),this._viewportScrollArea=H.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=H.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=H.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),F.appendChild(this.screenElement),this.textarea=H.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",r.promptLabel),i.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(w.CoreBrowserService,this.textarea,(T=this._document.defaultView)!==null&&T!==void 0?T:window),this._instantiationService.setService(c.ICoreBrowserService,this._coreBrowserService),this.register((0,e.addDisposableDomListener)(this.textarea,"focus",U=>this._handleTextAreaFocus(U))),this.register((0,e.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(l.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(c.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(j.ThemeService),this._instantiationService.setService(c.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(B.CharacterJoinerService),this._instantiationService.setService(c.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(m.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(c.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(U=>this._onRender.fire(U))),this.onResize(U=>this._renderService.resize(U.cols,U.rows)),this._compositionView=H.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(h.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(F);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(S.MouseService),this._instantiationService.setService(c.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(u.Viewport,U=>this.scrollLines(U,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(f.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(c.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(U=>this.scrollLines(U.amount,U.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(U=>this._renderService.handleSelectionChanged(U.start,U.end,U.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(U=>{this.textarea.value=U,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(U=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,e.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(C.BufferDecorationRenderer,this.screenElement)),this.register((0,e.addDisposableDomListener)(this.element,"mousedown",U=>this._selectionService.handleMouseDown(U))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(o.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",U=>this._handleScreenReaderModeOptionChange(U))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(L.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",U=>{!this._overviewRulerRenderer&&U&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(L.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(s.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){let A=this,T=this.element;function F($){let te=A._mouseService.getMouseReportCoords($,A.screenElement);if(!te)return!1;let ie,Q;switch($.overrideType||$.type){case"mousemove":Q=32,$.buttons===void 0?(ie=3,$.button!==void 0&&(ie=$.button<3?$.button:3)):ie=1&$.buttons?0:4&$.buttons?1:2&$.buttons?2:3;break;case"mouseup":Q=0,ie=$.button<3?$.button:3;break;case"mousedown":Q=1,ie=$.button<3?$.button:3;break;case"wheel":if(A.viewport.getLinesScrolled($)===0)return!1;Q=$.deltaY<0?0:1,ie=4;break;default:return!1}return!(Q===void 0||ie===void 0||ie>4)&&A.coreMouseService.triggerMouseEvent({col:te.col,row:te.row,x:te.x,y:te.y,button:ie,action:Q,ctrl:$.ctrlKey,alt:$.altKey,shift:$.shiftKey})}let U={mouseup:null,wheel:null,mousedrag:null,mousemove:null},V={mouseup:$=>(F($),$.buttons||(this._document.removeEventListener("mouseup",U.mouseup),U.mousedrag&&this._document.removeEventListener("mousemove",U.mousedrag)),this.cancel($)),wheel:$=>(F($),this.cancel($,!0)),mousedrag:$=>{$.buttons&&F($)},mousemove:$=>{$.buttons||F($)}};this.register(this.coreMouseService.onProtocolChange($=>{$?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents($)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&$?U.mousemove||(T.addEventListener("mousemove",V.mousemove),U.mousemove=V.mousemove):(T.removeEventListener("mousemove",U.mousemove),U.mousemove=null),16&$?U.wheel||(T.addEventListener("wheel",V.wheel,{passive:!1}),U.wheel=V.wheel):(T.removeEventListener("wheel",U.wheel),U.wheel=null),2&$?U.mouseup||(U.mouseup=V.mouseup):(this._document.removeEventListener("mouseup",U.mouseup),U.mouseup=null),4&$?U.mousedrag||(U.mousedrag=V.mousedrag):(this._document.removeEventListener("mousemove",U.mousedrag),U.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,e.addDisposableDomListener)(T,"mousedown",$=>{if($.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection($))return F($),U.mouseup&&this._document.addEventListener("mouseup",U.mouseup),U.mousedrag&&this._document.addEventListener("mousemove",U.mousedrag),this.cancel($)})),this.register((0,e.addDisposableDomListener)(T,"wheel",$=>{if(!U.wheel){if(!this.buffer.hasScrollback){let te=this.viewport.getLinesScrolled($);if(te===0)return;let ie=_.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+($.deltaY<0?"A":"B"),Q="";for(let X=0;X<Math.abs(te);X++)Q+=ie;return this.coreService.triggerDataEvent(Q,!0),this.cancel($,!0)}return this.viewport.handleWheel($)?this.cancel($):void 0}},{passive:!1})),this.register((0,e.addDisposableDomListener)(T,"touchstart",$=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart($),this.cancel($)},{passive:!0})),this.register((0,e.addDisposableDomListener)(T,"touchmove",$=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove($)?void 0:this.cancel($)},{passive:!1}))}refresh(A,T){var F;(F=this._renderService)===null||F===void 0||F.refreshRows(A,T)}updateCursorStyle(A){var T;!((T=this._selectionService)===null||T===void 0)&&T.shouldColumnSelect(A)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(A,T,F=0){super.scrollLines(A,T,F),this.refresh(0,this.rows-1)}paste(A){(0,n.paste)(A,this.textarea,this.coreService)}attachCustomKeyEventHandler(A){this._customKeyEventHandler=A}registerLinkProvider(A){return this.linkifier2.registerLinkProvider(A)}registerCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let T=this._characterJoinerService.register(A);return this.refresh(0,this.rows-1),T}deregisterCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(A)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(A){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+A)}registerDecoration(A){return this._decorationService.registerDecoration(A)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(A,T,F){this._selectionService.setSelection(A,T,F)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var A;(A=this._selectionService)===null||A===void 0||A.clearSelection()}selectAll(){var A;(A=this._selectionService)===null||A===void 0||A.selectAll()}selectLines(A,T){var F;(F=this._selectionService)===null||F===void 0||F.selectLines(A,T)}_keyDown(A){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;let T=this.browser.isMac&&this.options.macOptionIsMeta&&A.altKey;if(!T&&!this._compositionHelper.keydown(A))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;T||A.key!=="Dead"&&A.key!=="AltGraph"||(this._unprocessedDeadKey=!0);let F=(0,d.evaluateKeyboardEvent)(A,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(A),F.type===3||F.type===2){let U=this.rows-1;return this.scrollLines(F.type===2?-U:U),this.cancel(A,!0)}return F.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,A)||(F.cancel&&this.cancel(A,!0),!F.key||!!(A.key&&!A.ctrlKey&&!A.altKey&&!A.metaKey&&A.key.length===1&&A.key.charCodeAt(0)>=65&&A.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(F.key!==_.C0.ETX&&F.key!==_.C0.CR||(this.textarea.value=""),this._onKey.fire({key:F.key,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(F.key,!0),!this.optionsService.rawOptions.screenReaderMode||A.altKey||A.ctrlKey?this.cancel(A,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(A,T){let F=A.isMac&&!this.options.macOptionIsMeta&&T.altKey&&!T.ctrlKey&&!T.metaKey||A.isWindows&&T.altKey&&T.ctrlKey&&!T.metaKey||A.isWindows&&T.getModifierState("AltGraph");return T.type==="keypress"?F:F&&(!T.keyCode||T.keyCode>47)}_keyUp(A){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1||(function(T){return T.keyCode===16||T.keyCode===17||T.keyCode===18}(A)||this.focus(),this.updateCursorStyle(A),this._keyPressHandled=!1)}_keyPress(A){let T;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;if(this.cancel(A),A.charCode)T=A.charCode;else if(A.which===null||A.which===void 0)T=A.keyCode;else{if(A.which===0||A.charCode===0)return!1;T=A.which}return!(!T||(A.altKey||A.ctrlKey||A.metaKey)&&!this._isThirdLevelShift(this.browser,A)||(T=String.fromCharCode(T),this._onKey.fire({key:T,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(T,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(A){if(A.data&&A.inputType==="insertText"&&(!A.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let T=A.data;return this.coreService.triggerDataEvent(T,!0),this.cancel(A),!0}return!1}resize(A,T){A!==this.cols||T!==this.rows?super.resize(A,T):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(A,T){var F,U;(F=this._charSizeService)===null||F===void 0||F.measure(),(U=this.viewport)===null||U===void 0||U.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let A=1;A<this.rows;A++)this.buffer.lines.push(this.buffer.getBlankLine(v.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var A,T;this.options.rows=this.rows,this.options.cols=this.cols;let F=this._customKeyEventHandler;this._setup(),super.reset(),(A=this._selectionService)===null||A===void 0||A.reset(),this._decorationService.reset(),this._customKeyEventHandler=F,this.refresh(0,this.rows-1),(T=this.viewport)===null||T===void 0||T.syncScrollArea()}clearTextureAtlas(){var A;(A=this._renderService)===null||A===void 0||A.clearTextureAtlas()}_reportFocus(){var A;!((A=this.element)===null||A===void 0)&&A.classList.contains("focus")?this.coreService.triggerDataEvent(_.C0.ESC+"[I"):this.coreService.triggerDataEvent(_.C0.ESC+"[O")}_reportWindowsOptions(A){if(this._renderService)switch(A){case p.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:let T=this._renderService.dimensions.css.canvas.width.toFixed(0),F=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${_.C0.ESC}[4;${F};${T}t`);break;case p.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:let U=this._renderService.dimensions.css.cell.width.toFixed(0),V=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${_.C0.ESC}[6;${V};${U}t`)}}cancel(A,T){if(this.options.cancelEvents||T)return A.preventDefault(),A.stopPropagation(),!1}}t.Terminal=z},9924:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(a,h=1e3){this._renderCallback=a,this._debounceThresholdMS=h,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(a,h,u){this._rowCount=u,a=a!==void 0?a:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h;let n=Date.now();if(n-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=n,this._innerRefresh();else if(!this._additionalRefreshRequested){let _=n-this._lastRefreshMs,p=this._debounceThresholdMS-_;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},p)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let a=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,h)}}},1680:function(k,t,a){var h=this&&this.__decorate||function(e,r,o,s){var d,g=arguments.length,v=g<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,o):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(e,r,o,s);else for(var m=e.length-1;m>=0;m--)(d=e[m])&&(v=(g<3?d(v):g>3?d(r,o,v):d(r,o))||v);return g>3&&v&&Object.defineProperty(r,o,v),v},u=this&&this.__param||function(e,r){return function(o,s){r(o,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;let n=a(844),_=a(3656),p=a(4725),f=a(2585),i=class extends n.Disposable{constructor(e,r,o,s,d,g,v,m,c){super(),this._scrollLines=e,this._viewportElement=r,this._scrollArea=o,this._bufferService=s,this._optionsService=d,this._charSizeService=g,this._renderService=v,this._coreBrowserService=m,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,_.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(l=>this._activeBuffer=l.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(l=>this._renderDimensions=l)),this._handleThemeChange(c.colors),this.register(c.onChangeColors(l=>this._handleThemeChange(l))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(e){this._viewportElement.style.backgroundColor=e.background.css}_refresh(e){if(e)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;let r=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==r&&(this._lastRecordedBufferHeight=r,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}let e=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==e&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=e),this._refreshAnimationFrame=null}syncScrollArea(e=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}_handleScroll(e){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);let r=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(r)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;let e=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(e*(this._smoothScrollState.target-this._smoothScrollState.origin)),e<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(e,r){let o=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(r<0&&this._viewportElement.scrollTop!==0||r>0&&o<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}handleWheel(e){let r=this._getPixelsScrolled(e);return r!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+r:this._smoothScrollState.target+=r,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=r,this._bubbleScroll(e,r))}_getPixelsScrolled(e){if(e.deltaY===0||e.shiftKey)return 0;let r=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?r*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._currentRowHeight*this._bufferService.rows),r}getBufferElements(e,r){var o;let s,d="",g=[],v=r??this._bufferService.buffer.lines.length,m=this._bufferService.buffer.lines;for(let c=e;c<v;c++){let l=m.get(c);if(!l)continue;let S=(o=m.get(c+1))===null||o===void 0?void 0:o.isWrapped;if(d+=l.translateToString(!S),!S||c===m.length-1){let b=document.createElement("div");b.textContent=d,g.push(b),d.length>0&&(s=b),d=""}}return{bufferElements:g,cursorElement:s}}getLinesScrolled(e){if(e.deltaY===0||e.shiftKey)return 0;let r=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(r/=this._currentRowHeight+0,this._wheelPartialScroll+=r,r=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._bufferService.rows),r}_applyScrollModifier(e,r){let o=this._optionsService.rawOptions.fastScrollModifier;return o==="alt"&&r.altKey||o==="ctrl"&&r.ctrlKey||o==="shift"&&r.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(e){this._lastTouchY=e.touches[0].pageY}handleTouchMove(e){let r=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,r!==0&&(this._viewportElement.scrollTop+=r,this._bubbleScroll(e,r))}};i=h([u(3,f.IBufferService),u(4,f.IOptionsService),u(5,p.ICharSizeService),u(6,p.IRenderService),u(7,p.ICoreBrowserService),u(8,p.IThemeService)],i),t.Viewport=i},3107:function(k,t,a){var h=this&&this.__decorate||function(e,r,o,s){var d,g=arguments.length,v=g<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,o):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(e,r,o,s);else for(var m=e.length-1;m>=0;m--)(d=e[m])&&(v=(g<3?d(v):g>3?d(r,o,v):d(r,o))||v);return g>3&&v&&Object.defineProperty(r,o,v),v},u=this&&this.__param||function(e,r){return function(o,s){r(o,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;let n=a(3656),_=a(4725),p=a(844),f=a(2585),i=class extends p.Disposable{constructor(e,r,o,s){super(),this._screenElement=e,this._bufferService=r,this._decorationService=o,this._renderService=s,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,n.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(d=>this._removeDecoration(d))),this.register((0,p.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){var r,o;let s=document.createElement("div");s.classList.add("xterm-decoration"),s.classList.toggle("xterm-decoration-top-layer",((r=e?.options)===null||r===void 0?void 0:r.layer)==="top"),s.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,s.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",s.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",s.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let d=(o=e.options.x)!==null&&o!==void 0?o:0;return d&&d>this._bufferService.cols&&(s.style.display="none"),this._refreshXPosition(e,s),s}_refreshStyle(e){let r=e.marker.line-this._bufferService.buffers.active.ydisp;if(r<0||r>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let o=this._decorationElements.get(e);o||(o=this._createElement(e),e.element=o,this._decorationElements.set(e,o),this._container.appendChild(o)),o.style.top=r*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(o)}}_refreshXPosition(e,r=e.element){var o;if(!r)return;let s=(o=e.options.x)!==null&&o!==void 0?o:0;(e.options.anchor||"left")==="right"?r.style.right=s?s*this._renderService.dimensions.css.cell.width+"px":"":r.style.left=s?s*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(e){var r;(r=this._decorationElements.get(e))===null||r===void 0||r.remove(),this._decorationElements.delete(e),e.dispose()}};i=h([u(1,f.IBufferService),u(2,f.IDecorationService),u(3,_.IRenderService)],i),t.BufferDecorationRenderer=i},5871:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(a){if(a.options.overviewRulerOptions){for(let h of this._zones)if(h.color===a.options.overviewRulerOptions.color&&h.position===a.options.overviewRulerOptions.position){if(this._lineIntersectsZone(h,a.marker.line))return;if(this._lineAdjacentToZone(h,a.marker.line,a.options.overviewRulerOptions.position))return void this._addLineToZone(h,a.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=a.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=a.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=a.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=a.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:a.options.overviewRulerOptions.color,position:a.options.overviewRulerOptions.position,startBufferLine:a.marker.line,endBufferLine:a.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(a){this._linePadding=a}_lineIntersectsZone(a,h){return h>=a.startBufferLine&&h<=a.endBufferLine}_lineAdjacentToZone(a,h,u){return h>=a.startBufferLine-this._linePadding[u||"full"]&&h<=a.endBufferLine+this._linePadding[u||"full"]}_addLineToZone(a,h){a.startBufferLine=Math.min(a.startBufferLine,h),a.endBufferLine=Math.max(a.endBufferLine,h)}}},5744:function(k,t,a){var h=this&&this.__decorate||function(d,g,v,m){var c,l=arguments.length,S=l<3?g:m===null?m=Object.getOwnPropertyDescriptor(g,v):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(d,g,v,m);else for(var b=d.length-1;b>=0;b--)(c=d[b])&&(S=(l<3?c(S):l>3?c(g,v,S):c(g,v))||S);return l>3&&S&&Object.defineProperty(g,v,S),S},u=this&&this.__param||function(d,g){return function(v,m){g(v,m,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;let n=a(5871),_=a(3656),p=a(4725),f=a(844),i=a(2585),e={full:0,left:0,center:0,right:0},r={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0},s=class extends f.Disposable{constructor(d,g,v,m,c,l,S){var b;super(),this._viewportElement=d,this._screenElement=g,this._bufferService=v,this._decorationService=m,this._renderService=c,this._optionsService=l,this._coreBrowseService=S,this._colorZoneStore=new n.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(b=this._viewportElement.parentElement)===null||b===void 0||b.insertBefore(this._canvas,this._viewportElement);let w=this._canvas.getContext("2d");if(!w)throw new Error("Ctx cannot be null");this._ctx=w,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,f.toDisposable)(()=>{var y;(y=this._canvas)===null||y===void 0||y.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,_.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){let d=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);r.full=this._canvas.width,r.left=d,r.center=g,r.right=d,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=r.left,o.right=r.left+r.center}_refreshDrawHeightConstants(){e.full=Math.round(2*this._coreBrowseService.dpr);let d=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(d,12),6)*this._coreBrowseService.dpr);e.left=g,e.center=g,e.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;let d=this._colorZoneStore.zones;for(let g of d)g.position!=="full"&&this._renderColorZone(g);for(let g of d)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(d){this._ctx.fillStyle=d.color,this._ctx.fillRect(o[d.position||"full"],Math.round((this._canvas.height-1)*(d.startBufferLine/this._bufferService.buffers.active.lines.length)-e[d.position||"full"]/2),r[d.position||"full"],Math.round((this._canvas.height-1)*((d.endBufferLine-d.startBufferLine)/this._bufferService.buffers.active.lines.length)+e[d.position||"full"]))}_queueRefresh(d,g){this._shouldUpdateDimensions=d||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};s=h([u(2,i.IBufferService),u(3,i.IDecorationService),u(4,p.IRenderService),u(5,i.IOptionsService),u(6,p.ICoreBrowserService)],s),t.OverviewRulerRenderer=s},2950:function(k,t,a){var h=this&&this.__decorate||function(i,e,r,o){var s,d=arguments.length,g=d<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,r):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(i,e,r,o);else for(var v=i.length-1;v>=0;v--)(s=i[v])&&(g=(d<3?s(g):d>3?s(e,r,g):s(e,r))||g);return d>3&&g&&Object.defineProperty(e,r,g),g},u=this&&this.__param||function(i,e){return function(r,o){e(r,o,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;let n=a(4725),_=a(2585),p=a(2584),f=class{constructor(i,e,r,o,s,d){this._textarea=i,this._compositionView=e,this._bufferService=r,this._optionsService=o,this._coreService=s,this._renderService=d,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(i){this._compositionView.textContent=i.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(i){if(this._isComposing||this._isSendingComposition){if(i.keyCode===229||i.keyCode===16||i.keyCode===17||i.keyCode===18)return!1;this._finalizeComposition(!1)}return i.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(i){if(this._compositionView.classList.remove("active"),this._isComposing=!1,i){let e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let r;this._isSendingComposition=!1,e.start+=this._dataAlreadySent.length,r=this._isComposing?this._textarea.value.substring(e.start,e.end):this._textarea.value.substring(e.start),r.length>0&&this._coreService.triggerDataEvent(r,!0)}},0)}else{this._isSendingComposition=!1;let e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){let i=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let e=this._textarea.value,r=e.replace(i,"");this._dataAlreadySent=r,e.length>i.length?this._coreService.triggerDataEvent(r,!0):e.length<i.length?this._coreService.triggerDataEvent(`${p.C0.DEL}`,!0):e.length===i.length&&e!==i&&this._coreService.triggerDataEvent(e,!0)}},0)}updateCompositionElements(i){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),r=this._renderService.dimensions.css.cell.height,o=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,s=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=s+"px",this._compositionView.style.top=o+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let d=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=o+"px",this._textarea.style.width=Math.max(d.width,1)+"px",this._textarea.style.height=Math.max(d.height,1)+"px",this._textarea.style.lineHeight=d.height+"px"}i||setTimeout(()=>this.updateCompositionElements(!0),0)}}};f=h([u(2,_.IBufferService),u(3,_.IOptionsService),u(4,_.ICoreService),u(5,n.IRenderService)],f),t.CompositionHelper=f},9806:(k,t)=>{function a(h,u,n){let _=n.getBoundingClientRect(),p=h.getComputedStyle(n),f=parseInt(p.getPropertyValue("padding-left")),i=parseInt(p.getPropertyValue("padding-top"));return[u.clientX-_.left-f,u.clientY-_.top-i]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=a,t.getCoords=function(h,u,n,_,p,f,i,e,r){if(!f)return;let o=a(h,u,n);return o?(o[0]=Math.ceil((o[0]+(r?i/2:0))/i),o[1]=Math.ceil(o[1]/e),o[0]=Math.min(Math.max(o[0],1),_+(r?1:0)),o[1]=Math.min(Math.max(o[1],1),p),o):void 0}},9504:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;let h=a(2584);function u(e,r,o,s){let d=e-n(e,o),g=r-n(r,o),v=Math.abs(d-g)-function(m,c,l){let S=0,b=m-n(m,l),w=c-n(c,l);for(let y=0;y<Math.abs(b-w);y++){let D=_(m,c)==="A"?-1:1,B=l.buffer.lines.get(b+D*y);B?.isWrapped&&S++}return S}(e,r,o);return i(v,f(_(e,r),s))}function n(e,r){let o=0,s=r.buffer.lines.get(e),d=s?.isWrapped;for(;d&&e>=0&&e<r.rows;)o++,s=r.buffer.lines.get(--e),d=s?.isWrapped;return o}function _(e,r){return e>r?"A":"B"}function p(e,r,o,s,d,g){let v=e,m=r,c="";for(;v!==o||m!==s;)v+=d?1:-1,d&&v>g.cols-1?(c+=g.buffer.translateBufferLineToString(m,!1,e,v),v=0,e=0,m++):!d&&v<0&&(c+=g.buffer.translateBufferLineToString(m,!1,0,e+1),v=g.cols-1,e=v,m--);return c+g.buffer.translateBufferLineToString(m,!1,e,v)}function f(e,r){let o=r?"O":"[";return h.C0.ESC+o+e}function i(e,r){e=Math.floor(e);let o="";for(let s=0;s<e;s++)o+=r;return o}t.moveToCellSequence=function(e,r,o,s){let d=o.buffer.x,g=o.buffer.y;if(!o.buffer.hasScrollback)return function(c,l,S,b,w,y){return u(l,b,w,y).length===0?"":i(p(c,l,c,l-n(l,w),!1,w).length,f("D",y))}(d,g,0,r,o,s)+u(g,r,o,s)+function(c,l,S,b,w,y){let D;D=u(l,b,w,y).length>0?b-n(b,w):l;let B=b,O=function(C,L,E,x,I,N){let j;return j=u(E,x,I,N).length>0?x-n(x,I):L,C<E&&j<=x||C>=E&&j<x?"C":"D"}(c,l,S,b,w,y);return i(p(c,D,S,B,O==="C",w).length,f(O,y))}(d,g,e,r,o,s);let v;if(g===r)return v=d>e?"D":"C",i(Math.abs(d-e),f(v,s));v=g>r?"D":"C";let m=Math.abs(g-r);return i(function(c,l){return l.cols-c}(g>r?e:d,o)+(m-1)*o.cols+1+((g>r?d:e)-1),f(v,s))}},1296:function(k,t,a){var h=this&&this.__decorate||function(m,c,l,S){var b,w=arguments.length,y=w<3?c:S===null?S=Object.getOwnPropertyDescriptor(c,l):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(m,c,l,S);else for(var D=m.length-1;D>=0;D--)(b=m[D])&&(y=(w<3?b(y):w>3?b(c,l,y):b(c,l))||y);return w>3&&y&&Object.defineProperty(c,l,y),y},u=this&&this.__param||function(m,c){return function(l,S){c(l,S,m)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;let n=a(3787),_=a(2223),p=a(6171),f=a(4725),i=a(8055),e=a(8460),r=a(844),o=a(2585),s="xterm-dom-renderer-owner-",d="xterm-focus",g=1,v=class extends r.Disposable{constructor(m,c,l,S,b,w,y,D,B,O){super(),this._element=m,this._screenElement=c,this._viewportElement=l,this._linkifier2=S,this._charSizeService=w,this._optionsService=y,this._bufferService=D,this._coreBrowserService=B,this._themeService=O,this._terminalClass=g++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new e.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,p.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(C=>this._injectCss(C))),this._injectCss(this._themeService.colors),this._rowFactory=b.createInstance(n.DomRendererRowFactory,document),this._element.classList.add(s+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(C=>this._handleLinkHover(C))),this.register(this._linkifier2.onHideLinkUnderline(C=>this._handleLinkLeave(C))),this.register((0,r.toDisposable)(()=>{this._element.classList.remove(s+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))}_updateDimensions(){let m=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*m,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*m),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/m),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/m),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let l of this._rowElements)l.style.width=`${this.dimensions.css.canvas.width}px`,l.style.height=`${this.dimensions.css.cell.height}px`,l.style.lineHeight=`${this.dimensions.css.cell.height}px`,l.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let c=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=c,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(m){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let c=`${this._terminalSelector} .xterm-rows { color: ${m.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;c+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${i.color.multiplyOpacity(m.foreground,.5).css};}`,c+=`${this._terminalSelector} span:not(.${n.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${n.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${n.ITALIC_CLASS} { font-style: italic;}`,c+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",c+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${m.cursor.css};  color: ${m.cursorAccent.css}; } 50% {  background-color: ${m.cursorAccent.css};  color: ${m.cursor.css}; }}`,c+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${m.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${n.CURSOR_CLASS}.${n.CURSOR_BLINK_CLASS}:not(.${n.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${n.CURSOR_CLASS}.${n.CURSOR_BLINK_CLASS}.${n.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${m.cursor.css}; color: ${m.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${m.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${m.cursor.css} inset;}`,c+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${m.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${m.selectionInactiveBackgroundOpaque.css};}`;for(let[l,S]of m.ansi.entries())c+=`${this._terminalSelector} .xterm-fg-${l} { color: ${S.css}; }${this._terminalSelector} .xterm-fg-${l}.${n.DIM_CLASS} { color: ${i.color.multiplyOpacity(S,.5).css}; }${this._terminalSelector} .xterm-bg-${l} { background-color: ${S.css}; }`;c+=`${this._terminalSelector} .xterm-fg-${_.INVERTED_DEFAULT_COLOR} { color: ${i.color.opaque(m.background).css}; }${this._terminalSelector} .xterm-fg-${_.INVERTED_DEFAULT_COLOR}.${n.DIM_CLASS} { color: ${i.color.multiplyOpacity(i.color.opaque(m.background),.5).css}; }${this._terminalSelector} .xterm-bg-${_.INVERTED_DEFAULT_COLOR} { background-color: ${m.foreground.css}; }`,this._themeStyleElement.textContent=c}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(m,c){for(let l=this._rowElements.length;l<=c;l++){let S=document.createElement("div");this._rowContainer.appendChild(S),this._rowElements.push(S)}for(;this._rowElements.length>c;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(m,c){this._refreshRowElements(m,c),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(d)}handleFocus(){this._rowContainer.classList.add(d)}handleSelectionChanged(m,c,l){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(m,c,l),this.renderRows(0,this._bufferService.rows-1),!m||!c)return;let S=m[1]-this._bufferService.buffer.ydisp,b=c[1]-this._bufferService.buffer.ydisp,w=Math.max(S,0),y=Math.min(b,this._bufferService.rows-1);if(w>=this._bufferService.rows||y<0)return;let D=document.createDocumentFragment();if(l){let B=m[0]>c[0];D.appendChild(this._createSelectionElement(w,B?c[0]:m[0],B?m[0]:c[0],y-w+1))}else{let B=S===w?m[0]:0,O=w===b?c[0]:this._bufferService.cols;D.appendChild(this._createSelectionElement(w,B,O));let C=y-w-1;if(D.appendChild(this._createSelectionElement(w+1,0,this._bufferService.cols,C)),w!==y){let L=b===y?c[0]:this._bufferService.cols;D.appendChild(this._createSelectionElement(y,0,L))}}this._selectionContainer.appendChild(D)}_createSelectionElement(m,c,l,S=1){let b=document.createElement("div");return b.style.height=S*this.dimensions.css.cell.height+"px",b.style.top=m*this.dimensions.css.cell.height+"px",b.style.left=c*this.dimensions.css.cell.width+"px",b.style.width=this.dimensions.css.cell.width*(l-c)+"px",b}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(let m of this._rowElements)m.replaceChildren()}renderRows(m,c){let l=this._bufferService.buffer.ybase+this._bufferService.buffer.y,S=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),b=this._optionsService.rawOptions.cursorBlink;for(let w=m;w<=c;w++){let y=this._rowElements[w],D=w+this._bufferService.buffer.ydisp,B=this._bufferService.buffer.lines.get(D),O=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[w]&&this._cellToRowElements[w].length===this._bufferService.cols||(this._cellToRowElements[w]=new Int16Array(this._bufferService.cols)),y.replaceChildren(this._rowFactory.createRow(B,D,D===l,O,S,b,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[w]))}}get _terminalSelector(){return`.${s}${this._terminalClass}`}_handleLinkHover(m){this._setCellUnderline(m.x1,m.x2,m.y1,m.y2,m.cols,!0)}_handleLinkLeave(m){this._setCellUnderline(m.x1,m.x2,m.y1,m.y2,m.cols,!1)}_setCellUnderline(m,c,l,S,b,w){l<0&&(m=0),S<0&&(c=0);let y=this._cellToRowElements.length-1;l=Math.max(Math.min(l,y),0),S=Math.max(Math.min(S,y),0);let D=this._cellToRowElements[l],B=this._cellToRowElements[S];if(!(m>=D.length||c>=B.length)&&(m=D[m],c=B[c],m!==-1&&c!==-1))for(;m!==c||l!==S;){let O=this._rowElements[l];if(!O)return;let C=O.children[m];C&&(C.style.textDecoration=w?"underline":"none"),++m>=b&&(m=0,l++)}}};v=h([u(4,o.IInstantiationService),u(5,f.ICharSizeService),u(6,o.IOptionsService),u(7,o.IBufferService),u(8,f.ICoreBrowserService),u(9,f.IThemeService)],v),t.DomRenderer=v},3787:function(k,t,a){var h=this&&this.__decorate||function(v,m,c,l){var S,b=arguments.length,w=b<3?m:l===null?l=Object.getOwnPropertyDescriptor(m,c):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(v,m,c,l);else for(var y=v.length-1;y>=0;y--)(S=v[y])&&(w=(b<3?S(w):b>3?S(m,c,w):S(m,c))||w);return b>3&&w&&Object.defineProperty(m,c,w),w},u=this&&this.__param||function(v,m){return function(c,l){m(c,l,v)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=t.CURSOR_STYLE_UNDERLINE_CLASS=t.CURSOR_STYLE_BAR_CLASS=t.CURSOR_STYLE_BLOCK_CLASS=t.CURSOR_BLINK_CLASS=t.CURSOR_CLASS=t.STRIKETHROUGH_CLASS=t.OVERLINE_CLASS=t.UNDERLINE_CLASS=t.ITALIC_CLASS=t.DIM_CLASS=t.BOLD_CLASS=void 0;let n=a(2223),_=a(643),p=a(511),f=a(2585),i=a(8055),e=a(4725),r=a(4269),o=a(6171),s=a(3734);t.BOLD_CLASS="xterm-bold",t.DIM_CLASS="xterm-dim",t.ITALIC_CLASS="xterm-italic",t.UNDERLINE_CLASS="xterm-underline",t.OVERLINE_CLASS="xterm-overline",t.STRIKETHROUGH_CLASS="xterm-strikethrough",t.CURSOR_CLASS="xterm-cursor",t.CURSOR_BLINK_CLASS="xterm-cursor-blink",t.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",t.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",t.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let d=class{constructor(v,m,c,l,S,b,w){this._document=v,this._characterJoinerService=m,this._optionsService=c,this._coreBrowserService=l,this._coreService=S,this._decorationService=b,this._themeService=w,this._workCell=new p.CellData,this._columnSelectMode=!1}handleSelectionChanged(v,m,c){this._selectionStart=v,this._selectionEnd=m,this._columnSelectMode=c}createRow(v,m,c,l,S,b,w,y,D){let B=this._document.createDocumentFragment(),O=this._characterJoinerService.getJoinedCharacters(m),C=0;for(let I=Math.min(v.length,y)-1;I>=0;I--)if(v.loadCell(I,this._workCell).getCode()!==_.NULL_CELL_CODE||c&&I===S){C=I+1;break}let L=this._themeService.colors,E=-1,x=0;for(;x<C;x++){v.loadCell(x,this._workCell);let I=this._workCell.getWidth();if(I===0){D[x]=E;continue}let N=!1,j=x,H=this._workCell;if(O.length>0&&x===O[0][0]){N=!0;let X=O.shift();H=new r.JoinedCellData(this._workCell,v.translateToString(!0,X[0],X[1]),X[1]-X[0]),j=X[1]-1,I=H.getWidth()}let z=this._document.createElement("span");if(I>1&&(z.style.width=w*I+"px"),N&&(z.style.display="inline",S>=x&&S<=j&&(S=x)),!this._coreService.isCursorHidden&&c&&x===S)switch(z.classList.add(t.CURSOR_CLASS),b&&z.classList.add(t.CURSOR_BLINK_CLASS),l){case"bar":z.classList.add(t.CURSOR_STYLE_BAR_CLASS);break;case"underline":z.classList.add(t.CURSOR_STYLE_UNDERLINE_CLASS);break;default:z.classList.add(t.CURSOR_STYLE_BLOCK_CLASS)}if(H.isBold()&&z.classList.add(t.BOLD_CLASS),H.isItalic()&&z.classList.add(t.ITALIC_CLASS),H.isDim()&&z.classList.add(t.DIM_CLASS),H.isInvisible()?z.textContent=_.WHITESPACE_CELL_CHAR:z.textContent=H.getChars()||_.WHITESPACE_CELL_CHAR,H.isUnderline()&&(z.classList.add(`${t.UNDERLINE_CLASS}-${H.extended.underlineStyle}`),z.textContent===" "&&(z.textContent="\xA0"),!H.isUnderlineColorDefault()))if(H.isUnderlineColorRGB())z.style.textDecorationColor=`rgb(${s.AttributeData.toColorRGB(H.getUnderlineColor()).join(",")})`;else{let X=H.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&H.isBold()&&X<8&&(X+=8),z.style.textDecorationColor=L.ansi[X].css}H.isOverline()&&(z.classList.add(t.OVERLINE_CLASS),z.textContent===" "&&(z.textContent="\xA0")),H.isStrikethrough()&&z.classList.add(t.STRIKETHROUGH_CLASS);let R=H.getFgColor(),A=H.getFgColorMode(),T=H.getBgColor(),F=H.getBgColorMode(),U=!!H.isInverse();if(U){let X=R;R=T,T=X;let ge=A;A=F,F=ge}let V,$,te=!1;this._decorationService.forEachDecorationAtCell(x,m,void 0,X=>{X.options.layer!=="top"&&te||(X.backgroundColorRGB&&(F=50331648,T=X.backgroundColorRGB.rgba>>8&16777215,V=X.backgroundColorRGB),X.foregroundColorRGB&&(A=50331648,R=X.foregroundColorRGB.rgba>>8&16777215,$=X.foregroundColorRGB),te=X.options.layer==="top")});let ie=this._isCellInSelection(x,m),Q;switch(te||L.selectionForeground&&ie&&(A=50331648,R=L.selectionForeground.rgba>>8&16777215,$=L.selectionForeground),ie&&(V=this._coreBrowserService.isFocused?L.selectionBackgroundOpaque:L.selectionInactiveBackgroundOpaque,te=!0),te&&z.classList.add("xterm-decoration-top"),F){case 16777216:case 33554432:Q=L.ansi[T],z.classList.add(`xterm-bg-${T}`);break;case 50331648:Q=i.rgba.toColor(T>>16,T>>8&255,255&T),this._addStyle(z,`background-color:#${g((T>>>0).toString(16),"0",6)}`);break;default:U?(Q=L.foreground,z.classList.add(`xterm-bg-${n.INVERTED_DEFAULT_COLOR}`)):Q=L.background}switch(V||H.isDim()&&(V=i.color.multiplyOpacity(Q,.5)),A){case 16777216:case 33554432:H.isBold()&&R<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(R+=8),this._applyMinimumContrast(z,Q,L.ansi[R],H,V,void 0)||z.classList.add(`xterm-fg-${R}`);break;case 50331648:let X=i.rgba.toColor(R>>16&255,R>>8&255,255&R);this._applyMinimumContrast(z,Q,X,H,V,$)||this._addStyle(z,`color:#${g(R.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(z,Q,L.foreground,H,V,void 0)||U&&z.classList.add(`xterm-fg-${n.INVERTED_DEFAULT_COLOR}`)}B.appendChild(z),D[x]=++E,x=j}return x<y-1&&D.subarray(x).fill(++E),B}_applyMinimumContrast(v,m,c,l,S,b){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,o.excludeFromContrastRatioDemands)(l.getCode()))return!1;let w;return S||b||(w=this._themeService.colors.contrastCache.getColor(m.rgba,c.rgba)),w===void 0&&(w=i.color.ensureContrastRatio(S||m,b||c,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((S||m).rgba,(b||c).rgba,w??null)),!!w&&(this._addStyle(v,`color:${w.css}`),!0)}_addStyle(v,m){v.setAttribute("style",`${v.getAttribute("style")||""}${m};`)}_isCellInSelection(v,m){let c=this._selectionStart,l=this._selectionEnd;return!(!c||!l)&&(this._columnSelectMode?c[0]<=l[0]?v>=c[0]&&m>=c[1]&&v<l[0]&&m<=l[1]:v<c[0]&&m>=c[1]&&v>=l[0]&&m<=l[1]:m>c[1]&&m<l[1]||c[1]===l[1]&&m===c[1]&&v>=c[0]&&v<l[0]||c[1]<l[1]&&m===l[1]&&v<l[0]||c[1]<l[1]&&m===c[1]&&v>=c[0])}};function g(v,m,c){for(;v.length<c;)v=m+v;return v}d=h([u(1,e.ICharacterJoinerService),u(2,f.IOptionsService),u(3,e.ICoreBrowserService),u(4,f.ICoreService),u(5,f.IDecorationService),u(6,e.IThemeService)],d),t.DomRendererRowFactory=d},2223:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;let h=a(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},6171:(k,t)=>{function a(h){return 57508<=h&&h<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderDimensions=t.excludeFromContrastRatioDemands=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(h){if(!h)throw new Error("value must not be falsy");return h},t.isPowerlineGlyph=a,t.isRestrictedPowerlineGlyph=function(h){return 57520<=h&&h<=57527},t.excludeFromContrastRatioDemands=function(h){return a(h)||function(u){return 9472<=u&&u<=9631}(h)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(a){this._bufferService=a,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?a%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)-1]:[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[a,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[Math.max(a,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let a=this.selectionStart,h=this.selectionEnd;return!(!a||!h)&&(a[1]>h[1]||a[1]===h[1]&&a[0]>h[0])}handleTrim(a){return this.selectionStart&&(this.selectionStart[1]-=a),this.selectionEnd&&(this.selectionEnd[1]-=a),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(k,t,a){var h=this&&this.__decorate||function(e,r,o,s){var d,g=arguments.length,v=g<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,o):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(e,r,o,s);else for(var m=e.length-1;m>=0;m--)(d=e[m])&&(v=(g<3?d(v):g>3?d(r,o,v):d(r,o))||v);return g>3&&v&&Object.defineProperty(r,o,v),v},u=this&&this.__param||function(e,r){return function(o,s){r(o,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;let n=a(2585),_=a(8460),p=a(844),f=class extends p.Disposable{constructor(e,r,o){super(),this._optionsService=o,this.width=0,this.height=0,this._onCharSizeChange=this.register(new _.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new i(e,r,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};f=h([u(2,n.IOptionsService)],f),t.CharSizeService=f;class i{constructor(r,o,s){this._document=r,this._parentElement=o,this._optionsService=s,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;let r=this._measureElement.getBoundingClientRect();return r.width!==0&&r.height!==0&&(this._result.width=r.width,this._result.height=Math.ceil(r.height)),this._result}}},4269:function(k,t,a){var h=this&&this.__decorate||function(r,o,s,d){var g,v=arguments.length,m=v<3?o:d===null?d=Object.getOwnPropertyDescriptor(o,s):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(r,o,s,d);else for(var c=r.length-1;c>=0;c--)(g=r[c])&&(m=(v<3?g(m):v>3?g(o,s,m):g(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},u=this&&this.__param||function(r,o){return function(s,d){o(s,d,r)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;let n=a(3734),_=a(643),p=a(511),f=a(2585);class i extends n.AttributeData{constructor(o,s,d){super(),this.content=0,this.combinedData="",this.fg=o.fg,this.bg=o.bg,this.combinedData=s,this._width=d}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(o){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=i;let e=class Be{constructor(o){this._bufferService=o,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new p.CellData}register(o){let s={id:this._nextCharacterJoinerId++,handler:o};return this._characterJoiners.push(s),s.id}deregister(o){for(let s=0;s<this._characterJoiners.length;s++)if(this._characterJoiners[s].id===o)return this._characterJoiners.splice(s,1),!0;return!1}getJoinedCharacters(o){if(this._characterJoiners.length===0)return[];let s=this._bufferService.buffer.lines.get(o);if(!s||s.length===0)return[];let d=[],g=s.translateToString(!0),v=0,m=0,c=0,l=s.getFg(0),S=s.getBg(0);for(let b=0;b<s.getTrimmedLength();b++)if(s.loadCell(b,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==l||this._workCell.bg!==S){if(b-v>1){let w=this._getJoinedRanges(g,c,m,s,v);for(let y=0;y<w.length;y++)d.push(w[y])}v=b,c=m,l=this._workCell.fg,S=this._workCell.bg}m+=this._workCell.getChars().length||_.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-v>1){let b=this._getJoinedRanges(g,c,m,s,v);for(let w=0;w<b.length;w++)d.push(b[w])}return d}_getJoinedRanges(o,s,d,g,v){let m=o.substring(s,d),c=[];try{c=this._characterJoiners[0].handler(m)}catch(l){console.error(l)}for(let l=1;l<this._characterJoiners.length;l++)try{let S=this._characterJoiners[l].handler(m);for(let b=0;b<S.length;b++)Be._mergeRanges(c,S[b])}catch(S){console.error(S)}return this._stringRangesToCellRanges(c,g,v),c}_stringRangesToCellRanges(o,s,d){let g=0,v=!1,m=0,c=o[g];if(c){for(let l=d;l<this._bufferService.cols;l++){let S=s.getWidth(l),b=s.getString(l).length||_.WHITESPACE_CELL_CHAR.length;if(S!==0){if(!v&&c[0]<=m&&(c[0]=l,v=!0),c[1]<=m){if(c[1]=l,c=o[++g],!c)break;c[0]<=m?(c[0]=l,v=!0):v=!1}m+=b}}c&&(c[1]=this._bufferService.cols)}}static _mergeRanges(o,s){let d=!1;for(let g=0;g<o.length;g++){let v=o[g];if(d){if(s[1]<=v[0])return o[g-1][1]=s[1],o;if(s[1]<=v[1])return o[g-1][1]=Math.max(s[1],v[1]),o.splice(g,1),o;o.splice(g,1),g--}else{if(s[1]<=v[0])return o.splice(g,0,s),o;if(s[1]<=v[1])return v[0]=Math.min(s[0],v[0]),o;s[0]<v[1]&&(v[0]=Math.min(s[0],v[0]),d=!0)}}return d?o[o.length-1][1]=s[1]:o.push(s),o}};e=h([u(0,f.IBufferService)],e),t.CharacterJoinerService=e},5114:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0,t.CoreBrowserService=class{constructor(a,h){this._textarea=a,this.window=h,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(k,t,a){var h=this&&this.__decorate||function(f,i,e,r){var o,s=arguments.length,d=s<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,e):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(f,i,e,r);else for(var g=f.length-1;g>=0;g--)(o=f[g])&&(d=(s<3?o(d):s>3?o(i,e,d):o(i,e))||d);return s>3&&d&&Object.defineProperty(i,e,d),d},u=this&&this.__param||function(f,i){return function(e,r){i(e,r,f)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;let n=a(4725),_=a(9806),p=class{constructor(f,i){this._renderService=f,this._charSizeService=i}getCoords(f,i,e,r,o){return(0,_.getCoords)(window,f,i,e,r,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,o)}getMouseReportCoords(f,i){let e=(0,_.getCoordsRelativeToElement)(window,f,i);if(!(!this._charSizeService.hasValidSize||e[0]<0||e[1]<0||e[0]>=this._renderService.dimensions.css.canvas.width||e[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(e[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(e[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(e[0]),y:Math.floor(e[1])}}};p=h([u(0,n.IRenderService),u(1,n.ICharSizeService)],p),t.MouseService=p},3230:function(k,t,a){var h=this&&this.__decorate||function(d,g,v,m){var c,l=arguments.length,S=l<3?g:m===null?m=Object.getOwnPropertyDescriptor(g,v):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(d,g,v,m);else for(var b=d.length-1;b>=0;b--)(c=d[b])&&(S=(l<3?c(S):l>3?c(g,v,S):c(g,v))||S);return l>3&&S&&Object.defineProperty(g,v,S),S},u=this&&this.__param||function(d,g){return function(v,m){g(v,m,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;let n=a(6193),_=a(8460),p=a(844),f=a(5596),i=a(3656),e=a(2585),r=a(4725),o=a(7226),s=class extends p.Disposable{constructor(d,g,v,m,c,l,S,b){if(super(),this._rowCount=d,this._charSizeService=m,this._pausedResizeTask=new o.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new _.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new _.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new _.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new _.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var w;return(w=this._renderer)===null||w===void 0?void 0:w.dispose()}}),this._renderDebouncer=new n.RenderDebouncer(S.window,(w,y)=>this._renderRows(w,y)),this.register(this._renderDebouncer),this._screenDprMonitor=new f.ScreenDprMonitor(S.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(l.onResize(()=>this._fullRefresh())),this.register(l.buffers.onBufferActivate(()=>{var w;return(w=this._renderer)===null||w===void 0?void 0:w.clear()})),this.register(v.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(c.onDecorationRegistered(()=>this._fullRefresh())),this.register(c.onDecorationRemoved(()=>this._fullRefresh())),this.register(v.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(l.cols,l.rows),this._fullRefresh()})),this.register(v.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(l.buffer.y,l.buffer.y,!0))),this.register((0,i.addDisposableDomListener)(S.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(b.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in S.window){let w=new S.window.IntersectionObserver(y=>this._handleIntersectionChange(y[y.length-1]),{threshold:0});w.observe(g),this.register({dispose:()=>w.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(d){this._isPaused=d.isIntersecting===void 0?d.intersectionRatio===0:!d.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(d,g,v=!1){this._isPaused?this._needsFullRefresh=!0:(v||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(d,g,this._rowCount))}_renderRows(d,g){this._renderer&&(d=Math.min(d,this._rowCount-1),g=Math.min(g,this._rowCount-1),this._renderer.renderRows(d,g),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:d,end:g}),this._onRender.fire({start:d,end:g}),this._isNextRenderRedrawOnly=!0)}resize(d,g){this._rowCount=g,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(d){var g;(g=this._renderer)===null||g===void 0||g.dispose(),this._renderer=d,this._renderer.onRequestRedraw(v=>this.refreshRows(v.start,v.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(d){return this._renderDebouncer.addRefreshCallback(d)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var d,g;this._renderer&&((g=(d=this._renderer).clearTextureAtlas)===null||g===void 0||g.call(d),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(d,g){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(d,g)):this._renderer.handleResize(d,g),this._fullRefresh())}handleCharSizeChanged(){var d;(d=this._renderer)===null||d===void 0||d.handleCharSizeChanged()}handleBlur(){var d;(d=this._renderer)===null||d===void 0||d.handleBlur()}handleFocus(){var d;(d=this._renderer)===null||d===void 0||d.handleFocus()}handleSelectionChanged(d,g,v){var m;this._selectionState.start=d,this._selectionState.end=g,this._selectionState.columnSelectMode=v,(m=this._renderer)===null||m===void 0||m.handleSelectionChanged(d,g,v)}handleCursorMove(){var d;(d=this._renderer)===null||d===void 0||d.handleCursorMove()}clear(){var d;(d=this._renderer)===null||d===void 0||d.clear()}};s=h([u(2,e.IOptionsService),u(3,r.ICharSizeService),u(4,e.IDecorationService),u(5,e.IBufferService),u(6,r.ICoreBrowserService),u(7,r.IThemeService)],s),t.RenderService=s},9312:function(k,t,a){var h=this&&this.__decorate||function(c,l,S,b){var w,y=arguments.length,D=y<3?l:b===null?b=Object.getOwnPropertyDescriptor(l,S):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(c,l,S,b);else for(var B=c.length-1;B>=0;B--)(w=c[B])&&(D=(y<3?w(D):y>3?w(l,S,D):w(l,S))||D);return y>3&&D&&Object.defineProperty(l,S,D),D},u=this&&this.__param||function(c,l){return function(S,b){l(S,b,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;let n=a(6114),_=a(456),p=a(511),f=a(8460),i=a(4725),e=a(2585),r=a(9806),o=a(9504),s=a(844),d=a(4841),g=String.fromCharCode(160),v=new RegExp(g,"g"),m=class extends s.Disposable{constructor(c,l,S,b,w,y,D,B,O){super(),this._element=c,this._screenElement=l,this._linkifier=S,this._bufferService=b,this._coreService=w,this._mouseService=y,this._optionsService=D,this._renderService=B,this._coreBrowserService=O,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new p.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new f.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new f.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new f.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=C=>this._handleMouseMove(C),this._mouseUpListener=C=>this._handleMouseUp(C),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(C=>this._handleTrim(C)),this.register(this._bufferService.buffers.onBufferActivate(C=>this._handleBufferActivate(C))),this.enable(),this._model=new _.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,s.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let c=this._model.finalSelectionStart,l=this._model.finalSelectionEnd;return!(!c||!l||c[0]===l[0]&&c[1]===l[1])}get selectionText(){let c=this._model.finalSelectionStart,l=this._model.finalSelectionEnd;if(!c||!l)return"";let S=this._bufferService.buffer,b=[];if(this._activeSelectionMode===3){if(c[0]===l[0])return"";let w=c[0]<l[0]?c[0]:l[0],y=c[0]<l[0]?l[0]:c[0];for(let D=c[1];D<=l[1];D++){let B=S.translateBufferLineToString(D,!0,w,y);b.push(B)}}else{let w=c[1]===l[1]?l[0]:void 0;b.push(S.translateBufferLineToString(c[1],!0,c[0],w));for(let y=c[1]+1;y<=l[1]-1;y++){let D=S.lines.get(y),B=S.translateBufferLineToString(y,!0);D?.isWrapped?b[b.length-1]+=B:b.push(B)}if(c[1]!==l[1]){let y=S.lines.get(l[1]),D=S.translateBufferLineToString(l[1],!0,0,l[0]);y&&y.isWrapped?b[b.length-1]+=D:b.push(D)}}return b.map(w=>w.replace(v," ")).join(n.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(c){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),n.isLinux&&c&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(c){let l=this._getMouseBufferCoords(c),S=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;return!!(S&&b&&l)&&this._areCoordsInSelection(l,S,b)}isCellInSelection(c,l){let S=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;return!(!S||!b)&&this._areCoordsInSelection([c,l],S,b)}_areCoordsInSelection(c,l,S){return c[1]>l[1]&&c[1]<S[1]||l[1]===S[1]&&c[1]===l[1]&&c[0]>=l[0]&&c[0]<S[0]||l[1]<S[1]&&c[1]===S[1]&&c[0]<S[0]||l[1]<S[1]&&c[1]===l[1]&&c[0]>=l[0]}_selectWordAtCursor(c,l){var S,b;let w=(b=(S=this._linkifier.currentLink)===null||S===void 0?void 0:S.link)===null||b===void 0?void 0:b.range;if(w)return this._model.selectionStart=[w.start.x-1,w.start.y-1],this._model.selectionStartLength=(0,d.getRangeLength)(w,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let y=this._getMouseBufferCoords(c);return!!y&&(this._selectWordAt(y,l),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(c,l){this._model.clearSelection(),c=Math.max(c,0),l=Math.min(l,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,c],this._model.selectionEnd=[this._bufferService.cols,l],this.refresh(),this._onSelectionChange.fire()}_handleTrim(c){this._model.handleTrim(c)&&this.refresh()}_getMouseBufferCoords(c){let l=this._mouseService.getCoords(c,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(l)return l[0]--,l[1]--,l[1]+=this._bufferService.buffer.ydisp,l}_getMouseEventScrollAmount(c){let l=(0,r.getCoordsRelativeToElement)(this._coreBrowserService.window,c,this._screenElement)[1],S=this._renderService.dimensions.css.canvas.height;return l>=0&&l<=S?0:(l>S&&(l-=S),l=Math.min(Math.max(l,-50),50),l/=50,l/Math.abs(l)+Math.round(14*l))}shouldForceSelection(c){return n.isMac?c.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:c.shiftKey}handleMouseDown(c){if(this._mouseDownTimeStamp=c.timeStamp,(c.button!==2||!this.hasSelection)&&c.button===0){if(!this._enabled){if(!this.shouldForceSelection(c))return;c.stopPropagation()}c.preventDefault(),this._dragScrollAmount=0,this._enabled&&c.shiftKey?this._handleIncrementalClick(c):c.detail===1?this._handleSingleClick(c):c.detail===2?this._handleDoubleClick(c):c.detail===3&&this._handleTripleClick(c),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(c){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(c))}_handleSingleClick(c){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(c)?3:0,this._model.selectionStart=this._getMouseBufferCoords(c),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let l=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);l&&l.length!==this._model.selectionStart[0]&&l.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(c){this._selectWordAtCursor(c,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(c){let l=this._getMouseBufferCoords(c);l&&(this._activeSelectionMode=2,this._selectLineAt(l[1]))}shouldColumnSelect(c){return c.altKey&&!(n.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(c){if(c.stopImmediatePropagation(),!this._model.selectionStart)return;let l=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(c),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(c),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let S=this._bufferService.buffer;if(this._model.selectionEnd[1]<S.lines.length){let b=S.lines.get(this._model.selectionEnd[1]);b&&b.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}l&&l[0]===this._model.selectionEnd[0]&&l[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let c=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(c.ydisp+this._bufferService.rows,c.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=c.ydisp),this.refresh()}}_handleMouseUp(c){let l=c.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&l<500&&c.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let S=this._mouseService.getCoords(c,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(S&&S[0]!==void 0&&S[1]!==void 0){let b=(0,o.moveToCellSequence)(S[0]-1,S[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(b,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let c=this._model.finalSelectionStart,l=this._model.finalSelectionEnd,S=!(!c||!l||c[0]===l[0]&&c[1]===l[1]);S?c&&l&&(this._oldSelectionStart&&this._oldSelectionEnd&&c[0]===this._oldSelectionStart[0]&&c[1]===this._oldSelectionStart[1]&&l[0]===this._oldSelectionEnd[0]&&l[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(c,l,S)):this._oldHasSelection&&this._fireOnSelectionChange(c,l,S)}_fireOnSelectionChange(c,l,S){this._oldSelectionStart=c,this._oldSelectionEnd=l,this._oldHasSelection=S,this._onSelectionChange.fire()}_handleBufferActivate(c){this.clearSelection(),this._trimListener.dispose(),this._trimListener=c.activeBuffer.lines.onTrim(l=>this._handleTrim(l))}_convertViewportColToCharacterIndex(c,l){let S=l;for(let b=0;l>=b;b++){let w=c.loadCell(b,this._workCell).getChars().length;this._workCell.getWidth()===0?S--:w>1&&l!==b&&(S+=w-1)}return S}setSelection(c,l,S){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[c,l],this._model.selectionStartLength=S,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(c){this._isClickInSelection(c)||(this._selectWordAtCursor(c,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(c,l,S=!0,b=!0){if(c[0]>=this._bufferService.cols)return;let w=this._bufferService.buffer,y=w.lines.get(c[1]);if(!y)return;let D=w.translateBufferLineToString(c[1],!1),B=this._convertViewportColToCharacterIndex(y,c[0]),O=B,C=c[0]-B,L=0,E=0,x=0,I=0;if(D.charAt(B)===" "){for(;B>0&&D.charAt(B-1)===" ";)B--;for(;O<D.length&&D.charAt(O+1)===" ";)O++}else{let H=c[0],z=c[0];y.getWidth(H)===0&&(L++,H--),y.getWidth(z)===2&&(E++,z++);let R=y.getString(z).length;for(R>1&&(I+=R-1,O+=R-1);H>0&&B>0&&!this._isCharWordSeparator(y.loadCell(H-1,this._workCell));){y.loadCell(H-1,this._workCell);let A=this._workCell.getChars().length;this._workCell.getWidth()===0?(L++,H--):A>1&&(x+=A-1,B-=A-1),B--,H--}for(;z<y.length&&O+1<D.length&&!this._isCharWordSeparator(y.loadCell(z+1,this._workCell));){y.loadCell(z+1,this._workCell);let A=this._workCell.getChars().length;this._workCell.getWidth()===2?(E++,z++):A>1&&(I+=A-1,O+=A-1),O++,z++}}O++;let N=B+C-L+x,j=Math.min(this._bufferService.cols,O-B+L+E-x-I);if(l||D.slice(B,O).trim()!==""){if(S&&N===0&&y.getCodePoint(0)!==32){let H=w.lines.get(c[1]-1);if(H&&y.isWrapped&&H.getCodePoint(this._bufferService.cols-1)!==32){let z=this._getWordAt([this._bufferService.cols-1,c[1]-1],!1,!0,!1);if(z){let R=this._bufferService.cols-z.start;N-=R,j+=R}}}if(b&&N+j===this._bufferService.cols&&y.getCodePoint(this._bufferService.cols-1)!==32){let H=w.lines.get(c[1]+1);if(H?.isWrapped&&H.getCodePoint(0)!==32){let z=this._getWordAt([0,c[1]+1],!1,!1,!0);z&&(j+=z.length)}}return{start:N,length:j}}}_selectWordAt(c,l){let S=this._getWordAt(c,l);if(S){for(;S.start<0;)S.start+=this._bufferService.cols,c[1]--;this._model.selectionStart=[S.start,c[1]],this._model.selectionStartLength=S.length}}_selectToWordAt(c){let l=this._getWordAt(c,!0);if(l){let S=c[1];for(;l.start<0;)l.start+=this._bufferService.cols,S--;if(!this._model.areSelectionValuesReversed())for(;l.start+l.length>this._bufferService.cols;)l.length-=this._bufferService.cols,S++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?l.start:l.start+l.length,S]}}_isCharWordSeparator(c){return c.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(c.getChars())>=0}_selectLineAt(c){let l=this._bufferService.buffer.getWrappedRangeForLine(c),S={start:{x:0,y:l.first},end:{x:this._bufferService.cols-1,y:l.last}};this._model.selectionStart=[0,l.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,d.getRangeLength)(S,this._bufferService.cols)}};m=h([u(3,e.IBufferService),u(4,e.ICoreService),u(5,i.IMouseService),u(6,e.IOptionsService),u(7,i.IRenderService),u(8,i.ICoreBrowserService)],m),t.SelectionService=m},4725:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;let h=a(8343);t.ICharSizeService=(0,h.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,h.createDecorator)("CoreBrowserService"),t.IMouseService=(0,h.createDecorator)("MouseService"),t.IRenderService=(0,h.createDecorator)("RenderService"),t.ISelectionService=(0,h.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,h.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,h.createDecorator)("ThemeService")},6731:function(k,t,a){var h=this&&this.__decorate||function(m,c,l,S){var b,w=arguments.length,y=w<3?c:S===null?S=Object.getOwnPropertyDescriptor(c,l):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(m,c,l,S);else for(var D=m.length-1;D>=0;D--)(b=m[D])&&(y=(w<3?b(y):w>3?b(c,l,y):b(c,l))||y);return w>3&&y&&Object.defineProperty(c,l,y),y},u=this&&this.__param||function(m,c){return function(l,S){c(l,S,m)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;let n=a(7239),_=a(8055),p=a(8460),f=a(844),i=a(2585),e=_.css.toColor("#ffffff"),r=_.css.toColor("#000000"),o=_.css.toColor("#ffffff"),s=_.css.toColor("#000000"),d={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{let m=[_.css.toColor("#2e3436"),_.css.toColor("#cc0000"),_.css.toColor("#4e9a06"),_.css.toColor("#c4a000"),_.css.toColor("#3465a4"),_.css.toColor("#75507b"),_.css.toColor("#06989a"),_.css.toColor("#d3d7cf"),_.css.toColor("#555753"),_.css.toColor("#ef2929"),_.css.toColor("#8ae234"),_.css.toColor("#fce94f"),_.css.toColor("#729fcf"),_.css.toColor("#ad7fa8"),_.css.toColor("#34e2e2"),_.css.toColor("#eeeeec")],c=[0,95,135,175,215,255];for(let l=0;l<216;l++){let S=c[l/36%6|0],b=c[l/6%6|0],w=c[l%6];m.push({css:_.channels.toCss(S,b,w),rgba:_.channels.toRgba(S,b,w)})}for(let l=0;l<24;l++){let S=8+10*l;m.push({css:_.channels.toCss(S,S,S),rgba:_.channels.toRgba(S,S,S)})}return m})());let g=class extends f.Disposable{constructor(m){super(),this._optionsService=m,this._onChangeColors=this.register(new p.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new n.ColorContrastCache,this._colors={foreground:e,background:r,cursor:o,cursorAccent:s,selectionForeground:void 0,selectionBackgroundTransparent:d,selectionBackgroundOpaque:_.color.blend(r,d),selectionInactiveBackgroundTransparent:d,selectionInactiveBackgroundOpaque:_.color.blend(r,d),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(m={}){let c=this._colors;if(c.foreground=v(m.foreground,e),c.background=v(m.background,r),c.cursor=v(m.cursor,o),c.cursorAccent=v(m.cursorAccent,s),c.selectionBackgroundTransparent=v(m.selectionBackground,d),c.selectionBackgroundOpaque=_.color.blend(c.background,c.selectionBackgroundTransparent),c.selectionInactiveBackgroundTransparent=v(m.selectionInactiveBackground,c.selectionBackgroundTransparent),c.selectionInactiveBackgroundOpaque=_.color.blend(c.background,c.selectionInactiveBackgroundTransparent),c.selectionForeground=m.selectionForeground?v(m.selectionForeground,_.NULL_COLOR):void 0,c.selectionForeground===_.NULL_COLOR&&(c.selectionForeground=void 0),_.color.isOpaque(c.selectionBackgroundTransparent)&&(c.selectionBackgroundTransparent=_.color.opacity(c.selectionBackgroundTransparent,.3)),_.color.isOpaque(c.selectionInactiveBackgroundTransparent)&&(c.selectionInactiveBackgroundTransparent=_.color.opacity(c.selectionInactiveBackgroundTransparent,.3)),c.ansi=t.DEFAULT_ANSI_COLORS.slice(),c.ansi[0]=v(m.black,t.DEFAULT_ANSI_COLORS[0]),c.ansi[1]=v(m.red,t.DEFAULT_ANSI_COLORS[1]),c.ansi[2]=v(m.green,t.DEFAULT_ANSI_COLORS[2]),c.ansi[3]=v(m.yellow,t.DEFAULT_ANSI_COLORS[3]),c.ansi[4]=v(m.blue,t.DEFAULT_ANSI_COLORS[4]),c.ansi[5]=v(m.magenta,t.DEFAULT_ANSI_COLORS[5]),c.ansi[6]=v(m.cyan,t.DEFAULT_ANSI_COLORS[6]),c.ansi[7]=v(m.white,t.DEFAULT_ANSI_COLORS[7]),c.ansi[8]=v(m.brightBlack,t.DEFAULT_ANSI_COLORS[8]),c.ansi[9]=v(m.brightRed,t.DEFAULT_ANSI_COLORS[9]),c.ansi[10]=v(m.brightGreen,t.DEFAULT_ANSI_COLORS[10]),c.ansi[11]=v(m.brightYellow,t.DEFAULT_ANSI_COLORS[11]),c.ansi[12]=v(m.brightBlue,t.DEFAULT_ANSI_COLORS[12]),c.ansi[13]=v(m.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),c.ansi[14]=v(m.brightCyan,t.DEFAULT_ANSI_COLORS[14]),c.ansi[15]=v(m.brightWhite,t.DEFAULT_ANSI_COLORS[15]),m.extendedAnsi){let l=Math.min(c.ansi.length-16,m.extendedAnsi.length);for(let S=0;S<l;S++)c.ansi[S+16]=v(m.extendedAnsi[S],t.DEFAULT_ANSI_COLORS[S+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(m){this._restoreColor(m),this._onChangeColors.fire(this.colors)}_restoreColor(m){if(m!==void 0)switch(m){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[m]=this._restoreColors.ansi[m]}else for(let c=0;c<this._restoreColors.ansi.length;++c)this._colors.ansi[c]=this._restoreColors.ansi[c]}modifyColors(m){m(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function v(m,c){if(m!==void 0)try{return _.css.toColor(m)}catch{}return c}g=h([u(0,i.IOptionsService)],g),t.ThemeService=g},6349:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;let h=a(8460),u=a(844);class n extends u.Disposable{constructor(p){super(),this._maxLength=p,this.onDeleteEmitter=this.register(new h.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new h.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new h.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(p){if(this._maxLength===p)return;let f=new Array(p);for(let i=0;i<Math.min(p,this.length);i++)f[i]=this._array[this._getCyclicIndex(i)];this._array=f,this._maxLength=p,this._startIndex=0}get length(){return this._length}set length(p){if(p>this._length)for(let f=this._length;f<p;f++)this._array[f]=void 0;this._length=p}get(p){return this._array[this._getCyclicIndex(p)]}set(p,f){this._array[this._getCyclicIndex(p)]=f}push(p){this._array[this._getCyclicIndex(this._length)]=p,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(p,f,...i){if(f){for(let e=p;e<this._length-f;e++)this._array[this._getCyclicIndex(e)]=this._array[this._getCyclicIndex(e+f)];this._length-=f,this.onDeleteEmitter.fire({index:p,amount:f})}for(let e=this._length-1;e>=p;e--)this._array[this._getCyclicIndex(e+i.length)]=this._array[this._getCyclicIndex(e)];for(let e=0;e<i.length;e++)this._array[this._getCyclicIndex(p+e)]=i[e];if(i.length&&this.onInsertEmitter.fire({index:p,amount:i.length}),this._length+i.length>this._maxLength){let e=this._length+i.length-this._maxLength;this._startIndex+=e,this._length=this._maxLength,this.onTrimEmitter.fire(e)}else this._length+=i.length}trimStart(p){p>this._length&&(p=this._length),this._startIndex+=p,this._length-=p,this.onTrimEmitter.fire(p)}shiftElements(p,f,i){if(!(f<=0)){if(p<0||p>=this._length)throw new Error("start argument out of range");if(p+i<0)throw new Error("Cannot shift elements in list beyond index 0");if(i>0){for(let r=f-1;r>=0;r--)this.set(p+r+i,this.get(p+r));let e=p+f+i-this._length;if(e>0)for(this._length+=e;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let e=0;e<f;e++)this.set(p+e+i,this.get(p+e))}}_getCyclicIndex(p){return(this._startIndex+p)%this._maxLength}}t.CircularList=n},1439:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function a(h,u=5){if(typeof h!="object")return h;let n=Array.isArray(h)?[]:{};for(let _ in h)n[_]=u<=1?h[_]:h[_]&&a(h[_],u-1);return n}},8055:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;let h=a(6114),u=0,n=0,_=0,p=0;var f,i,e;function r(s){let d=s.toString(16);return d.length<2?"0"+d:d}function o(s,d){return s<d?(d+.05)/(s+.05):(s+.05)/(d+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(s){s.toCss=function(d,g,v,m){return m!==void 0?`#${r(d)}${r(g)}${r(v)}${r(m)}`:`#${r(d)}${r(g)}${r(v)}`},s.toRgba=function(d,g,v,m=255){return(d<<24|g<<16|v<<8|m)>>>0}}(f=t.channels||(t.channels={})),function(s){function d(g,v){return p=Math.round(255*v),[u,n,_]=e.toChannels(g.rgba),{css:f.toCss(u,n,_,p),rgba:f.toRgba(u,n,_,p)}}s.blend=function(g,v){if(p=(255&v.rgba)/255,p===1)return{css:v.css,rgba:v.rgba};let m=v.rgba>>24&255,c=v.rgba>>16&255,l=v.rgba>>8&255,S=g.rgba>>24&255,b=g.rgba>>16&255,w=g.rgba>>8&255;return u=S+Math.round((m-S)*p),n=b+Math.round((c-b)*p),_=w+Math.round((l-w)*p),{css:f.toCss(u,n,_),rgba:f.toRgba(u,n,_)}},s.isOpaque=function(g){return(255&g.rgba)==255},s.ensureContrastRatio=function(g,v,m){let c=e.ensureContrastRatio(g.rgba,v.rgba,m);if(c)return e.toColor(c>>24&255,c>>16&255,c>>8&255)},s.opaque=function(g){let v=(255|g.rgba)>>>0;return[u,n,_]=e.toChannels(v),{css:f.toCss(u,n,_),rgba:v}},s.opacity=d,s.multiplyOpacity=function(g,v){return p=255&g.rgba,d(g,p*v/255)},s.toColorRGB=function(g){return[g.rgba>>24&255,g.rgba>>16&255,g.rgba>>8&255]}}(t.color||(t.color={})),function(s){let d,g;if(!h.isNode){let v=document.createElement("canvas");v.width=1,v.height=1;let m=v.getContext("2d",{willReadFrequently:!0});m&&(d=m,d.globalCompositeOperation="copy",g=d.createLinearGradient(0,0,1,1))}s.toColor=function(v){if(v.match(/#[\da-f]{3,8}/i))switch(v.length){case 4:return u=parseInt(v.slice(1,2).repeat(2),16),n=parseInt(v.slice(2,3).repeat(2),16),_=parseInt(v.slice(3,4).repeat(2),16),e.toColor(u,n,_);case 5:return u=parseInt(v.slice(1,2).repeat(2),16),n=parseInt(v.slice(2,3).repeat(2),16),_=parseInt(v.slice(3,4).repeat(2),16),p=parseInt(v.slice(4,5).repeat(2),16),e.toColor(u,n,_,p);case 7:return{css:v,rgba:(parseInt(v.slice(1),16)<<8|255)>>>0};case 9:return{css:v,rgba:parseInt(v.slice(1),16)>>>0}}let m=v.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(m)return u=parseInt(m[1]),n=parseInt(m[2]),_=parseInt(m[3]),p=Math.round(255*(m[5]===void 0?1:parseFloat(m[5]))),e.toColor(u,n,_,p);if(!d||!g)throw new Error("css.toColor: Unsupported css format");if(d.fillStyle=g,d.fillStyle=v,typeof d.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(d.fillRect(0,0,1,1),[u,n,_,p]=d.getImageData(0,0,1,1).data,p!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:f.toRgba(u,n,_,p),css:v}}}(t.css||(t.css={})),function(s){function d(g,v,m){let c=g/255,l=v/255,S=m/255;return .2126*(c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4))+.7152*(l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4))+.0722*(S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4))}s.relativeLuminance=function(g){return d(g>>16&255,g>>8&255,255&g)},s.relativeLuminance2=d}(i=t.rgb||(t.rgb={})),function(s){function d(v,m,c){let l=v>>24&255,S=v>>16&255,b=v>>8&255,w=m>>24&255,y=m>>16&255,D=m>>8&255,B=o(i.relativeLuminance2(w,y,D),i.relativeLuminance2(l,S,b));for(;B<c&&(w>0||y>0||D>0);)w-=Math.max(0,Math.ceil(.1*w)),y-=Math.max(0,Math.ceil(.1*y)),D-=Math.max(0,Math.ceil(.1*D)),B=o(i.relativeLuminance2(w,y,D),i.relativeLuminance2(l,S,b));return(w<<24|y<<16|D<<8|255)>>>0}function g(v,m,c){let l=v>>24&255,S=v>>16&255,b=v>>8&255,w=m>>24&255,y=m>>16&255,D=m>>8&255,B=o(i.relativeLuminance2(w,y,D),i.relativeLuminance2(l,S,b));for(;B<c&&(w<255||y<255||D<255);)w=Math.min(255,w+Math.ceil(.1*(255-w))),y=Math.min(255,y+Math.ceil(.1*(255-y))),D=Math.min(255,D+Math.ceil(.1*(255-D))),B=o(i.relativeLuminance2(w,y,D),i.relativeLuminance2(l,S,b));return(w<<24|y<<16|D<<8|255)>>>0}s.ensureContrastRatio=function(v,m,c){let l=i.relativeLuminance(v>>8),S=i.relativeLuminance(m>>8);if(o(l,S)<c){if(S<l){let y=d(v,m,c),D=o(l,i.relativeLuminance(y>>8));if(D<c){let B=g(v,m,c);return D>o(l,i.relativeLuminance(B>>8))?y:B}return y}let b=g(v,m,c),w=o(l,i.relativeLuminance(b>>8));if(w<c){let y=d(v,m,c);return w>o(l,i.relativeLuminance(y>>8))?b:y}return b}},s.reduceLuminance=d,s.increaseLuminance=g,s.toChannels=function(v){return[v>>24&255,v>>16&255,v>>8&255,255&v]},s.toColor=function(v,m,c,l){return{css:f.toCss(v,m,c,l),rgba:f.toRgba(v,m,c,l)}}}(e=t.rgba||(t.rgba={})),t.toPaddedHex=r,t.contrastRatio=o},8969:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;let h=a(844),u=a(2585),n=a(4348),_=a(7866),p=a(744),f=a(7302),i=a(6975),e=a(8460),r=a(1753),o=a(1480),s=a(7994),d=a(9282),g=a(5435),v=a(5981),m=a(2660),c=!1;class l extends h.Disposable{constructor(b){super(),this._onBinary=this.register(new e.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new e.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new e.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new e.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new e.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new e.EventEmitter),this._instantiationService=new n.InstantiationService,this.optionsService=this.register(new f.OptionsService(b)),this._instantiationService.setService(u.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(p.BufferService)),this._instantiationService.setService(u.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(_.LogService)),this._instantiationService.setService(u.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(i.CoreService)),this._instantiationService.setService(u.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(r.CoreMouseService)),this._instantiationService.setService(u.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(o.UnicodeService)),this._instantiationService.setService(u.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(s.CharsetService),this._instantiationService.setService(u.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(m.OscLinkService),this._instantiationService.setService(u.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new g.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,e.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,e.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,e.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,e.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(w=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(w=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new v.WriteBuffer((w,y)=>this._inputHandler.parse(w,y))),this.register((0,e.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,h.toDisposable)(()=>{var w;(w=this._windowsWrappingHeuristics)===null||w===void 0||w.dispose(),this._windowsWrappingHeuristics=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new e.EventEmitter),this._onScroll.event(b=>{var w;(w=this._onScrollApi)===null||w===void 0||w.fire(b.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(b){for(let w in b)this.optionsService.options[w]=b[w]}write(b,w){this._writeBuffer.write(b,w)}writeSync(b,w){this._logService.logLevel<=u.LogLevelEnum.WARN&&!c&&(this._logService.warn("writeSync is unreliable and will be removed soon."),c=!0),this._writeBuffer.writeSync(b,w)}resize(b,w){isNaN(b)||isNaN(w)||(b=Math.max(b,p.MINIMUM_COLS),w=Math.max(w,p.MINIMUM_ROWS),this._bufferService.resize(b,w))}scroll(b,w=!1){this._bufferService.scroll(b,w)}scrollLines(b,w,y){this._bufferService.scrollLines(b,w,y)}scrollPages(b){this._bufferService.scrollPages(b)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(b){this._bufferService.scrollToLine(b)}registerEscHandler(b,w){return this._inputHandler.registerEscHandler(b,w)}registerDcsHandler(b,w){return this._inputHandler.registerDcsHandler(b,w)}registerCsiHandler(b,w){return this._inputHandler.registerCsiHandler(b,w)}registerOscHandler(b,w){return this._inputHandler.registerOscHandler(b,w)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){var b;let w=!1,y=this.optionsService.rawOptions.windowsPty;y&&y.buildNumber!==void 0&&y.buildNumber!==void 0?w=y.backend==="conpty"&&y.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(w=!0),w?this._enableWindowsWrappingHeuristics():((b=this._windowsWrappingHeuristics)===null||b===void 0||b.dispose(),this._windowsWrappingHeuristics=void 0)}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics){let b=[];b.push(this.onLineFeed(d.updateWindowsModeWrappedState.bind(null,this._bufferService))),b.push(this.registerCsiHandler({final:"H"},()=>((0,d.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics=(0,h.toDisposable)(()=>{for(let w of b)w.dispose()})}}}t.CoreTerminal=l},8460:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===a)return void this._listeners.splice(h,1)}}})),this._event}fire(a,h){let u=[];for(let n=0;n<this._listeners.length;n++)u.push(this._listeners[n]);for(let n=0;n<u.length;n++)u[n].call(void 0,a,h)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},t.forwardEvent=function(a,h){return a(u=>h.fire(u))}},5435:function(k,t,a){var h=this&&this.__decorate||function(O,C,L,E){var x,I=arguments.length,N=I<3?C:E===null?E=Object.getOwnPropertyDescriptor(C,L):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(O,C,L,E);else for(var j=O.length-1;j>=0;j--)(x=O[j])&&(N=(I<3?x(N):I>3?x(C,L,N):x(C,L))||N);return I>3&&N&&Object.defineProperty(C,L,N),N},u=this&&this.__param||function(O,C){return function(L,E){C(L,E,O)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;let n=a(2584),_=a(7116),p=a(2015),f=a(844),i=a(482),e=a(8437),r=a(8460),o=a(643),s=a(511),d=a(3734),g=a(2585),v=a(6242),m=a(6351),c=a(5941),l={"(":0,")":1,"*":2,"+":3,"-":1,".":2},S=131072;function b(O,C){if(O>24)return C.setWinLines||!1;switch(O){case 1:return!!C.restoreWin;case 2:return!!C.minimizeWin;case 3:return!!C.setWinPosition;case 4:return!!C.setWinSizePixels;case 5:return!!C.raiseWin;case 6:return!!C.lowerWin;case 7:return!!C.refreshWin;case 8:return!!C.setWinSizeChars;case 9:return!!C.maximizeWin;case 10:return!!C.fullscreenWin;case 11:return!!C.getWinState;case 13:return!!C.getWinPosition;case 14:return!!C.getWinSizePixels;case 15:return!!C.getScreenSizePixels;case 16:return!!C.getCellSizePixels;case 18:return!!C.getWinSizeChars;case 19:return!!C.getScreenSizeChars;case 20:return!!C.getIconTitle;case 21:return!!C.getWinTitle;case 22:return!!C.pushTitle;case 23:return!!C.popTitle;case 24:return!!C.setWinLines}return!1}var w;(function(O){O[O.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",O[O.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(w=t.WindowsOptionsReportType||(t.WindowsOptionsReportType={}));let y=0;class D extends f.Disposable{constructor(C,L,E,x,I,N,j,H,z=new p.EscapeSequenceParser){super(),this._bufferService=C,this._charsetService=L,this._coreService=E,this._logService=x,this._optionsService=I,this._oscLinkService=N,this._coreMouseService=j,this._unicodeService=H,this._parser=z,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new i.StringToUtf32,this._utf8Decoder=new i.Utf8ToUtf32,this._workCell=new s.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new r.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new r.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new r.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new r.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new r.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new r.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new r.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new r.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new r.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new r.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new r.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new r.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new r.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new B(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(R=>this._activeBuffer=R.activeBuffer)),this._parser.setCsiHandlerFallback((R,A)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(R),params:A.toArray()})}),this._parser.setEscHandlerFallback(R=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(R)})}),this._parser.setExecuteHandlerFallback(R=>{this._logService.debug("Unknown EXECUTE code: ",{code:R})}),this._parser.setOscHandlerFallback((R,A,T)=>{this._logService.debug("Unknown OSC code: ",{identifier:R,action:A,data:T})}),this._parser.setDcsHandlerFallback((R,A,T)=>{A==="HOOK"&&(T=T.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(R),action:A,payload:T})}),this._parser.setPrintHandler((R,A,T)=>this.print(R,A,T)),this._parser.registerCsiHandler({final:"@"},R=>this.insertChars(R)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},R=>this.scrollLeft(R)),this._parser.registerCsiHandler({final:"A"},R=>this.cursorUp(R)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},R=>this.scrollRight(R)),this._parser.registerCsiHandler({final:"B"},R=>this.cursorDown(R)),this._parser.registerCsiHandler({final:"C"},R=>this.cursorForward(R)),this._parser.registerCsiHandler({final:"D"},R=>this.cursorBackward(R)),this._parser.registerCsiHandler({final:"E"},R=>this.cursorNextLine(R)),this._parser.registerCsiHandler({final:"F"},R=>this.cursorPrecedingLine(R)),this._parser.registerCsiHandler({final:"G"},R=>this.cursorCharAbsolute(R)),this._parser.registerCsiHandler({final:"H"},R=>this.cursorPosition(R)),this._parser.registerCsiHandler({final:"I"},R=>this.cursorForwardTab(R)),this._parser.registerCsiHandler({final:"J"},R=>this.eraseInDisplay(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},R=>this.eraseInDisplay(R,!0)),this._parser.registerCsiHandler({final:"K"},R=>this.eraseInLine(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},R=>this.eraseInLine(R,!0)),this._parser.registerCsiHandler({final:"L"},R=>this.insertLines(R)),this._parser.registerCsiHandler({final:"M"},R=>this.deleteLines(R)),this._parser.registerCsiHandler({final:"P"},R=>this.deleteChars(R)),this._parser.registerCsiHandler({final:"S"},R=>this.scrollUp(R)),this._parser.registerCsiHandler({final:"T"},R=>this.scrollDown(R)),this._parser.registerCsiHandler({final:"X"},R=>this.eraseChars(R)),this._parser.registerCsiHandler({final:"Z"},R=>this.cursorBackwardTab(R)),this._parser.registerCsiHandler({final:"`"},R=>this.charPosAbsolute(R)),this._parser.registerCsiHandler({final:"a"},R=>this.hPositionRelative(R)),this._parser.registerCsiHandler({final:"b"},R=>this.repeatPrecedingCharacter(R)),this._parser.registerCsiHandler({final:"c"},R=>this.sendDeviceAttributesPrimary(R)),this._parser.registerCsiHandler({prefix:">",final:"c"},R=>this.sendDeviceAttributesSecondary(R)),this._parser.registerCsiHandler({final:"d"},R=>this.linePosAbsolute(R)),this._parser.registerCsiHandler({final:"e"},R=>this.vPositionRelative(R)),this._parser.registerCsiHandler({final:"f"},R=>this.hVPosition(R)),this._parser.registerCsiHandler({final:"g"},R=>this.tabClear(R)),this._parser.registerCsiHandler({final:"h"},R=>this.setMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"h"},R=>this.setModePrivate(R)),this._parser.registerCsiHandler({final:"l"},R=>this.resetMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"l"},R=>this.resetModePrivate(R)),this._parser.registerCsiHandler({final:"m"},R=>this.charAttributes(R)),this._parser.registerCsiHandler({final:"n"},R=>this.deviceStatus(R)),this._parser.registerCsiHandler({prefix:"?",final:"n"},R=>this.deviceStatusPrivate(R)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},R=>this.softReset(R)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},R=>this.setCursorStyle(R)),this._parser.registerCsiHandler({final:"r"},R=>this.setScrollRegion(R)),this._parser.registerCsiHandler({final:"s"},R=>this.saveCursor(R)),this._parser.registerCsiHandler({final:"t"},R=>this.windowOptions(R)),this._parser.registerCsiHandler({final:"u"},R=>this.restoreCursor(R)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},R=>this.insertColumns(R)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},R=>this.deleteColumns(R)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},R=>this.selectProtected(R)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},R=>this.requestMode(R,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},R=>this.requestMode(R,!1)),this._parser.setExecuteHandler(n.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(n.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(n.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(n.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(n.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(n.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(n.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(n.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(n.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(n.C1.IND,()=>this.index()),this._parser.setExecuteHandler(n.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(n.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new v.OscHandler(R=>(this.setTitle(R),this.setIconName(R),!0))),this._parser.registerOscHandler(1,new v.OscHandler(R=>this.setIconName(R))),this._parser.registerOscHandler(2,new v.OscHandler(R=>this.setTitle(R))),this._parser.registerOscHandler(4,new v.OscHandler(R=>this.setOrReportIndexedColor(R))),this._parser.registerOscHandler(8,new v.OscHandler(R=>this.setHyperlink(R))),this._parser.registerOscHandler(10,new v.OscHandler(R=>this.setOrReportFgColor(R))),this._parser.registerOscHandler(11,new v.OscHandler(R=>this.setOrReportBgColor(R))),this._parser.registerOscHandler(12,new v.OscHandler(R=>this.setOrReportCursorColor(R))),this._parser.registerOscHandler(104,new v.OscHandler(R=>this.restoreIndexedColor(R))),this._parser.registerOscHandler(110,new v.OscHandler(R=>this.restoreFgColor(R))),this._parser.registerOscHandler(111,new v.OscHandler(R=>this.restoreBgColor(R))),this._parser.registerOscHandler(112,new v.OscHandler(R=>this.restoreCursorColor(R))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let R in _.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:R},()=>this.selectCharset("("+R)),this._parser.registerEscHandler({intermediates:")",final:R},()=>this.selectCharset(")"+R)),this._parser.registerEscHandler({intermediates:"*",final:R},()=>this.selectCharset("*"+R)),this._parser.registerEscHandler({intermediates:"+",final:R},()=>this.selectCharset("+"+R)),this._parser.registerEscHandler({intermediates:"-",final:R},()=>this.selectCharset("-"+R)),this._parser.registerEscHandler({intermediates:".",final:R},()=>this.selectCharset("."+R)),this._parser.registerEscHandler({intermediates:"/",final:R},()=>this.selectCharset("/"+R));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(R=>(this._logService.error("Parsing error: ",R),R)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new m.DcsHandler((R,A)=>this.requestStatusString(R,A)))}getAttrData(){return this._curAttrData}_preserveStack(C,L,E,x){this._parseStack.paused=!0,this._parseStack.cursorStartX=C,this._parseStack.cursorStartY=L,this._parseStack.decodedLength=E,this._parseStack.position=x}_logSlowResolvingAsync(C){this._logService.logLevel<=g.LogLevelEnum.WARN&&Promise.race([C,new Promise((L,E)=>setTimeout(()=>E("#SLOW_TIMEOUT"),5e3))]).catch(L=>{if(L!=="#SLOW_TIMEOUT")throw L;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(C,L){let E,x=this._activeBuffer.x,I=this._activeBuffer.y,N=0,j=this._parseStack.paused;if(j){if(E=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,L))return this._logSlowResolvingAsync(E),E;x=this._parseStack.cursorStartX,I=this._parseStack.cursorStartY,this._parseStack.paused=!1,C.length>S&&(N=this._parseStack.position+S)}if(this._logService.logLevel<=g.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof C=="string"?` "${C}"`:` "${Array.prototype.map.call(C,H=>String.fromCharCode(H)).join("")}"`),typeof C=="string"?C.split("").map(H=>H.charCodeAt(0)):C),this._parseBuffer.length<C.length&&this._parseBuffer.length<S&&(this._parseBuffer=new Uint32Array(Math.min(C.length,S))),j||this._dirtyRowTracker.clearRange(),C.length>S)for(let H=N;H<C.length;H+=S){let z=H+S<C.length?H+S:C.length,R=typeof C=="string"?this._stringDecoder.decode(C.substring(H,z),this._parseBuffer):this._utf8Decoder.decode(C.subarray(H,z),this._parseBuffer);if(E=this._parser.parse(this._parseBuffer,R))return this._preserveStack(x,I,R,H),this._logSlowResolvingAsync(E),E}else if(!j){let H=typeof C=="string"?this._stringDecoder.decode(C,this._parseBuffer):this._utf8Decoder.decode(C,this._parseBuffer);if(E=this._parser.parse(this._parseBuffer,H))return this._preserveStack(x,I,H,0),this._logSlowResolvingAsync(E),E}this._activeBuffer.x===x&&this._activeBuffer.y===I||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(C,L,E){let x,I,N=this._charsetService.charset,j=this._optionsService.rawOptions.screenReaderMode,H=this._bufferService.cols,z=this._coreService.decPrivateModes.wraparound,R=this._coreService.modes.insertMode,A=this._curAttrData,T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&E-L>0&&T.getWidth(this._activeBuffer.x-1)===2&&T.setCellFromCodePoint(this._activeBuffer.x-1,0,1,A.fg,A.bg,A.extended);for(let F=L;F<E;++F){if(x=C[F],I=this._unicodeService.wcwidth(x),x<127&&N){let U=N[String.fromCharCode(x)];U&&(x=U.charCodeAt(0))}if(j&&this._onA11yChar.fire((0,i.stringFromCodePoint)(x)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),I||!this._activeBuffer.x){if(this._activeBuffer.x+I-1>=H){if(z){for(;this._activeBuffer.x<H;)T.setCellFromCodePoint(this._activeBuffer.x++,0,1,A.fg,A.bg,A.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=H-1,I===2)continue}if(R&&(T.insertCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(A),A),T.getWidth(H-1)===2&&T.setCellFromCodePoint(H-1,o.NULL_CELL_CODE,o.NULL_CELL_WIDTH,A.fg,A.bg,A.extended)),T.setCellFromCodePoint(this._activeBuffer.x++,x,I,A.fg,A.bg,A.extended),I>0)for(;--I;)T.setCellFromCodePoint(this._activeBuffer.x++,0,0,A.fg,A.bg,A.extended)}else T.getWidth(this._activeBuffer.x-1)?T.addCodepointToCell(this._activeBuffer.x-1,x):T.addCodepointToCell(this._activeBuffer.x-2,x)}E-L>0&&(T.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<H&&E-L>0&&T.getWidth(this._activeBuffer.x)===0&&!T.hasContent(this._activeBuffer.x)&&T.setCellFromCodePoint(this._activeBuffer.x,0,1,A.fg,A.bg,A.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(C,L){return C.final!=="t"||C.prefix||C.intermediates?this._parser.registerCsiHandler(C,L):this._parser.registerCsiHandler(C,E=>!b(E.params[0],this._optionsService.rawOptions.windowOptions)||L(E))}registerDcsHandler(C,L){return this._parser.registerDcsHandler(C,new m.DcsHandler(L))}registerEscHandler(C,L){return this._parser.registerEscHandler(C,L)}registerOscHandler(C,L){return this._parser.registerOscHandler(C,new v.OscHandler(L))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var C;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((C=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||C===void 0)&&C.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);L.hasWidth(this._activeBuffer.x)&&!L.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let C=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-C),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(C=this._bufferService.cols-1){this._activeBuffer.x=Math.min(C,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(C,L){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=C,this._activeBuffer.y=this._activeBuffer.scrollTop+L):(this._activeBuffer.x=C,this._activeBuffer.y=L),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(C,L){this._restrictCursor(),this._setCursor(this._activeBuffer.x+C,this._activeBuffer.y+L)}cursorUp(C){let L=this._activeBuffer.y-this._activeBuffer.scrollTop;return L>=0?this._moveCursor(0,-Math.min(L,C.params[0]||1)):this._moveCursor(0,-(C.params[0]||1)),!0}cursorDown(C){let L=this._activeBuffer.scrollBottom-this._activeBuffer.y;return L>=0?this._moveCursor(0,Math.min(L,C.params[0]||1)):this._moveCursor(0,C.params[0]||1),!0}cursorForward(C){return this._moveCursor(C.params[0]||1,0),!0}cursorBackward(C){return this._moveCursor(-(C.params[0]||1),0),!0}cursorNextLine(C){return this.cursorDown(C),this._activeBuffer.x=0,!0}cursorPrecedingLine(C){return this.cursorUp(C),this._activeBuffer.x=0,!0}cursorCharAbsolute(C){return this._setCursor((C.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(C){return this._setCursor(C.length>=2?(C.params[1]||1)-1:0,(C.params[0]||1)-1),!0}charPosAbsolute(C){return this._setCursor((C.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(C){return this._moveCursor(C.params[0]||1,0),!0}linePosAbsolute(C){return this._setCursor(this._activeBuffer.x,(C.params[0]||1)-1),!0}vPositionRelative(C){return this._moveCursor(0,C.params[0]||1),!0}hVPosition(C){return this.cursorPosition(C),!0}tabClear(C){let L=C.params[0];return L===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:L===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(C){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=C.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(C){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=C.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(C){let L=C.params[0];return L===1&&(this._curAttrData.bg|=536870912),L!==2&&L!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(C,L,E,x=!1,I=!1){let N=this._activeBuffer.lines.get(this._activeBuffer.ybase+C);N.replaceCells(L,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),I),x&&(N.isWrapped=!1)}_resetBufferLine(C,L=!1){let E=this._activeBuffer.lines.get(this._activeBuffer.ybase+C);E&&(E.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),L),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+C),E.isWrapped=!1)}eraseInDisplay(C,L=!1){let E;switch(this._restrictCursor(this._bufferService.cols),C.params[0]){case 0:for(E=this._activeBuffer.y,this._dirtyRowTracker.markDirty(E),this._eraseInBufferLine(E++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);E<this._bufferService.rows;E++)this._resetBufferLine(E,L);this._dirtyRowTracker.markDirty(E);break;case 1:for(E=this._activeBuffer.y,this._dirtyRowTracker.markDirty(E),this._eraseInBufferLine(E,0,this._activeBuffer.x+1,!0,L),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(E+1).isWrapped=!1);E--;)this._resetBufferLine(E,L);this._dirtyRowTracker.markDirty(0);break;case 2:for(E=this._bufferService.rows,this._dirtyRowTracker.markDirty(E-1);E--;)this._resetBufferLine(E,L);this._dirtyRowTracker.markDirty(0);break;case 3:let x=this._activeBuffer.lines.length-this._bufferService.rows;x>0&&(this._activeBuffer.lines.trimStart(x),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-x,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-x,0),this._onScroll.fire(0))}return!0}eraseInLine(C,L=!1){switch(this._restrictCursor(this._bufferService.cols),C.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,L);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,L)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(C){this._restrictCursor();let L=C.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let E=this._activeBuffer.ybase+this._activeBuffer.y,x=this._bufferService.rows-1-this._activeBuffer.scrollBottom,I=this._bufferService.rows-1+this._activeBuffer.ybase-x+1;for(;L--;)this._activeBuffer.lines.splice(I-1,1),this._activeBuffer.lines.splice(E,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(C){this._restrictCursor();let L=C.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let E=this._activeBuffer.ybase+this._activeBuffer.y,x;for(x=this._bufferService.rows-1-this._activeBuffer.scrollBottom,x=this._bufferService.rows-1+this._activeBuffer.ybase-x;L--;)this._activeBuffer.lines.splice(E,1),this._activeBuffer.lines.splice(x,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(C){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.insertCells(this._activeBuffer.x,C.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(C){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.deleteCells(this._activeBuffer.x,C.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(C){let L=C.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(C){let L=C.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(e.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(C){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=C.params[0]||1;for(let E=this._activeBuffer.scrollTop;E<=this._activeBuffer.scrollBottom;++E){let x=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);x.deleteCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(C){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=C.params[0]||1;for(let E=this._activeBuffer.scrollTop;E<=this._activeBuffer.scrollBottom;++E){let x=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);x.insertCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(C){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=C.params[0]||1;for(let E=this._activeBuffer.scrollTop;E<=this._activeBuffer.scrollBottom;++E){let x=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);x.insertCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(C){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=C.params[0]||1;for(let E=this._activeBuffer.scrollTop;E<=this._activeBuffer.scrollBottom;++E){let x=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);x.deleteCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(C){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(C.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(C){if(!this._parser.precedingCodepoint)return!0;let L=C.params[0]||1,E=new Uint32Array(L);for(let x=0;x<L;++x)E[x]=this._parser.precedingCodepoint;return this.print(E,0,E.length),!0}sendDeviceAttributesPrimary(C){return C.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(n.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(n.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(C){return C.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(n.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(n.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(C.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(n.C0.ESC+"[>83;40003;0c")),!0}_is(C){return(this._optionsService.rawOptions.termName+"").indexOf(C)===0}setMode(C){for(let L=0;L<C.length;L++)switch(C.params[L]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(C){for(let L=0;L<C.length;L++)switch(C.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,_.DEFAULT_CHARSET),this._charsetService.setgCharset(1,_.DEFAULT_CHARSET),this._charsetService.setgCharset(2,_.DEFAULT_CHARSET),this._charsetService.setgCharset(3,_.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(C){for(let L=0;L<C.length;L++)switch(C.params[L]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(C){for(let L=0;L<C.length;L++)switch(C.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),C.params[L]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(C,L){let E=this._coreService.decPrivateModes,{activeProtocol:x,activeEncoding:I}=this._coreMouseService,N=this._coreService,{buffers:j,cols:H}=this._bufferService,{active:z,alt:R}=j,A=this._optionsService.rawOptions,T=$=>$?1:2,F=C.params[0];return U=F,V=L?F===2?4:F===4?T(N.modes.insertMode):F===12?3:F===20?T(A.convertEol):0:F===1?T(E.applicationCursorKeys):F===3?A.windowOptions.setWinLines?H===80?2:H===132?1:0:0:F===6?T(E.origin):F===7?T(E.wraparound):F===8?3:F===9?T(x==="X10"):F===12?T(A.cursorBlink):F===25?T(!N.isCursorHidden):F===45?T(E.reverseWraparound):F===66?T(E.applicationKeypad):F===67?4:F===1e3?T(x==="VT200"):F===1002?T(x==="DRAG"):F===1003?T(x==="ANY"):F===1004?T(E.sendFocus):F===1005?4:F===1006?T(I==="SGR"):F===1015?4:F===1016?T(I==="SGR_PIXELS"):F===1048?1:F===47||F===1047||F===1049?T(z===R):F===2004?T(E.bracketedPasteMode):0,N.triggerDataEvent(`${n.C0.ESC}[${L?"":"?"}${U};${V}$y`),!0;var U,V}_updateAttrColor(C,L,E,x,I){return L===2?(C|=50331648,C&=-16777216,C|=d.AttributeData.fromColorRGB([E,x,I])):L===5&&(C&=-50331904,C|=33554432|255&E),C}_extractColor(C,L,E){let x=[0,0,-1,0,0,0],I=0,N=0;do{if(x[N+I]=C.params[L+N],C.hasSubParams(L+N)){let j=C.getSubParams(L+N),H=0;do x[1]===5&&(I=1),x[N+H+1+I]=j[H];while(++H<j.length&&H+N+1+I<x.length);break}if(x[1]===5&&N+I>=2||x[1]===2&&N+I>=5)break;x[1]&&(I=1)}while(++N+L<C.length&&N+I<x.length);for(let j=2;j<x.length;++j)x[j]===-1&&(x[j]=0);switch(x[0]){case 38:E.fg=this._updateAttrColor(E.fg,x[1],x[3],x[4],x[5]);break;case 48:E.bg=this._updateAttrColor(E.bg,x[1],x[3],x[4],x[5]);break;case 58:E.extended=E.extended.clone(),E.extended.underlineColor=this._updateAttrColor(E.extended.underlineColor,x[1],x[3],x[4],x[5])}return N}_processUnderline(C,L){L.extended=L.extended.clone(),(!~C||C>5)&&(C=1),L.extended.underlineStyle=C,L.fg|=268435456,C===0&&(L.fg&=-268435457),L.updateExtended()}_processSGR0(C){C.fg=e.DEFAULT_ATTR_DATA.fg,C.bg=e.DEFAULT_ATTR_DATA.bg,C.extended=C.extended.clone(),C.extended.underlineStyle=0,C.extended.underlineColor&=-67108864,C.updateExtended()}charAttributes(C){if(C.length===1&&C.params[0]===0)return this._processSGR0(this._curAttrData),!0;let L=C.length,E,x=this._curAttrData;for(let I=0;I<L;I++)E=C.params[I],E>=30&&E<=37?(x.fg&=-50331904,x.fg|=16777216|E-30):E>=40&&E<=47?(x.bg&=-50331904,x.bg|=16777216|E-40):E>=90&&E<=97?(x.fg&=-50331904,x.fg|=16777224|E-90):E>=100&&E<=107?(x.bg&=-50331904,x.bg|=16777224|E-100):E===0?this._processSGR0(x):E===1?x.fg|=134217728:E===3?x.bg|=67108864:E===4?(x.fg|=268435456,this._processUnderline(C.hasSubParams(I)?C.getSubParams(I)[0]:1,x)):E===5?x.fg|=536870912:E===7?x.fg|=67108864:E===8?x.fg|=1073741824:E===9?x.fg|=2147483648:E===2?x.bg|=134217728:E===21?this._processUnderline(2,x):E===22?(x.fg&=-134217729,x.bg&=-134217729):E===23?x.bg&=-67108865:E===24?(x.fg&=-268435457,this._processUnderline(0,x)):E===25?x.fg&=-536870913:E===27?x.fg&=-67108865:E===28?x.fg&=-1073741825:E===29?x.fg&=2147483647:E===39?(x.fg&=-67108864,x.fg|=16777215&e.DEFAULT_ATTR_DATA.fg):E===49?(x.bg&=-67108864,x.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):E===38||E===48||E===58?I+=this._extractColor(C,I,x):E===53?x.bg|=1073741824:E===55?x.bg&=-1073741825:E===59?(x.extended=x.extended.clone(),x.extended.underlineColor=-1,x.updateExtended()):E===100?(x.fg&=-67108864,x.fg|=16777215&e.DEFAULT_ATTR_DATA.fg,x.bg&=-67108864,x.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",E);return!0}deviceStatus(C){switch(C.params[0]){case 5:this._coreService.triggerDataEvent(`${n.C0.ESC}[0n`);break;case 6:let L=this._activeBuffer.y+1,E=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${n.C0.ESC}[${L};${E}R`)}return!0}deviceStatusPrivate(C){if(C.params[0]===6){let L=this._activeBuffer.y+1,E=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${n.C0.ESC}[?${L};${E}R`)}return!0}softReset(C){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(C){let L=C.params[0]||1;switch(L){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}let E=L%2==1;return this._optionsService.options.cursorBlink=E,!0}setScrollRegion(C){let L=C.params[0]||1,E;return(C.length<2||(E=C.params[1])>this._bufferService.rows||E===0)&&(E=this._bufferService.rows),E>L&&(this._activeBuffer.scrollTop=L-1,this._activeBuffer.scrollBottom=E-1,this._setCursor(0,0)),!0}windowOptions(C){if(!b(C.params[0],this._optionsService.rawOptions.windowOptions))return!0;let L=C.length>1?C.params[1]:0;switch(C.params[0]){case 14:L!==2&&this._onRequestWindowsOptionsReport.fire(w.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(w.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${n.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:L!==0&&L!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),L!==0&&L!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:L!==0&&L!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),L!==0&&L!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(C){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(C){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(C){return this._windowTitle=C,this._onTitleChange.fire(C),!0}setIconName(C){return this._iconName=C,!0}setOrReportIndexedColor(C){let L=[],E=C.split(";");for(;E.length>1;){let x=E.shift(),I=E.shift();if(/^\d+$/.exec(x)){let N=parseInt(x);if(0<=N&&N<256)if(I==="?")L.push({type:0,index:N});else{let j=(0,c.parseColor)(I);j&&L.push({type:1,index:N,color:j})}}}return L.length&&this._onColor.fire(L),!0}setHyperlink(C){let L=C.split(";");return!(L.length<2)&&(L[1]?this._createHyperlink(L[0],L[1]):!L[0]&&this._finishHyperlink())}_createHyperlink(C,L){this._getCurrentLinkId()&&this._finishHyperlink();let E=C.split(":"),x,I=E.findIndex(N=>N.startsWith("id="));return I!==-1&&(x=E[I].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:x,uri:L}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(C,L){let E=C.split(";");for(let x=0;x<E.length&&!(L>=this._specialColors.length);++x,++L)if(E[x]==="?")this._onColor.fire([{type:0,index:this._specialColors[L]}]);else{let I=(0,c.parseColor)(E[x]);I&&this._onColor.fire([{type:1,index:this._specialColors[L],color:I}])}return!0}setOrReportFgColor(C){return this._setOrReportSpecialColor(C,0)}setOrReportBgColor(C){return this._setOrReportSpecialColor(C,1)}setOrReportCursorColor(C){return this._setOrReportSpecialColor(C,2)}restoreIndexedColor(C){if(!C)return this._onColor.fire([{type:2}]),!0;let L=[],E=C.split(";");for(let x=0;x<E.length;++x)if(/^\d+$/.exec(E[x])){let I=parseInt(E[x]);0<=I&&I<256&&L.push({type:2,index:I})}return L.length&&this._onColor.fire(L),!0}restoreFgColor(C){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(C){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(C){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,_.DEFAULT_CHARSET),!0}selectCharset(C){return C.length!==2?(this.selectDefaultCharset(),!0):(C[0]==="/"||this._charsetService.setgCharset(l[C[0]],_.CHARSETS[C[1]]||_.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let C=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,C,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(C){return this._charsetService.setgLevel(C),!0}screenAlignmentPattern(){let C=new s.CellData;C.content=4194304|"E".charCodeAt(0),C.fg=this._curAttrData.fg,C.bg=this._curAttrData.bg,this._setCursor(0,0);for(let L=0;L<this._bufferService.rows;++L){let E=this._activeBuffer.ybase+this._activeBuffer.y+L,x=this._activeBuffer.lines.get(E);x&&(x.fill(C),x.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(C,L){let E=this._bufferService.buffer,x=this._optionsService.rawOptions;return(I=>(this._coreService.triggerDataEvent(`${n.C0.ESC}${I}${n.C0.ESC}\\`),!0))(C==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:C==='"p'?'P1$r61;1"p':C==="r"?`P1$r${E.scrollTop+1};${E.scrollBottom+1}r`:C==="m"?"P1$r0m":C===" q"?`P1$r${{block:2,underline:4,bar:6}[x.cursorStyle]-(x.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(C,L){this._dirtyRowTracker.markRangeDirty(C,L)}}t.InputHandler=D;let B=class{constructor(O){this._bufferService=O,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(O){O<this.start?this.start=O:O>this.end&&(this.end=O)}markRangeDirty(O,C){O>C&&(y=O,O=C,C=y),O<this.start&&(this.start=O),C>this.end&&(this.end=C)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};B=h([u(0,g.IBufferService)],B)},844:(k,t)=>{function a(h){for(let u of h)u.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){let u=this._disposables.indexOf(h);u!==-1&&this._disposables.splice(u,1)}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=a,t.getDisposeArrayDisposable=function(h){return{dispose:()=>a(h)}}},1505:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(u,n,_){this._data[u]||(this._data[u]={}),this._data[u][n]=_}get(u,n){return this._data[u]?this._data[u][n]:void 0}clear(){this._data={}}}t.TwoKeyMap=a,t.FourKeyMap=class{constructor(){this._data=new a}set(h,u,n,_,p){this._data.get(h,u)||this._data.set(h,u,new a),this._data.get(h,u).set(n,_,p)}get(h,u,n,_){var p;return(p=this._data.get(h,u))===null||p===void 0?void 0:p.get(n,_)}clear(){this._data.clear()}}},6114:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=typeof navigator>"u";let a=t.isNode?"node":navigator.userAgent,h=t.isNode?"node":navigator.platform;t.isFirefox=a.includes("Firefox"),t.isLegacyEdge=a.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(a),t.getSafariVersion=function(){if(!t.isSafari)return 0;let u=a.match(/Version\/(\d+)/);return u===null||u.length<2?0:parseInt(u[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),t.isIpad=h==="iPad",t.isIphone=h==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),t.isLinux=h.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(a)},6106:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let a=0;t.SortedList=class{constructor(h){this._getKey=h,this._array=[]}clear(){this._array.length=0}insert(h){this._array.length!==0?(a=this._search(this._getKey(h),0,this._array.length-1),this._array.splice(a,0,h)):this._array.push(h)}delete(h){if(this._array.length===0)return!1;let u=this._getKey(h);if(u===void 0||(a=this._search(u,0,this._array.length-1),a===-1)||this._getKey(this._array[a])!==u)return!1;do if(this._array[a]===h)return this._array.splice(a,1),!0;while(++a<this._array.length&&this._getKey(this._array[a])===u);return!1}*getKeyIterator(h){if(this._array.length!==0&&(a=this._search(h,0,this._array.length-1),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===h))do yield this._array[a];while(++a<this._array.length&&this._getKey(this._array[a])===h)}forEachByKey(h,u){if(this._array.length!==0&&(a=this._search(h,0,this._array.length-1),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===h))do u(this._array[a]);while(++a<this._array.length&&this._getKey(this._array[a])===h)}values(){return this._array.values()}_search(h,u,n){if(n<u)return u;let _=Math.floor((u+n)/2),p=this._getKey(this._array[_]);if(p>h)return this._search(h,u,_-1);if(p<h)return this._search(h,_+1,n);for(;_>0&&this._getKey(this._array[_-1])===h;)_--;return _}}},7226:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;let h=a(6114);class u{constructor(){this._tasks=[],this._i=0}enqueue(p){this._tasks.push(p),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(p){this._idleCallback=void 0;let f=0,i=0,e=p.timeRemaining(),r=0;for(;this._i<this._tasks.length;){if(f=Date.now(),this._tasks[this._i]()||this._i++,f=Math.max(1,Date.now()-f),i=Math.max(f,i),r=p.timeRemaining(),1.5*i>r)return e-f<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(e-f))}ms`),void this._start();e=r}this.clear()}}class n extends u{_requestCallback(p){return setTimeout(()=>p(this._createDeadline(16)))}_cancelCallback(p){clearTimeout(p)}_createDeadline(p){let f=Date.now()+p;return{timeRemaining:()=>Math.max(0,f-Date.now())}}}t.PriorityTaskQueue=n,t.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends u{_requestCallback(_){return requestIdleCallback(_)}_cancelCallback(_){cancelIdleCallback(_)}}:n,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(_){this._queue.clear(),this._queue.enqueue(_)}flush(){this._queue.flush()}}},9282:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;let h=a(643);t.updateWindowsModeWrappedState=function(u){let n=u.buffer.lines.get(u.buffer.ybase+u.buffer.y-1),_=n?.get(u.cols-1),p=u.buffer.lines.get(u.buffer.ybase+u.buffer.y);p&&_&&(p.isWrapped=_[h.CHAR_DATA_CODE_INDEX]!==h.NULL_CELL_CODE&&_[h.CHAR_DATA_CODE_INDEX]!==h.WHITESPACE_CELL_CODE)}},3734:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(n){return[n>>>16&255,n>>>8&255,255&n]}static fromColorRGB(n){return(255&n[0])<<16|(255&n[1])<<8|255&n[2]}clone(){let n=new a;return n.fg=this.fg,n.bg=this.bg,n.extended=this.extended.clone(),n}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}t.AttributeData=a;class h{constructor(n=0,_=0){this._ext=0,this._urlId=0,this._ext=n,this._urlId=_}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(n){this._ext=n}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(n){this._ext&=-469762049,this._ext|=n<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(n){this._ext&=-67108864,this._ext|=67108863&n}get urlId(){return this._urlId}set urlId(n){this._urlId=n}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}t.ExtendedAttrs=h},9092:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;let h=a(6349),u=a(8437),n=a(511),_=a(643),p=a(4634),f=a(4863),i=a(7116),e=a(3734),r=a(7226);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(o,s,d){this._hasScrollback=o,this._optionsService=s,this._bufferService=d,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=u.DEFAULT_ATTR_DATA.clone(),this.savedCharset=i.DEFAULT_CHARSET,this.markers=[],this._nullCell=n.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=n.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new r.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(o){return o?(this._nullCell.fg=o.fg,this._nullCell.bg=o.bg,this._nullCell.extended=o.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new e.ExtendedAttrs),this._nullCell}getWhitespaceCell(o){return o?(this._whitespaceCell.fg=o.fg,this._whitespaceCell.bg=o.bg,this._whitespaceCell.extended=o.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new e.ExtendedAttrs),this._whitespaceCell}getBlankLine(o,s){return new u.BufferLine(this._bufferService.cols,this.getNullCell(o),s)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let o=this.ybase+this.y-this.ydisp;return o>=0&&o<this._rows}_getCorrectBufferLength(o){if(!this._hasScrollback)return o;let s=o+this._optionsService.rawOptions.scrollback;return s>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:s}fillViewportRows(o){if(this.lines.length===0){o===void 0&&(o=u.DEFAULT_ATTR_DATA);let s=this._rows;for(;s--;)this.lines.push(this.getBlankLine(o))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(o,s){let d=this.getNullCell(u.DEFAULT_ATTR_DATA),g=0,v=this._getCorrectBufferLength(s);if(v>this.lines.maxLength&&(this.lines.maxLength=v),this.lines.length>0){if(this._cols<o)for(let c=0;c<this.lines.length;c++)g+=+this.lines.get(c).resize(o,d);let m=0;if(this._rows<s)for(let c=this._rows;c<s;c++)this.lines.length<s+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new u.BufferLine(o,d)):this.ybase>0&&this.lines.length<=this.ybase+this.y+m+1?(this.ybase--,m++,this.ydisp>0&&this.ydisp--):this.lines.push(new u.BufferLine(o,d)));else for(let c=this._rows;c>s;c--)this.lines.length>s+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(v<this.lines.maxLength){let c=this.lines.length-v;c>0&&(this.lines.trimStart(c),this.ybase=Math.max(this.ybase-c,0),this.ydisp=Math.max(this.ydisp-c,0),this.savedY=Math.max(this.savedY-c,0)),this.lines.maxLength=v}this.x=Math.min(this.x,o-1),this.y=Math.min(this.y,s-1),m&&(this.y+=m),this.savedX=Math.min(this.savedX,o-1),this.scrollTop=0}if(this.scrollBottom=s-1,this._isReflowEnabled&&(this._reflow(o,s),this._cols>o))for(let m=0;m<this.lines.length;m++)g+=+this.lines.get(m).resize(o,d);this._cols=o,this._rows=s,this._memoryCleanupQueue.clear(),g>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let o=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,o=!1);let s=0;for(;this._memoryCleanupPosition<this.lines.length;)if(s+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),s>100)return!0;return o}get _isReflowEnabled(){let o=this._optionsService.rawOptions.windowsPty;return o&&o.buildNumber?this._hasScrollback&&o.backend==="conpty"&&o.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(o,s){this._cols!==o&&(o>this._cols?this._reflowLarger(o,s):this._reflowSmaller(o,s))}_reflowLarger(o,s){let d=(0,p.reflowLargerGetLinesToRemove)(this.lines,this._cols,o,this.ybase+this.y,this.getNullCell(u.DEFAULT_ATTR_DATA));if(d.length>0){let g=(0,p.reflowLargerCreateNewLayout)(this.lines,d);(0,p.reflowLargerApplyNewLayout)(this.lines,g.layout),this._reflowLargerAdjustViewport(o,s,g.countRemoved)}}_reflowLargerAdjustViewport(o,s,d){let g=this.getNullCell(u.DEFAULT_ATTR_DATA),v=d;for(;v-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<s&&this.lines.push(new u.BufferLine(o,g))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-d,0)}_reflowSmaller(o,s){let d=this.getNullCell(u.DEFAULT_ATTR_DATA),g=[],v=0;for(let m=this.lines.length-1;m>=0;m--){let c=this.lines.get(m);if(!c||!c.isWrapped&&c.getTrimmedLength()<=o)continue;let l=[c];for(;c.isWrapped&&m>0;)c=this.lines.get(--m),l.unshift(c);let S=this.ybase+this.y;if(S>=m&&S<m+l.length)continue;let b=l[l.length-1].getTrimmedLength(),w=(0,p.reflowSmallerGetNewLineLengths)(l,this._cols,o),y=w.length-l.length,D;D=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+y):Math.max(0,this.lines.length-this.lines.maxLength+y);let B=[];for(let I=0;I<y;I++){let N=this.getBlankLine(u.DEFAULT_ATTR_DATA,!0);B.push(N)}B.length>0&&(g.push({start:m+l.length+v,newLines:B}),v+=B.length),l.push(...B);let O=w.length-1,C=w[O];C===0&&(O--,C=w[O]);let L=l.length-y-1,E=b;for(;L>=0;){let I=Math.min(E,C);if(l[O]===void 0)break;if(l[O].copyCellsFrom(l[L],E-I,C-I,I,!0),C-=I,C===0&&(O--,C=w[O]),E-=I,E===0){L--;let N=Math.max(L,0);E=(0,p.getWrappedLineTrimmedLength)(l,N,this._cols)}}for(let I=0;I<l.length;I++)w[I]<o&&l[I].setCell(w[I],d);let x=y-D;for(;x-- >0;)this.ybase===0?this.y<s-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+v)-s&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+y,this.ybase+s-1)}if(g.length>0){let m=[],c=[];for(let O=0;O<this.lines.length;O++)c.push(this.lines.get(O));let l=this.lines.length,S=l-1,b=0,w=g[b];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+v);let y=0;for(let O=Math.min(this.lines.maxLength-1,l+v-1);O>=0;O--)if(w&&w.start>S+y){for(let C=w.newLines.length-1;C>=0;C--)this.lines.set(O--,w.newLines[C]);O++,m.push({index:S+1,amount:w.newLines.length}),y+=w.newLines.length,w=g[++b]}else this.lines.set(O,c[S--]);let D=0;for(let O=m.length-1;O>=0;O--)m[O].index+=D,this.lines.onInsertEmitter.fire(m[O]),D+=m[O].amount;let B=Math.max(0,l+v-this.lines.maxLength);B>0&&this.lines.onTrimEmitter.fire(B)}}translateBufferLineToString(o,s,d=0,g){let v=this.lines.get(o);return v?v.translateToString(s,d,g):""}getWrappedRangeForLine(o){let s=o,d=o;for(;s>0&&this.lines.get(s).isWrapped;)s--;for(;d+1<this.lines.length&&this.lines.get(d+1).isWrapped;)d++;return{first:s,last:d}}setupTabStops(o){for(o!=null?this.tabs[o]||(o=this.prevStop(o)):(this.tabs={},o=0);o<this._cols;o+=this._optionsService.rawOptions.tabStopWidth)this.tabs[o]=!0}prevStop(o){for(o==null&&(o=this.x);!this.tabs[--o]&&o>0;);return o>=this._cols?this._cols-1:o<0?0:o}nextStop(o){for(o==null&&(o=this.x);!this.tabs[++o]&&o<this._cols;);return o>=this._cols?this._cols-1:o<0?0:o}clearMarkers(o){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].line===o&&(this.markers[s].dispose(),this.markers.splice(s--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let o=0;o<this.markers.length;o++)this.markers[o].dispose(),this.markers.splice(o--,1);this._isClearing=!1}addMarker(o){let s=new f.Marker(o);return this.markers.push(s),s.register(this.lines.onTrim(d=>{s.line-=d,s.line<0&&s.dispose()})),s.register(this.lines.onInsert(d=>{s.line>=d.index&&(s.line+=d.amount)})),s.register(this.lines.onDelete(d=>{s.line>=d.index&&s.line<d.index+d.amount&&s.dispose(),s.line>d.index&&(s.line-=d.amount)})),s.register(s.onDispose(()=>this._removeMarker(s))),s}_removeMarker(o){this._isClearing||this.markers.splice(this.markers.indexOf(o),1)}}},8437:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;let h=a(482),u=a(643),n=a(511),_=a(3734);t.DEFAULT_ATTR_DATA=Object.freeze(new _.AttributeData);let p=0;class f{constructor(e,r,o=!1){this.isWrapped=o,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);let s=r||n.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]);for(let d=0;d<e;++d)this.setCell(d,s);this.length=e}get(e){let r=this._data[3*e+0],o=2097151&r;return[this._data[3*e+1],2097152&r?this._combined[e]:o?(0,h.stringFromCodePoint)(o):"",r>>22,2097152&r?this._combined[e].charCodeAt(this._combined[e].length-1):o]}set(e,r){this._data[3*e+1]=r[u.CHAR_DATA_ATTR_INDEX],r[u.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=r[1],this._data[3*e+0]=2097152|e|r[u.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=r[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|r[u.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(e){return this._data[3*e+0]>>22}hasWidth(e){return 12582912&this._data[3*e+0]}getFg(e){return this._data[3*e+1]}getBg(e){return this._data[3*e+2]}hasContent(e){return 4194303&this._data[3*e+0]}getCodePoint(e){let r=this._data[3*e+0];return 2097152&r?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&r}isCombined(e){return 2097152&this._data[3*e+0]}getString(e){let r=this._data[3*e+0];return 2097152&r?this._combined[e]:2097151&r?(0,h.stringFromCodePoint)(2097151&r):""}isProtected(e){return 536870912&this._data[3*e+2]}loadCell(e,r){return p=3*e,r.content=this._data[p+0],r.fg=this._data[p+1],r.bg=this._data[p+2],2097152&r.content&&(r.combinedData=this._combined[e]),268435456&r.bg&&(r.extended=this._extendedAttrs[e]),r}setCell(e,r){2097152&r.content&&(this._combined[e]=r.combinedData),268435456&r.bg&&(this._extendedAttrs[e]=r.extended),this._data[3*e+0]=r.content,this._data[3*e+1]=r.fg,this._data[3*e+2]=r.bg}setCellFromCodePoint(e,r,o,s,d,g){268435456&d&&(this._extendedAttrs[e]=g),this._data[3*e+0]=r|o<<22,this._data[3*e+1]=s,this._data[3*e+2]=d}addCodepointToCell(e,r){let o=this._data[3*e+0];2097152&o?this._combined[e]+=(0,h.stringFromCodePoint)(r):(2097151&o?(this._combined[e]=(0,h.stringFromCodePoint)(2097151&o)+(0,h.stringFromCodePoint)(r),o&=-2097152,o|=2097152):o=r|4194304,this._data[3*e+0]=o)}insertCells(e,r,o,s){if((e%=this.length)&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,s?.fg||0,s?.bg||0,s?.extended||new _.ExtendedAttrs),r<this.length-e){let d=new n.CellData;for(let g=this.length-e-r-1;g>=0;--g)this.setCell(e+r+g,this.loadCell(e+g,d));for(let g=0;g<r;++g)this.setCell(e+g,o)}else for(let d=e;d<this.length;++d)this.setCell(d,o);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,s?.fg||0,s?.bg||0,s?.extended||new _.ExtendedAttrs)}deleteCells(e,r,o,s){if(e%=this.length,r<this.length-e){let d=new n.CellData;for(let g=0;g<this.length-e-r;++g)this.setCell(e+g,this.loadCell(e+r+g,d));for(let g=this.length-r;g<this.length;++g)this.setCell(g,o)}else for(let d=e;d<this.length;++d)this.setCell(d,o);e&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,s?.fg||0,s?.bg||0,s?.extended||new _.ExtendedAttrs),this.getWidth(e)!==0||this.hasContent(e)||this.setCellFromCodePoint(e,0,1,s?.fg||0,s?.bg||0,s?.extended||new _.ExtendedAttrs)}replaceCells(e,r,o,s,d=!1){if(d)for(e&&this.getWidth(e-1)===2&&!this.isProtected(e-1)&&this.setCellFromCodePoint(e-1,0,1,s?.fg||0,s?.bg||0,s?.extended||new _.ExtendedAttrs),r<this.length&&this.getWidth(r-1)===2&&!this.isProtected(r)&&this.setCellFromCodePoint(r,0,1,s?.fg||0,s?.bg||0,s?.extended||new _.ExtendedAttrs);e<r&&e<this.length;)this.isProtected(e)||this.setCell(e,o),e++;else for(e&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,s?.fg||0,s?.bg||0,s?.extended||new _.ExtendedAttrs),r<this.length&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r,0,1,s?.fg||0,s?.bg||0,s?.extended||new _.ExtendedAttrs);e<r&&e<this.length;)this.setCell(e++,o)}resize(e,r){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;let o=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*o)this._data=new Uint32Array(this._data.buffer,0,o);else{let s=new Uint32Array(o);s.set(this._data),this._data=s}for(let s=this.length;s<e;++s)this.setCell(s,r)}else{this._data=this._data.subarray(0,o);let s=Object.keys(this._combined);for(let g=0;g<s.length;g++){let v=parseInt(s[g],10);v>=e&&delete this._combined[v]}let d=Object.keys(this._extendedAttrs);for(let g=0;g<d.length;g++){let v=parseInt(d[g],10);v>=e&&delete this._extendedAttrs[v]}}return this.length=e,4*o*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){let e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,r=!1){if(r)for(let o=0;o<this.length;++o)this.isProtected(o)||this.setCell(o,e);else{this._combined={},this._extendedAttrs={};for(let o=0;o<this.length;++o)this.setCell(o,e)}}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(let r in e._combined)this._combined[r]=e._combined[r];this._extendedAttrs={};for(let r in e._extendedAttrs)this._extendedAttrs[r]=e._extendedAttrs[r];this.isWrapped=e.isWrapped}clone(){let e=new f(0);e._data=new Uint32Array(this._data),e.length=this.length;for(let r in this._combined)e._combined[r]=this._combined[r];for(let r in this._extendedAttrs)e._extendedAttrs[r]=this._extendedAttrs[r];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}copyCellsFrom(e,r,o,s,d){let g=e._data;if(d)for(let m=s-1;m>=0;m--){for(let c=0;c<3;c++)this._data[3*(o+m)+c]=g[3*(r+m)+c];268435456&g[3*(r+m)+2]&&(this._extendedAttrs[o+m]=e._extendedAttrs[r+m])}else for(let m=0;m<s;m++){for(let c=0;c<3;c++)this._data[3*(o+m)+c]=g[3*(r+m)+c];268435456&g[3*(r+m)+2]&&(this._extendedAttrs[o+m]=e._extendedAttrs[r+m])}let v=Object.keys(e._combined);for(let m=0;m<v.length;m++){let c=parseInt(v[m],10);c>=r&&(this._combined[c-r+o]=e._combined[c])}}translateToString(e=!1,r=0,o=this.length){e&&(o=Math.min(o,this.getTrimmedLength()));let s="";for(;r<o;){let d=this._data[3*r+0],g=2097151&d;s+=2097152&d?this._combined[r]:g?(0,h.stringFromCodePoint)(g):u.WHITESPACE_CELL_CHAR,r+=d>>22||1}return s}}t.BufferLine=f},4841:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(a,h){if(a.start.y>a.end.y)throw new Error(`Buffer range end (${a.end.x}, ${a.end.y}) cannot be before start (${a.start.x}, ${a.start.y})`);return h*(a.end.y-a.start.y)+(a.end.x-a.start.x+1)}},4634:(k,t)=>{function a(h,u,n){if(u===h.length-1)return h[u].getTrimmedLength();let _=!h[u].hasContent(n-1)&&h[u].getWidth(n-1)===1,p=h[u+1].getWidth(0)===2;return _&&p?n-1:n}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(h,u,n,_,p){let f=[];for(let i=0;i<h.length-1;i++){let e=i,r=h.get(++e);if(!r.isWrapped)continue;let o=[h.get(i)];for(;e<h.length&&r.isWrapped;)o.push(r),r=h.get(++e);if(_>=i&&_<e){i+=o.length-1;continue}let s=0,d=a(o,s,u),g=1,v=0;for(;g<o.length;){let c=a(o,g,u),l=c-v,S=n-d,b=Math.min(l,S);o[s].copyCellsFrom(o[g],v,d,b,!1),d+=b,d===n&&(s++,d=0),v+=b,v===c&&(g++,v=0),d===0&&s!==0&&o[s-1].getWidth(n-1)===2&&(o[s].copyCellsFrom(o[s-1],n-1,d++,1,!1),o[s-1].setCell(n-1,p))}o[s].replaceCells(d,n,p);let m=0;for(let c=o.length-1;c>0&&(c>s||o[c].getTrimmedLength()===0);c--)m++;m>0&&(f.push(i+o.length-m),f.push(m)),i+=o.length-1}return f},t.reflowLargerCreateNewLayout=function(h,u){let n=[],_=0,p=u[_],f=0;for(let i=0;i<h.length;i++)if(p===i){let e=u[++_];h.onDeleteEmitter.fire({index:i-f,amount:e}),i+=e-1,f+=e,p=u[++_]}else n.push(i);return{layout:n,countRemoved:f}},t.reflowLargerApplyNewLayout=function(h,u){let n=[];for(let _=0;_<u.length;_++)n.push(h.get(u[_]));for(let _=0;_<n.length;_++)h.set(_,n[_]);h.length=u.length},t.reflowSmallerGetNewLineLengths=function(h,u,n){let _=[],p=h.map((r,o)=>a(h,o,u)).reduce((r,o)=>r+o),f=0,i=0,e=0;for(;e<p;){if(p-e<n){_.push(p-e);break}f+=n;let r=a(h,i,u);f>r&&(f-=r,i++);let o=h[i].getWidth(f-1)===2;o&&f--;let s=o?n-1:n;_.push(s),e+=s}return _},t.getWrappedLineTrimmedLength=a},5295:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;let h=a(9092),u=a(8460),n=a(844);class _ extends n.Disposable{constructor(f,i){super(),this._optionsService=f,this._bufferService=i,this._onBufferActivate=this.register(new u.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new h.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new h.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(f){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(f),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(f,i){this._normal.resize(f,i),this._alt.resize(f,i),this.setupTabStops(f)}setupTabStops(f){this._normal.setupTabStops(f),this._alt.setupTabStops(f)}}t.BufferSet=_},511:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;let h=a(482),u=a(643),n=a(3734);class _ extends n.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new n.ExtendedAttrs,this.combinedData=""}static fromCharData(f){let i=new _;return i.setFromCharData(f),i}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(f){this.fg=f[u.CHAR_DATA_ATTR_INDEX],this.bg=0;let i=!1;if(f[u.CHAR_DATA_CHAR_INDEX].length>2)i=!0;else if(f[u.CHAR_DATA_CHAR_INDEX].length===2){let e=f[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=e&&e<=56319){let r=f[u.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(e-55296)+r-56320+65536|f[u.CHAR_DATA_WIDTH_INDEX]<<22:i=!0}else i=!0}else this.content=f[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|f[u.CHAR_DATA_WIDTH_INDEX]<<22;i&&(this.combinedData=f[u.CHAR_DATA_CHAR_INDEX],this.content=2097152|f[u.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=_},643:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;let h=a(8460),u=a(844);class n{constructor(p){this.line=p,this.isDisposed=!1,this._disposables=[],this._id=n._nextId++,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,u.disposeArray)(this._disposables),this._disposables.length=0)}register(p){return this._disposables.push(p),p}}t.Marker=n,n._nextId=1},7116:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},t.CHARSETS.A={"#":"\xA3"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},t.CHARSETS.C=t.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},t.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},t.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},t.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},t.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},t.CHARSETS.E=t.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},t.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},t.CHARSETS.H=t.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},t.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(k,t)=>{var a,h;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(u){u.NUL="\0",u.SOH="",u.STX="",u.ETX="",u.EOT="",u.ENQ="",u.ACK="",u.BEL="\x07",u.BS="\b",u.HT="	",u.LF=`
`,u.VT="\v",u.FF="\f",u.CR="\r",u.SO="",u.SI="",u.DLE="",u.DC1="",u.DC2="",u.DC3="",u.DC4="",u.NAK="",u.SYN="",u.ETB="",u.CAN="",u.EM="",u.SUB="",u.ESC="\x1B",u.FS="",u.GS="",u.RS="",u.US="",u.SP=" ",u.DEL="\x7F"}(a=t.C0||(t.C0={})),(h=t.C1||(t.C1={})).PAD="\x80",h.HOP="\x81",h.BPH="\x82",h.NBH="\x83",h.IND="\x84",h.NEL="\x85",h.SSA="\x86",h.ESA="\x87",h.HTS="\x88",h.HTJ="\x89",h.VTS="\x8A",h.PLD="\x8B",h.PLU="\x8C",h.RI="\x8D",h.SS2="\x8E",h.SS3="\x8F",h.DCS="\x90",h.PU1="\x91",h.PU2="\x92",h.STS="\x93",h.CCH="\x94",h.MW="\x95",h.SPA="\x96",h.EPA="\x97",h.SOS="\x98",h.SGCI="\x99",h.SCI="\x9A",h.CSI="\x9B",h.ST="\x9C",h.OSC="\x9D",h.PM="\x9E",h.APC="\x9F",(t.C1_ESCAPED||(t.C1_ESCAPED={})).ST=`${a.ESC}\\`},7399:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;let h=a(2584),u={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(n,_,p,f){let i={type:0,cancel:!1,key:void 0},e=(n.shiftKey?1:0)|(n.altKey?2:0)|(n.ctrlKey?4:0)|(n.metaKey?8:0);switch(n.keyCode){case 0:n.key==="UIKeyInputUpArrow"?i.key=_?h.C0.ESC+"OA":h.C0.ESC+"[A":n.key==="UIKeyInputLeftArrow"?i.key=_?h.C0.ESC+"OD":h.C0.ESC+"[D":n.key==="UIKeyInputRightArrow"?i.key=_?h.C0.ESC+"OC":h.C0.ESC+"[C":n.key==="UIKeyInputDownArrow"&&(i.key=_?h.C0.ESC+"OB":h.C0.ESC+"[B");break;case 8:if(n.altKey){i.key=h.C0.ESC+h.C0.DEL;break}i.key=h.C0.DEL;break;case 9:if(n.shiftKey){i.key=h.C0.ESC+"[Z";break}i.key=h.C0.HT,i.cancel=!0;break;case 13:i.key=n.altKey?h.C0.ESC+h.C0.CR:h.C0.CR,i.cancel=!0;break;case 27:i.key=h.C0.ESC,n.altKey&&(i.key=h.C0.ESC+h.C0.ESC),i.cancel=!0;break;case 37:if(n.metaKey)break;e?(i.key=h.C0.ESC+"[1;"+(e+1)+"D",i.key===h.C0.ESC+"[1;3D"&&(i.key=h.C0.ESC+(p?"b":"[1;5D"))):i.key=_?h.C0.ESC+"OD":h.C0.ESC+"[D";break;case 39:if(n.metaKey)break;e?(i.key=h.C0.ESC+"[1;"+(e+1)+"C",i.key===h.C0.ESC+"[1;3C"&&(i.key=h.C0.ESC+(p?"f":"[1;5C"))):i.key=_?h.C0.ESC+"OC":h.C0.ESC+"[C";break;case 38:if(n.metaKey)break;e?(i.key=h.C0.ESC+"[1;"+(e+1)+"A",p||i.key!==h.C0.ESC+"[1;3A"||(i.key=h.C0.ESC+"[1;5A")):i.key=_?h.C0.ESC+"OA":h.C0.ESC+"[A";break;case 40:if(n.metaKey)break;e?(i.key=h.C0.ESC+"[1;"+(e+1)+"B",p||i.key!==h.C0.ESC+"[1;3B"||(i.key=h.C0.ESC+"[1;5B")):i.key=_?h.C0.ESC+"OB":h.C0.ESC+"[B";break;case 45:n.shiftKey||n.ctrlKey||(i.key=h.C0.ESC+"[2~");break;case 46:i.key=e?h.C0.ESC+"[3;"+(e+1)+"~":h.C0.ESC+"[3~";break;case 36:i.key=e?h.C0.ESC+"[1;"+(e+1)+"H":_?h.C0.ESC+"OH":h.C0.ESC+"[H";break;case 35:i.key=e?h.C0.ESC+"[1;"+(e+1)+"F":_?h.C0.ESC+"OF":h.C0.ESC+"[F";break;case 33:n.shiftKey?i.type=2:n.ctrlKey?i.key=h.C0.ESC+"[5;"+(e+1)+"~":i.key=h.C0.ESC+"[5~";break;case 34:n.shiftKey?i.type=3:n.ctrlKey?i.key=h.C0.ESC+"[6;"+(e+1)+"~":i.key=h.C0.ESC+"[6~";break;case 112:i.key=e?h.C0.ESC+"[1;"+(e+1)+"P":h.C0.ESC+"OP";break;case 113:i.key=e?h.C0.ESC+"[1;"+(e+1)+"Q":h.C0.ESC+"OQ";break;case 114:i.key=e?h.C0.ESC+"[1;"+(e+1)+"R":h.C0.ESC+"OR";break;case 115:i.key=e?h.C0.ESC+"[1;"+(e+1)+"S":h.C0.ESC+"OS";break;case 116:i.key=e?h.C0.ESC+"[15;"+(e+1)+"~":h.C0.ESC+"[15~";break;case 117:i.key=e?h.C0.ESC+"[17;"+(e+1)+"~":h.C0.ESC+"[17~";break;case 118:i.key=e?h.C0.ESC+"[18;"+(e+1)+"~":h.C0.ESC+"[18~";break;case 119:i.key=e?h.C0.ESC+"[19;"+(e+1)+"~":h.C0.ESC+"[19~";break;case 120:i.key=e?h.C0.ESC+"[20;"+(e+1)+"~":h.C0.ESC+"[20~";break;case 121:i.key=e?h.C0.ESC+"[21;"+(e+1)+"~":h.C0.ESC+"[21~";break;case 122:i.key=e?h.C0.ESC+"[23;"+(e+1)+"~":h.C0.ESC+"[23~";break;case 123:i.key=e?h.C0.ESC+"[24;"+(e+1)+"~":h.C0.ESC+"[24~";break;default:if(!n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)if(p&&!f||!n.altKey||n.metaKey)!p||n.altKey||n.ctrlKey||n.shiftKey||!n.metaKey?n.key&&!n.ctrlKey&&!n.altKey&&!n.metaKey&&n.keyCode>=48&&n.key.length===1?i.key=n.key:n.key&&n.ctrlKey&&(n.key==="_"&&(i.key=h.C0.US),n.key==="@"&&(i.key=h.C0.NUL)):n.keyCode===65&&(i.type=1);else{let r=u[n.keyCode],o=r?.[n.shiftKey?1:0];if(o)i.key=h.C0.ESC+o;else if(n.keyCode>=65&&n.keyCode<=90){let s=n.ctrlKey?n.keyCode-64:n.keyCode+32,d=String.fromCharCode(s);n.shiftKey&&(d=d.toUpperCase()),i.key=h.C0.ESC+d}else if(n.keyCode===32)i.key=h.C0.ESC+(n.ctrlKey?h.C0.NUL:" ");else if(n.key==="Dead"&&n.code.startsWith("Key")){let s=n.code.slice(3,4);n.shiftKey||(s=s.toLowerCase()),i.key=h.C0.ESC+s,i.cancel=!0}}else n.keyCode>=65&&n.keyCode<=90?i.key=String.fromCharCode(n.keyCode-64):n.keyCode===32?i.key=h.C0.NUL:n.keyCode>=51&&n.keyCode<=55?i.key=String.fromCharCode(n.keyCode-51+27):n.keyCode===56?i.key=h.C0.DEL:n.keyCode===219?i.key=h.C0.ESC:n.keyCode===220?i.key=h.C0.FS:n.keyCode===221&&(i.key=h.C0.GS)}return i}},482:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},t.utf32ToString=function(a,h=0,u=a.length){let n="";for(let _=h;_<u;++_){let p=a[_];p>65535?(p-=65536,n+=String.fromCharCode(55296+(p>>10))+String.fromCharCode(p%1024+56320)):n+=String.fromCharCode(p)}return n},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,h){let u=a.length;if(!u)return 0;let n=0,_=0;if(this._interim){let p=a.charCodeAt(_++);56320<=p&&p<=57343?h[n++]=1024*(this._interim-55296)+p-56320+65536:(h[n++]=this._interim,h[n++]=p),this._interim=0}for(let p=_;p<u;++p){let f=a.charCodeAt(p);if(55296<=f&&f<=56319){if(++p>=u)return this._interim=f,n;let i=a.charCodeAt(p);56320<=i&&i<=57343?h[n++]=1024*(f-55296)+i-56320+65536:(h[n++]=f,h[n++]=i)}else f!==65279&&(h[n++]=f)}return n}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,h){let u=a.length;if(!u)return 0;let n,_,p,f,i=0,e=0,r=0;if(this.interim[0]){let d=!1,g=this.interim[0];g&=(224&g)==192?31:(240&g)==224?15:7;let v,m=0;for(;(v=63&this.interim[++m])&&m<4;)g<<=6,g|=v;let c=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,l=c-m;for(;r<l;){if(r>=u)return 0;if(v=a[r++],(192&v)!=128){r--,d=!0;break}this.interim[m++]=v,g<<=6,g|=63&v}d||(c===2?g<128?r--:h[i++]=g:c===3?g<2048||g>=55296&&g<=57343||g===65279||(h[i++]=g):g<65536||g>1114111||(h[i++]=g)),this.interim.fill(0)}let o=u-4,s=r;for(;s<u;){for(;!(!(s<o)||128&(n=a[s])||128&(_=a[s+1])||128&(p=a[s+2])||128&(f=a[s+3]));)h[i++]=n,h[i++]=_,h[i++]=p,h[i++]=f,s+=4;if(n=a[s++],n<128)h[i++]=n;else if((224&n)==192){if(s>=u)return this.interim[0]=n,i;if(_=a[s++],(192&_)!=128){s--;continue}if(e=(31&n)<<6|63&_,e<128){s--;continue}h[i++]=e}else if((240&n)==224){if(s>=u)return this.interim[0]=n,i;if(_=a[s++],(192&_)!=128){s--;continue}if(s>=u)return this.interim[0]=n,this.interim[1]=_,i;if(p=a[s++],(192&p)!=128){s--;continue}if(e=(15&n)<<12|(63&_)<<6|63&p,e<2048||e>=55296&&e<=57343||e===65279)continue;h[i++]=e}else if((248&n)==240){if(s>=u)return this.interim[0]=n,i;if(_=a[s++],(192&_)!=128){s--;continue}if(s>=u)return this.interim[0]=n,this.interim[1]=_,i;if(p=a[s++],(192&p)!=128){s--;continue}if(s>=u)return this.interim[0]=n,this.interim[1]=_,this.interim[2]=p,i;if(f=a[s++],(192&f)!=128){s--;continue}if(e=(7&n)<<18|(63&_)<<12|(63&p)<<6|63&f,e<65536||e>1114111)continue;h[i++]=e}}return i}}},225:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;let a=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],h=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],u;t.UnicodeV6=class{constructor(){if(this.version="6",!u){u=new Uint8Array(65536),u.fill(1),u[0]=0,u.fill(0,1,32),u.fill(0,127,160),u.fill(2,4352,4448),u[9001]=2,u[9002]=2,u.fill(2,11904,42192),u[12351]=1,u.fill(2,44032,55204),u.fill(2,63744,64256),u.fill(2,65040,65050),u.fill(2,65072,65136),u.fill(2,65280,65377),u.fill(2,65504,65511);for(let n=0;n<a.length;++n)u.fill(0,a[n][0],a[n][1]+1)}}wcwidth(n){return n<32?0:n<127?1:n<65536?u[n]:function(_,p){let f,i=0,e=p.length-1;if(_<p[0][0]||_>p[e][1])return!1;for(;e>=i;)if(f=i+e>>1,_>p[f][1])i=f+1;else{if(!(_<p[f][0]))return!0;e=f-1}return!1}(n,h)?0:n>=131072&&n<=196605||n>=196608&&n<=262141?2:1}}},5981:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;let h=a(8460),u=a(844);class n extends u.Disposable{constructor(p){super(),this._action=p,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(p,f){if(f!==void 0&&this._syncCalls>f)return void(this._syncCalls=0);if(this._pendingData+=p.length,this._writeBuffer.push(p),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let i;for(this._isSyncWriting=!0;i=this._writeBuffer.shift();){this._action(i);let e=this._callbacks.shift();e&&e()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(p,f){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=p.length,this._writeBuffer.push(p),this._callbacks.push(f),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=p.length,this._writeBuffer.push(p),this._callbacks.push(f)}_innerWrite(p=0,f=!0){let i=p||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){let e=this._writeBuffer[this._bufferOffset],r=this._action(e,f);if(r){let s=d=>Date.now()-i>=12?setTimeout(()=>this._innerWrite(0,d)):this._innerWrite(i,d);return void r.catch(d=>(queueMicrotask(()=>{throw d}),Promise.resolve(!1))).then(s)}let o=this._callbacks[this._bufferOffset];if(o&&o(),this._bufferOffset++,this._pendingData-=e.length,Date.now()-i>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=n},5941:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;let a=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,h=/^[\da-f]+$/;function u(n,_){let p=n.toString(16),f=p.length<2?"0"+p:p;switch(_){case 4:return p[0];case 8:return f;case 12:return(f+f).slice(0,3);default:return f+f}}t.parseColor=function(n){if(!n)return;let _=n.toLowerCase();if(_.indexOf("rgb:")===0){_=_.slice(4);let p=a.exec(_);if(p){let f=p[1]?15:p[4]?255:p[7]?4095:65535;return[Math.round(parseInt(p[1]||p[4]||p[7]||p[10],16)/f*255),Math.round(parseInt(p[2]||p[5]||p[8]||p[11],16)/f*255),Math.round(parseInt(p[3]||p[6]||p[9]||p[12],16)/f*255)]}}else if(_.indexOf("#")===0&&(_=_.slice(1),h.exec(_)&&[3,6,9,12].includes(_.length))){let p=_.length/3,f=[0,0,0];for(let i=0;i<3;++i){let e=parseInt(_.slice(p*i,p*i+p),16);f[i]=p===1?e<<4:p===2?e:p===3?e>>4:e>>8}return f}},t.toRgbString=function(n,_=16){let[p,f,i]=n;return`rgb:${u(p,_)}/${u(f,_)}/${u(i,_)}`}},5770:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;let h=a(482),u=a(8742),n=a(5770),_=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=_,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=_}registerHandler(f,i){this._handlers[f]===void 0&&(this._handlers[f]=[]);let e=this._handlers[f];return e.push(i),{dispose:()=>{let r=e.indexOf(i);r!==-1&&e.splice(r,1)}}}clearHandler(f){this._handlers[f]&&delete this._handlers[f]}setHandlerFallback(f){this._handlerFb=f}reset(){if(this._active.length)for(let f=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;f>=0;--f)this._active[f].unhook(!1);this._stack.paused=!1,this._active=_,this._ident=0}hook(f,i){if(this.reset(),this._ident=f,this._active=this._handlers[f]||_,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].hook(i);else this._handlerFb(this._ident,"HOOK",i)}put(f,i,e){if(this._active.length)for(let r=this._active.length-1;r>=0;r--)this._active[r].put(f,i,e);else this._handlerFb(this._ident,"PUT",(0,h.utf32ToString)(f,i,e))}unhook(f,i=!0){if(this._active.length){let e=!1,r=this._active.length-1,o=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,e=i,o=this._stack.fallThrough,this._stack.paused=!1),!o&&e===!1){for(;r>=0&&(e=this._active[r].unhook(f),e!==!0);r--)if(e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,e;r--}for(;r>=0;r--)if(e=this._active[r].unhook(!1),e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,e}else this._handlerFb(this._ident,"UNHOOK",f);this._active=_,this._ident=0}};let p=new u.Params;p.addParam(0),t.DcsHandler=class{constructor(f){this._handler=f,this._data="",this._params=p,this._hitLimit=!1}hook(f){this._params=f.length>1||f.params[0]?f.clone():p,this._data="",this._hitLimit=!1}put(f,i,e){this._hitLimit||(this._data+=(0,h.utf32ToString)(f,i,e),this._data.length>n.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(f){let i=!1;if(this._hitLimit)i=!1;else if(f&&(i=this._handler(this._data,this._params),i instanceof Promise))return i.then(e=>(this._params=p,this._data="",this._hitLimit=!1,e));return this._params=p,this._data="",this._hitLimit=!1,i}}},2015:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;let h=a(844),u=a(8742),n=a(6242),_=a(6351);class p{constructor(r){this.table=new Uint8Array(r)}setDefault(r,o){this.table.fill(r<<4|o)}add(r,o,s,d){this.table[o<<8|r]=s<<4|d}addMany(r,o,s,d){for(let g=0;g<r.length;g++)this.table[o<<8|r[g]]=s<<4|d}}t.TransitionTable=p;let f=160;t.VT500_TRANSITION_TABLE=function(){let e=new p(4095),r=Array.apply(null,Array(256)).map((m,c)=>c),o=(m,c)=>r.slice(m,c),s=o(32,127),d=o(0,24);d.push(25),d.push.apply(d,o(28,32));let g=o(0,14),v;for(v in e.setDefault(1,0),e.addMany(s,0,2,0),g)e.addMany([24,26,153,154],v,3,0),e.addMany(o(128,144),v,3,0),e.addMany(o(144,152),v,3,0),e.add(156,v,0,0),e.add(27,v,11,1),e.add(157,v,4,8),e.addMany([152,158,159],v,0,7),e.add(155,v,11,3),e.add(144,v,11,9);return e.addMany(d,0,3,0),e.addMany(d,1,3,1),e.add(127,1,0,1),e.addMany(d,8,0,8),e.addMany(d,3,3,3),e.add(127,3,0,3),e.addMany(d,4,3,4),e.add(127,4,0,4),e.addMany(d,6,3,6),e.addMany(d,5,3,5),e.add(127,5,0,5),e.addMany(d,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(s,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(o(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(s,7,0,7),e.addMany(d,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(o(64,127),3,7,0),e.addMany(o(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(o(48,60),4,8,4),e.addMany(o(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(o(32,64),6,0,6),e.add(127,6,0,6),e.addMany(o(64,127),6,0,0),e.addMany(o(32,48),3,9,5),e.addMany(o(32,48),5,9,5),e.addMany(o(48,64),5,0,6),e.addMany(o(64,127),5,7,0),e.addMany(o(32,48),4,9,5),e.addMany(o(32,48),1,9,2),e.addMany(o(32,48),2,9,2),e.addMany(o(48,127),2,10,0),e.addMany(o(48,80),1,10,0),e.addMany(o(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(o(96,127),1,10,0),e.add(80,1,11,9),e.addMany(d,9,0,9),e.add(127,9,0,9),e.addMany(o(28,32),9,0,9),e.addMany(o(32,48),9,9,12),e.addMany(o(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(d,11,0,11),e.addMany(o(32,128),11,0,11),e.addMany(o(28,32),11,0,11),e.addMany(d,10,0,10),e.add(127,10,0,10),e.addMany(o(28,32),10,0,10),e.addMany(o(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(o(32,48),10,9,12),e.addMany(d,12,0,12),e.add(127,12,0,12),e.addMany(o(28,32),12,0,12),e.addMany(o(32,48),12,9,12),e.addMany(o(48,64),12,0,11),e.addMany(o(64,127),12,12,13),e.addMany(o(64,127),10,12,13),e.addMany(o(64,127),9,12,13),e.addMany(d,13,13,13),e.addMany(s,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(f,0,2,0),e.add(f,8,5,8),e.add(f,6,0,6),e.add(f,11,0,11),e.add(f,13,13,13),e}();class i extends h.Disposable{constructor(r=t.VT500_TRANSITION_TABLE){super(),this._transitions=r,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new u.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(o,s,d)=>{},this._executeHandlerFb=o=>{},this._csiHandlerFb=(o,s)=>{},this._escHandlerFb=o=>{},this._errorHandlerFb=o=>o,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,h.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new n.OscParser),this._dcsParser=this.register(new _.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(r,o=[64,126]){let s=0;if(r.prefix){if(r.prefix.length>1)throw new Error("only one byte as prefix supported");if(s=r.prefix.charCodeAt(0),s&&60>s||s>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(r.intermediates){if(r.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let g=0;g<r.intermediates.length;++g){let v=r.intermediates.charCodeAt(g);if(32>v||v>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");s<<=8,s|=v}}if(r.final.length!==1)throw new Error("final must be a single byte");let d=r.final.charCodeAt(0);if(o[0]>d||d>o[1])throw new Error(`final must be in range ${o[0]} .. ${o[1]}`);return s<<=8,s|=d,s}identToString(r){let o=[];for(;r;)o.push(String.fromCharCode(255&r)),r>>=8;return o.reverse().join("")}setPrintHandler(r){this._printHandler=r}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(r,o){let s=this._identifier(r,[48,126]);this._escHandlers[s]===void 0&&(this._escHandlers[s]=[]);let d=this._escHandlers[s];return d.push(o),{dispose:()=>{let g=d.indexOf(o);g!==-1&&d.splice(g,1)}}}clearEscHandler(r){this._escHandlers[this._identifier(r,[48,126])]&&delete this._escHandlers[this._identifier(r,[48,126])]}setEscHandlerFallback(r){this._escHandlerFb=r}setExecuteHandler(r,o){this._executeHandlers[r.charCodeAt(0)]=o}clearExecuteHandler(r){this._executeHandlers[r.charCodeAt(0)]&&delete this._executeHandlers[r.charCodeAt(0)]}setExecuteHandlerFallback(r){this._executeHandlerFb=r}registerCsiHandler(r,o){let s=this._identifier(r);this._csiHandlers[s]===void 0&&(this._csiHandlers[s]=[]);let d=this._csiHandlers[s];return d.push(o),{dispose:()=>{let g=d.indexOf(o);g!==-1&&d.splice(g,1)}}}clearCsiHandler(r){this._csiHandlers[this._identifier(r)]&&delete this._csiHandlers[this._identifier(r)]}setCsiHandlerFallback(r){this._csiHandlerFb=r}registerDcsHandler(r,o){return this._dcsParser.registerHandler(this._identifier(r),o)}clearDcsHandler(r){this._dcsParser.clearHandler(this._identifier(r))}setDcsHandlerFallback(r){this._dcsParser.setHandlerFallback(r)}registerOscHandler(r,o){return this._oscParser.registerHandler(r,o)}clearOscHandler(r){this._oscParser.clearHandler(r)}setOscHandlerFallback(r){this._oscParser.setHandlerFallback(r)}setErrorHandler(r){this._errorHandler=r}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(r,o,s,d,g){this._parseStack.state=r,this._parseStack.handlers=o,this._parseStack.handlerPos=s,this._parseStack.transition=d,this._parseStack.chunkPos=g}parse(r,o,s){let d,g=0,v=0,m=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,m=this._parseStack.chunkPos+1;else{if(s===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let c=this._parseStack.handlers,l=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(s===!1&&l>-1){for(;l>=0&&(d=c[l](this._params),d!==!0);l--)if(d instanceof Promise)return this._parseStack.handlerPos=l,d}this._parseStack.handlers=[];break;case 4:if(s===!1&&l>-1){for(;l>=0&&(d=c[l](),d!==!0);l--)if(d instanceof Promise)return this._parseStack.handlerPos=l,d}this._parseStack.handlers=[];break;case 6:if(g=r[this._parseStack.chunkPos],d=this._dcsParser.unhook(g!==24&&g!==26,s),d)return d;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(g=r[this._parseStack.chunkPos],d=this._oscParser.end(g!==24&&g!==26,s),d)return d;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,m=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let c=m;c<o;++c){switch(g=r[c],v=this._transitions.table[this.currentState<<8|(g<160?g:f)],v>>4){case 2:for(let y=c+1;;++y){if(y>=o||(g=r[y])<32||g>126&&g<f){this._printHandler(r,c,y),c=y-1;break}if(++y>=o||(g=r[y])<32||g>126&&g<f){this._printHandler(r,c,y),c=y-1;break}if(++y>=o||(g=r[y])<32||g>126&&g<f){this._printHandler(r,c,y),c=y-1;break}if(++y>=o||(g=r[y])<32||g>126&&g<f){this._printHandler(r,c,y),c=y-1;break}}break;case 3:this._executeHandlers[g]?this._executeHandlers[g]():this._executeHandlerFb(g),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:c,code:g,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let l=this._csiHandlers[this._collect<<8|g],S=l?l.length-1:-1;for(;S>=0&&(d=l[S](this._params),d!==!0);S--)if(d instanceof Promise)return this._preserveStack(3,l,S,v,c),d;S<0&&this._csiHandlerFb(this._collect<<8|g,this._params),this.precedingCodepoint=0;break;case 8:do switch(g){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(g-48)}while(++c<o&&(g=r[c])>47&&g<60);c--;break;case 9:this._collect<<=8,this._collect|=g;break;case 10:let b=this._escHandlers[this._collect<<8|g],w=b?b.length-1:-1;for(;w>=0&&(d=b[w](),d!==!0);w--)if(d instanceof Promise)return this._preserveStack(4,b,w,v,c),d;w<0&&this._escHandlerFb(this._collect<<8|g),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|g,this._params);break;case 13:for(let y=c+1;;++y)if(y>=o||(g=r[y])===24||g===26||g===27||g>127&&g<f){this._dcsParser.put(r,c,y),c=y-1;break}break;case 14:if(d=this._dcsParser.unhook(g!==24&&g!==26),d)return this._preserveStack(6,[],0,v,c),d;g===27&&(v|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let y=c+1;;y++)if(y>=o||(g=r[y])<32||g>127&&g<f){this._oscParser.put(r,c,y),c=y-1;break}break;case 6:if(d=this._oscParser.end(g!==24&&g!==26),d)return this._preserveStack(5,[],0,v,c),d;g===27&&(v|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&v}}}t.EscapeSequenceParser=i},6242:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;let h=a(5770),u=a(482),n=[];t.OscParser=class{constructor(){this._state=0,this._active=n,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(_,p){this._handlers[_]===void 0&&(this._handlers[_]=[]);let f=this._handlers[_];return f.push(p),{dispose:()=>{let i=f.indexOf(p);i!==-1&&f.splice(i,1)}}}clearHandler(_){this._handlers[_]&&delete this._handlers[_]}setHandlerFallback(_){this._handlerFb=_}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=n}reset(){if(this._state===2)for(let _=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;_>=0;--_)this._active[_].end(!1);this._stack.paused=!1,this._active=n,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||n,this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].start();else this._handlerFb(this._id,"START")}_put(_,p,f){if(this._active.length)for(let i=this._active.length-1;i>=0;i--)this._active[i].put(_,p,f);else this._handlerFb(this._id,"PUT",(0,u.utf32ToString)(_,p,f))}start(){this.reset(),this._state=1}put(_,p,f){if(this._state!==3){if(this._state===1)for(;p<f;){let i=_[p++];if(i===59){this._state=2,this._start();break}if(i<48||57<i)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+i-48}this._state===2&&f-p>0&&this._put(_,p,f)}}end(_,p=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let f=!1,i=this._active.length-1,e=!1;if(this._stack.paused&&(i=this._stack.loopPosition-1,f=p,e=this._stack.fallThrough,this._stack.paused=!1),!e&&f===!1){for(;i>=0&&(f=this._active[i].end(_),f!==!0);i--)if(f instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!1,f;i--}for(;i>=0;i--)if(f=this._active[i].end(!1),f instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!0,f}else this._handlerFb(this._id,"END",_);this._active=n,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(_){this._handler=_,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(_,p,f){this._hitLimit||(this._data+=(0,u.utf32ToString)(_,p,f),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(_){let p=!1;if(this._hitLimit)p=!1;else if(_&&(p=this._handler(this._data),p instanceof Promise))return p.then(f=>(this._data="",this._hitLimit=!1,f));return this._data="",this._hitLimit=!1,p}}},8742:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;let a=2147483647;class h{constructor(n=32,_=32){if(this.maxLength=n,this.maxSubParamsLength=_,_>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(n),this.length=0,this._subParams=new Int32Array(_),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(n),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(n){let _=new h;if(!n.length)return _;for(let p=Array.isArray(n[0])?1:0;p<n.length;++p){let f=n[p];if(Array.isArray(f))for(let i=0;i<f.length;++i)_.addSubParam(f[i]);else _.addParam(f)}return _}clone(){let n=new h(this.maxLength,this.maxSubParamsLength);return n.params.set(this.params),n.length=this.length,n._subParams.set(this._subParams),n._subParamsLength=this._subParamsLength,n._subParamsIdx.set(this._subParamsIdx),n._rejectDigits=this._rejectDigits,n._rejectSubDigits=this._rejectSubDigits,n._digitIsSub=this._digitIsSub,n}toArray(){let n=[];for(let _=0;_<this.length;++_){n.push(this.params[_]);let p=this._subParamsIdx[_]>>8,f=255&this._subParamsIdx[_];f-p>0&&n.push(Array.prototype.slice.call(this._subParams,p,f))}return n}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(n){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(n<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=n>a?a:n}}addSubParam(n){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(n<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=n>a?a:n,this._subParamsIdx[this.length-1]++}}hasSubParams(n){return(255&this._subParamsIdx[n])-(this._subParamsIdx[n]>>8)>0}getSubParams(n){let _=this._subParamsIdx[n]>>8,p=255&this._subParamsIdx[n];return p-_>0?this._subParams.subarray(_,p):null}getSubParamsAll(){let n={};for(let _=0;_<this.length;++_){let p=this._subParamsIdx[_]>>8,f=255&this._subParamsIdx[_];f-p>0&&(n[_]=this._subParams.slice(p,f))}return n}addDigit(n){let _;if(this._rejectDigits||!(_=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let p=this._digitIsSub?this._subParams:this.params,f=p[_-1];p[_-1]=~f?Math.min(10*f+n,a):n}}t.Params=h},5741:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let a=this._addons.length-1;a>=0;a--)this._addons[a].instance.dispose()}loadAddon(a,h){let u={instance:h,dispose:h.dispose,isDisposed:!1};this._addons.push(u),h.dispose=()=>this._wrappedAddonDispose(u),h.activate(a)}_wrappedAddonDispose(a){if(a.isDisposed)return;let h=-1;for(let u=0;u<this._addons.length;u++)if(this._addons[u]===a){h=u;break}if(h===-1)throw new Error("Could not dispose an addon that has not been loaded");a.isDisposed=!0,a.dispose.apply(a.instance),this._addons.splice(h,1)}}},8771:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;let h=a(3785),u=a(511);t.BufferApiView=class{constructor(n,_){this._buffer=n,this.type=_}init(n){return this._buffer=n,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(n){let _=this._buffer.lines.get(n);if(_)return new h.BufferLineApiView(_)}getNullCell(){return new u.CellData}}},3785:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;let h=a(511);t.BufferLineApiView=class{constructor(u){this._line=u}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(u,n){if(!(u<0||u>=this._line.length))return n?(this._line.loadCell(u,n),n):this._line.loadCell(u,new h.CellData)}translateToString(u,n,_){return this._line.translateToString(u,n,_)}}},8285:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;let h=a(8771),u=a(8460);t.BufferNamespaceApi=class{constructor(n){this._core=n,this._onBufferChange=new u.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new h.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new h.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(a){this._core=a}registerCsiHandler(a,h){return this._core.registerCsiHandler(a,u=>h(u.toArray()))}addCsiHandler(a,h){return this.registerCsiHandler(a,h)}registerDcsHandler(a,h){return this._core.registerDcsHandler(a,(u,n)=>h(u,n.toArray()))}addDcsHandler(a,h){return this.registerDcsHandler(a,h)}registerEscHandler(a,h){return this._core.registerEscHandler(a,h)}addEscHandler(a,h){return this.registerEscHandler(a,h)}registerOscHandler(a,h){return this._core.registerOscHandler(a,h)}addOscHandler(a,h){return this.registerOscHandler(a,h)}}},7090:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(a){this._core=a}register(a){this._core.unicodeService.register(a)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(a){this._core.unicodeService.activeVersion=a}}},744:function(k,t,a){var h=this&&this.__decorate||function(e,r,o,s){var d,g=arguments.length,v=g<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,o):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(e,r,o,s);else for(var m=e.length-1;m>=0;m--)(d=e[m])&&(v=(g<3?d(v):g>3?d(r,o,v):d(r,o))||v);return g>3&&v&&Object.defineProperty(r,o,v),v},u=this&&this.__param||function(e,r){return function(o,s){r(o,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;let n=a(2585),_=a(5295),p=a(8460),f=a(844);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let i=class extends f.Disposable{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this.register(new p.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new p.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new _.BufferSet(e,this))}get buffer(){return this.buffers.active}resize(e,r){this.cols=e,this.rows=r,this.buffers.resize(e,r),this._onResize.fire({cols:e,rows:r})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,r=!1){let o=this.buffer,s;s=this._cachedBlankLine,s&&s.length===this.cols&&s.getFg(0)===e.fg&&s.getBg(0)===e.bg||(s=o.getBlankLine(e,r),this._cachedBlankLine=s),s.isWrapped=r;let d=o.ybase+o.scrollTop,g=o.ybase+o.scrollBottom;if(o.scrollTop===0){let v=o.lines.isFull;g===o.lines.length-1?v?o.lines.recycle().copyFrom(s):o.lines.push(s.clone()):o.lines.splice(g+1,0,s.clone()),v?this.isUserScrolling&&(o.ydisp=Math.max(o.ydisp-1,0)):(o.ybase++,this.isUserScrolling||o.ydisp++)}else{let v=g-d+1;o.lines.shiftElements(d+1,v-1,-1),o.lines.set(g,s.clone())}this.isUserScrolling||(o.ydisp=o.ybase),this._onScroll.fire(o.ydisp)}scrollLines(e,r,o){let s=this.buffer;if(e<0){if(s.ydisp===0)return;this.isUserScrolling=!0}else e+s.ydisp>=s.ybase&&(this.isUserScrolling=!1);let d=s.ydisp;s.ydisp=Math.max(Math.min(s.ydisp+e,s.ybase),0),d!==s.ydisp&&(r||this._onScroll.fire(s.ydisp))}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(e){let r=e-this.buffer.ydisp;r!==0&&this.scrollLines(r)}};i=h([u(0,n.IOptionsService)],i),t.BufferService=i},7994:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(a){this.glevel=a,this.charset=this._charsets[a]}setgCharset(a,h){this._charsets[a]=h,this.glevel===a&&(this.charset=h)}}},1753:function(k,t,a){var h=this&&this.__decorate||function(s,d,g,v){var m,c=arguments.length,l=c<3?d:v===null?v=Object.getOwnPropertyDescriptor(d,g):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(s,d,g,v);else for(var S=s.length-1;S>=0;S--)(m=s[S])&&(l=(c<3?m(l):c>3?m(d,g,l):m(d,g))||l);return c>3&&l&&Object.defineProperty(d,g,l),l},u=this&&this.__param||function(s,d){return function(g,v){d(g,v,s)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;let n=a(2585),_=a(8460),p=a(844),f={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:s=>s.button!==4&&s.action===1&&(s.ctrl=!1,s.alt=!1,s.shift=!1,!0)},VT200:{events:19,restrict:s=>s.action!==32},DRAG:{events:23,restrict:s=>s.action!==32||s.button!==3},ANY:{events:31,restrict:s=>!0}};function i(s,d){let g=(s.ctrl?16:0)|(s.shift?4:0)|(s.alt?8:0);return s.button===4?(g|=64,g|=s.action):(g|=3&s.button,4&s.button&&(g|=64),8&s.button&&(g|=128),s.action===32?g|=32:s.action!==0||d||(g|=3)),g}let e=String.fromCharCode,r={DEFAULT:s=>{let d=[i(s,!1)+32,s.col+32,s.row+32];return d[0]>255||d[1]>255||d[2]>255?"":`\x1B[M${e(d[0])}${e(d[1])}${e(d[2])}`},SGR:s=>{let d=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${i(s,!0)};${s.col};${s.row}${d}`},SGR_PIXELS:s=>{let d=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${i(s,!0)};${s.x};${s.y}${d}`}},o=class extends p.Disposable{constructor(s,d){super(),this._bufferService=s,this._coreService=d,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new _.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(let g of Object.keys(f))this.addProtocol(g,f[g]);for(let g of Object.keys(r))this.addEncoding(g,r[g]);this.reset()}addProtocol(s,d){this._protocols[s]=d}addEncoding(s,d){this._encodings[s]=d}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(s){if(!this._protocols[s])throw new Error(`unknown protocol "${s}"`);this._activeProtocol=s,this._onProtocolChange.fire(this._protocols[s].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(s){if(!this._encodings[s])throw new Error(`unknown encoding "${s}"`);this._activeEncoding=s}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(s){if(s.col<0||s.col>=this._bufferService.cols||s.row<0||s.row>=this._bufferService.rows||s.button===4&&s.action===32||s.button===3&&s.action!==32||s.button!==4&&(s.action===2||s.action===3)||(s.col++,s.row++,s.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,s,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(s))return!1;let d=this._encodings[this._activeEncoding](s);return d&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(d):this._coreService.triggerDataEvent(d,!0)),this._lastEvent=s,!0}explainEvents(s){return{down:!!(1&s),up:!!(2&s),drag:!!(4&s),move:!!(8&s),wheel:!!(16&s)}}_equalEvents(s,d,g){if(g){if(s.x!==d.x||s.y!==d.y)return!1}else if(s.col!==d.col||s.row!==d.row)return!1;return s.button===d.button&&s.action===d.action&&s.ctrl===d.ctrl&&s.alt===d.alt&&s.shift===d.shift}};o=h([u(0,n.IBufferService),u(1,n.ICoreService)],o),t.CoreMouseService=o},6975:function(k,t,a){var h=this&&this.__decorate||function(o,s,d,g){var v,m=arguments.length,c=m<3?s:g===null?g=Object.getOwnPropertyDescriptor(s,d):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,d,g);else for(var l=o.length-1;l>=0;l--)(v=o[l])&&(c=(m<3?v(c):m>3?v(s,d,c):v(s,d))||c);return m>3&&c&&Object.defineProperty(s,d,c),c},u=this&&this.__param||function(o,s){return function(d,g){s(d,g,o)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;let n=a(2585),_=a(8460),p=a(1439),f=a(844),i=Object.freeze({insertMode:!1}),e=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),r=class extends f.Disposable{constructor(o,s,d){super(),this._bufferService=o,this._logService=s,this._optionsService=d,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new _.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new _.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new _.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new _.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,p.clone)(i),this.decPrivateModes=(0,p.clone)(e)}reset(){this.modes=(0,p.clone)(i),this.decPrivateModes=(0,p.clone)(e)}triggerDataEvent(o,s=!1){if(this._optionsService.rawOptions.disableStdin)return;let d=this._bufferService.buffer;s&&this._optionsService.rawOptions.scrollOnUserInput&&d.ybase!==d.ydisp&&this._onRequestScrollToBottom.fire(),s&&this._onUserInput.fire(),this._logService.debug(`sending data "${o}"`,()=>o.split("").map(g=>g.charCodeAt(0))),this._onData.fire(o)}triggerBinaryEvent(o){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${o}"`,()=>o.split("").map(s=>s.charCodeAt(0))),this._onBinary.fire(o))}};r=h([u(0,n.IBufferService),u(1,n.ILogService),u(2,n.IOptionsService)],r),t.CoreService=r},9074:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;let h=a(8055),u=a(8460),n=a(844),_=a(6106),p=0,f=0;class i extends n.Disposable{constructor(){super(),this._decorations=new _.SortedList(o=>o?.marker.line),this._onDecorationRegistered=this.register(new u.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new u.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,n.toDisposable)(()=>{for(let o of this._decorations.values())this._onDecorationRemoved.fire(o);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(o){if(o.marker.isDisposed)return;let s=new e(o);if(s){let d=s.marker.onDispose(()=>s.dispose());s.onDispose(()=>{s&&(this._decorations.delete(s)&&this._onDecorationRemoved.fire(s),d.dispose())}),this._decorations.insert(s),this._onDecorationRegistered.fire(s)}return s}reset(){for(let o of this._decorations.values())o.dispose();this._decorations.clear()}*getDecorationsAtCell(o,s,d){var g,v,m;let c=0,l=0;for(let S of this._decorations.getKeyIterator(s))c=(g=S.options.x)!==null&&g!==void 0?g:0,l=c+((v=S.options.width)!==null&&v!==void 0?v:1),o>=c&&o<l&&(!d||((m=S.options.layer)!==null&&m!==void 0?m:"bottom")===d)&&(yield S)}forEachDecorationAtCell(o,s,d,g){this._decorations.forEachByKey(s,v=>{var m,c,l;p=(m=v.options.x)!==null&&m!==void 0?m:0,f=p+((c=v.options.width)!==null&&c!==void 0?c:1),o>=p&&o<f&&(!d||((l=v.options.layer)!==null&&l!==void 0?l:"bottom")===d)&&g(v)})}dispose(){for(let o of this._decorations.values())this._onDecorationRemoved.fire(o);this.reset()}}t.DecorationService=i;class e extends n.Disposable{constructor(o){super(),this.options=o,this.onRenderEmitter=this.register(new u.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=o.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=h.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=h.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;let h=a(2585),u=a(8343);class n{constructor(...p){this._entries=new Map;for(let[f,i]of p)this.set(f,i)}set(p,f){let i=this._entries.get(p);return this._entries.set(p,f),i}forEach(p){for(let[f,i]of this._entries.entries())p(f,i)}has(p){return this._entries.has(p)}get(p){return this._entries.get(p)}}t.ServiceCollection=n,t.InstantiationService=class{constructor(){this._services=new n,this._services.set(h.IInstantiationService,this)}setService(_,p){this._services.set(_,p)}getService(_){return this._services.get(_)}createInstance(_,...p){let f=(0,u.getServiceDependencies)(_).sort((r,o)=>r.index-o.index),i=[];for(let r of f){let o=this._services.get(r.id);if(!o)throw new Error(`[createInstance] ${_.name} depends on UNKNOWN service ${r.id}.`);i.push(o)}let e=f.length>0?f[0].index:p.length;if(p.length!==e)throw new Error(`[createInstance] First service dependency of ${_.name} at position ${e+1} conflicts with ${p.length} static arguments`);return new _(...p,...i)}}},7866:function(k,t,a){var h=this&&this.__decorate||function(i,e,r,o){var s,d=arguments.length,g=d<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,r):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(i,e,r,o);else for(var v=i.length-1;v>=0;v--)(s=i[v])&&(g=(d<3?s(g):d>3?s(e,r,g):s(e,r))||g);return d>3&&g&&Object.defineProperty(e,r,g),g},u=this&&this.__param||function(i,e){return function(r,o){e(r,o,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LogService=void 0;let n=a(844),_=a(2585),p={debug:_.LogLevelEnum.DEBUG,info:_.LogLevelEnum.INFO,warn:_.LogLevelEnum.WARN,error:_.LogLevelEnum.ERROR,off:_.LogLevelEnum.OFF},f=class extends n.Disposable{constructor(i){super(),this._optionsService=i,this.logLevel=_.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=p[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(i){for(let e=0;e<i.length;e++)typeof i[e]=="function"&&(i[e]=i[e]())}_log(i,e,r){this._evalLazyOptionalParams(r),i.call(console,"xterm.js: "+e,...r)}debug(i,...e){this.logLevel<=_.LogLevelEnum.DEBUG&&this._log(console.log,i,e)}info(i,...e){this.logLevel<=_.LogLevelEnum.INFO&&this._log(console.info,i,e)}warn(i,...e){this.logLevel<=_.LogLevelEnum.WARN&&this._log(console.warn,i,e)}error(i,...e){this.logLevel<=_.LogLevelEnum.ERROR&&this._log(console.error,i,e)}};f=h([u(0,_.IOptionsService)],f),t.LogService=f},7302:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;let h=a(8460),u=a(6114),n=a(844);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:u.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};let _=["normal","bold","100","200","300","400","500","600","700","800","900"];class p extends n.Disposable{constructor(i){super(),this._onOptionChange=this.register(new h.EventEmitter),this.onOptionChange=this._onOptionChange.event;let e=Object.assign({},t.DEFAULT_OPTIONS);for(let r in i)if(r in e)try{let o=i[r];e[r]=this._sanitizeAndValidateOption(r,o)}catch(o){console.error(o)}this.rawOptions=e,this.options=Object.assign({},e),this._setupOptions()}onSpecificOptionChange(i,e){return this.onOptionChange(r=>{r===i&&e(this.rawOptions[i])})}onMultipleOptionChange(i,e){return this.onOptionChange(r=>{i.indexOf(r)!==-1&&e()})}_setupOptions(){let i=r=>{if(!(r in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${r}"`);return this.rawOptions[r]},e=(r,o)=>{if(!(r in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${r}"`);o=this._sanitizeAndValidateOption(r,o),this.rawOptions[r]!==o&&(this.rawOptions[r]=o,this._onOptionChange.fire(r))};for(let r in this.rawOptions){let o={get:i.bind(this,r),set:e.bind(this,r)};Object.defineProperty(this.options,r,o)}}_sanitizeAndValidateOption(i,e){switch(i){case"cursorStyle":if(e||(e=t.DEFAULT_OPTIONS[i]),!function(r){return r==="block"||r==="underline"||r==="bar"}(e))throw new Error(`"${e}" is not a valid value for ${i}`);break;case"wordSeparator":e||(e=t.DEFAULT_OPTIONS[i]);break;case"fontWeight":case"fontWeightBold":if(typeof e=="number"&&1<=e&&e<=1e3)break;e=_.includes(e)?e:t.DEFAULT_OPTIONS[i];break;case"cursorWidth":e=Math.floor(e);case"lineHeight":case"tabStopWidth":if(e<1)throw new Error(`${i} cannot be less than 1, value: ${e}`);break;case"minimumContrastRatio":e=Math.max(1,Math.min(21,Math.round(10*e)/10));break;case"scrollback":if((e=Math.min(e,4294967295))<0)throw new Error(`${i} cannot be less than 0, value: ${e}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(e<=0)throw new Error(`${i} cannot be less than or equal to 0, value: ${e}`);break;case"rows":case"cols":if(!e&&e!==0)throw new Error(`${i} must be numeric, value: ${e}`);break;case"windowsPty":e=e??{}}return e}}t.OptionsService=p},2660:function(k,t,a){var h=this&&this.__decorate||function(p,f,i,e){var r,o=arguments.length,s=o<3?f:e===null?e=Object.getOwnPropertyDescriptor(f,i):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(p,f,i,e);else for(var d=p.length-1;d>=0;d--)(r=p[d])&&(s=(o<3?r(s):o>3?r(f,i,s):r(f,i))||s);return o>3&&s&&Object.defineProperty(f,i,s),s},u=this&&this.__param||function(p,f){return function(i,e){f(i,e,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;let n=a(2585),_=class{constructor(p){this._bufferService=p,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(p){let f=this._bufferService.buffer;if(p.id===void 0){let d=f.addMarker(f.ybase+f.y),g={data:p,id:this._nextId++,lines:[d]};return d.onDispose(()=>this._removeMarkerFromLink(g,d)),this._dataByLinkId.set(g.id,g),g.id}let i=p,e=this._getEntryIdKey(i),r=this._entriesWithId.get(e);if(r)return this.addLineToLink(r.id,f.ybase+f.y),r.id;let o=f.addMarker(f.ybase+f.y),s={id:this._nextId++,key:this._getEntryIdKey(i),data:i,lines:[o]};return o.onDispose(()=>this._removeMarkerFromLink(s,o)),this._entriesWithId.set(s.key,s),this._dataByLinkId.set(s.id,s),s.id}addLineToLink(p,f){let i=this._dataByLinkId.get(p);if(i&&i.lines.every(e=>e.line!==f)){let e=this._bufferService.buffer.addMarker(f);i.lines.push(e),e.onDispose(()=>this._removeMarkerFromLink(i,e))}}getLinkData(p){var f;return(f=this._dataByLinkId.get(p))===null||f===void 0?void 0:f.data}_getEntryIdKey(p){return`${p.id};;${p.uri}`}_removeMarkerFromLink(p,f){let i=p.lines.indexOf(f);i!==-1&&(p.lines.splice(i,1),p.lines.length===0&&(p.data.id!==void 0&&this._entriesWithId.delete(p.key),this._dataByLinkId.delete(p.id)))}};_=h([u(0,n.IBufferService)],_),t.OscLinkService=_},8343:(k,t)=>{function a(h,u,n){u.di$target===u?u.di$dependencies.push({id:h,index:n}):(u.di$dependencies=[{id:h,index:n}],u.di$target=u)}Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0,t.serviceRegistry=new Map,t.getServiceDependencies=function(h){return h.di$dependencies||[]},t.createDecorator=function(h){if(t.serviceRegistry.has(h))return t.serviceRegistry.get(h);let u=function(n,_,p){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");a(u,n,p)};return u.toString=()=>h,t.serviceRegistry.set(h,u),u}},2585:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;let h=a(8343);var u;t.IBufferService=(0,h.createDecorator)("BufferService"),t.ICoreMouseService=(0,h.createDecorator)("CoreMouseService"),t.ICoreService=(0,h.createDecorator)("CoreService"),t.ICharsetService=(0,h.createDecorator)("CharsetService"),t.IInstantiationService=(0,h.createDecorator)("InstantiationService"),(u=t.LogLevelEnum||(t.LogLevelEnum={}))[u.DEBUG=0]="DEBUG",u[u.INFO=1]="INFO",u[u.WARN=2]="WARN",u[u.ERROR=3]="ERROR",u[u.OFF=4]="OFF",t.ILogService=(0,h.createDecorator)("LogService"),t.IOptionsService=(0,h.createDecorator)("OptionsService"),t.IOscLinkService=(0,h.createDecorator)("OscLinkService"),t.IUnicodeService=(0,h.createDecorator)("UnicodeService"),t.IDecorationService=(0,h.createDecorator)("DecorationService")},1480:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;let h=a(8460),u=a(225);t.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new h.EventEmitter,this.onChange=this._onChange.event;let n=new u.UnicodeV6;this.register(n),this._active=n.version,this._activeProvider=n}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(n){if(!this._providers[n])throw new Error(`unknown Unicode version "${n}"`);this._active=n,this._activeProvider=this._providers[n],this._onChange.fire(n)}register(n){this._providers[n.version]=n}wcwidth(n){return this._activeProvider.wcwidth(n)}getStringCellWidth(n){let _=0,p=n.length;for(let f=0;f<p;++f){let i=n.charCodeAt(f);if(55296<=i&&i<=56319){if(++f>=p)return _+this.wcwidth(i);let e=n.charCodeAt(f);56320<=e&&e<=57343?i=1024*(i-55296)+e-56320+65536:_+=this.wcwidth(e)}_+=this.wcwidth(i)}return _}}}},M={};function P(k){var t=M[k];if(t!==void 0)return t.exports;var a=M[k]={exports:{}};return q[k].call(a.exports,a,a.exports,P),a.exports}var W={};return(()=>{var k=W;Object.defineProperty(k,"__esModule",{value:!0}),k.Terminal=void 0;let t=P(3236),a=P(9042),h=P(7975),u=P(7090),n=P(5741),_=P(8285),p=["cols","rows"];k.Terminal=class{constructor(f){this._core=new t.Terminal(f),this._addonManager=new n.AddonManager,this._publicOptions=Object.assign({},this._core.options);let i=r=>this._core.options[r],e=(r,o)=>{this._checkReadonlyOptions(r),this._core.options[r]=o};for(let r in this._core.options){let o={get:i.bind(this,r),set:e.bind(this,r)};Object.defineProperty(this._publicOptions,r,o)}}_checkReadonlyOptions(f){if(p.includes(f))throw new Error(`Option "${f}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new u.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new _.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let f=this._core.coreService.decPrivateModes,i="none";switch(this._core.coreMouseService.activeProtocol){case"X10":i="x10";break;case"VT200":i="vt200";break;case"DRAG":i="drag";break;case"ANY":i="any"}return{applicationCursorKeysMode:f.applicationCursorKeys,applicationKeypadMode:f.applicationKeypad,bracketedPasteMode:f.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:i,originMode:f.origin,reverseWraparoundMode:f.reverseWraparound,sendFocusMode:f.sendFocus,wraparoundMode:f.wraparound}}get options(){return this._publicOptions}set options(f){for(let i in f)this._publicOptions[i]=f[i]}blur(){this._core.blur()}focus(){this._core.focus()}resize(f,i){this._verifyIntegers(f,i),this._core.resize(f,i)}open(f){this._core.open(f)}attachCustomKeyEventHandler(f){this._core.attachCustomKeyEventHandler(f)}registerLinkProvider(f){return this._core.registerLinkProvider(f)}registerCharacterJoiner(f){return this._checkProposedApi(),this._core.registerCharacterJoiner(f)}deregisterCharacterJoiner(f){this._checkProposedApi(),this._core.deregisterCharacterJoiner(f)}registerMarker(f=0){return this._verifyIntegers(f),this._core.addMarker(f)}registerDecoration(f){var i,e,r;return this._checkProposedApi(),this._verifyPositiveIntegers((i=f.x)!==null&&i!==void 0?i:0,(e=f.width)!==null&&e!==void 0?e:0,(r=f.height)!==null&&r!==void 0?r:0),this._core.registerDecoration(f)}hasSelection(){return this._core.hasSelection()}select(f,i,e){this._verifyIntegers(f,i,e),this._core.select(f,i,e)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(f,i){this._verifyIntegers(f,i),this._core.selectLines(f,i)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(f){this._verifyIntegers(f),this._core.scrollLines(f)}scrollPages(f){this._verifyIntegers(f),this._core.scrollPages(f)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(f){this._verifyIntegers(f),this._core.scrollToLine(f)}clear(){this._core.clear()}write(f,i){this._core.write(f,i)}writeln(f,i){this._core.write(f),this._core.write(`\r
`,i)}paste(f){this._core.paste(f)}refresh(f,i){this._verifyIntegers(f,i),this._core.refresh(f,i)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(f){return this._addonManager.loadAddon(this,f)}static get strings(){return a}_verifyIntegers(...f){for(let i of f)if(i===1/0||isNaN(i)||i%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...f){for(let i of f)if(i&&(i===1/0||isNaN(i)||i%1!=0||i<0))throw new Error("This API only accepts positive integers")}}})(),W})())});var Ie=ce((Ce,Ee)=>{(function(q,M){typeof Ce=="object"&&typeof Ee=="object"?Ee.exports=M():typeof define=="function"&&define.amd?define([],M):typeof Ce=="object"?Ce.FitAddon=M():q.FitAddon=M()})(self,function(){return(()=>{"use strict";var q={};return(()=>{var M=q;Object.defineProperty(M,"__esModule",{value:!0}),M.FitAddon=void 0,M.FitAddon=class{constructor(){}activate(P){this._terminal=P}dispose(){}fit(){let P=this.proposeDimensions();if(!P||!this._terminal||isNaN(P.cols)||isNaN(P.rows))return;let W=this._terminal._core;this._terminal.rows===P.rows&&this._terminal.cols===P.cols||(W._renderService.clear(),this._terminal.resize(P.cols,P.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let P=this._terminal._core,W=P._renderService.dimensions;if(W.css.cell.width===0||W.css.cell.height===0)return;let k=this._terminal.options.scrollback===0?0:P.viewport.scrollBarWidth,t=window.getComputedStyle(this._terminal.element.parentElement),a=parseInt(t.getPropertyValue("height")),h=Math.max(0,parseInt(t.getPropertyValue("width"))),u=window.getComputedStyle(this._terminal.element),n=a-(parseInt(u.getPropertyValue("padding-top"))+parseInt(u.getPropertyValue("padding-bottom"))),_=h-(parseInt(u.getPropertyValue("padding-right"))+parseInt(u.getPropertyValue("padding-left")))-k;return{cols:Math.max(2,Math.floor(_/W.css.cell.width)),rows:Math.max(1,Math.floor(n/W.css.cell.height))}}}})(),q})()})});var Pe=ce((Se,xe)=>{(function(q,M){typeof Se=="object"&&typeof xe=="object"?xe.exports=M():typeof define=="function"&&define.amd?define([],M):typeof Se=="object"?Se.WebglAddon=M():q.WebglAddon=M()})(self,function(){return(()=>{"use strict";var q={965:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphRenderer=void 0;let h=a(381),u=a(855),n=a(859),_=a(374),p=a(509),f=11,i=f*Float32Array.BYTES_PER_ELEMENT,e,r=0,o=0,s=0;class d extends n.Disposable{constructor(v,m,c){super(),this._terminal=v,this._gl=m,this._dimensions=c,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};let l=this._gl;p.TextureAtlas.maxAtlasPages===void 0&&(p.TextureAtlas.maxAtlasPages=Math.min(32,(0,_.throwIfFalsy)(l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS))),p.TextureAtlas.maxTextureSize=(0,_.throwIfFalsy)(l.getParameter(l.MAX_TEXTURE_SIZE))),this._program=(0,_.throwIfFalsy)((0,h.createProgram)(l,`#version 300 es
layout (location = 0) in vec2 a_unitquad;
layout (location = 1) in vec2 a_cellpos;
layout (location = 2) in vec2 a_offset;
layout (location = 3) in vec2 a_size;
layout (location = 4) in float a_texpage;
layout (location = 5) in vec2 a_texcoord;
layout (location = 6) in vec2 a_texsize;

uniform mat4 u_projection;
uniform vec2 u_resolution;

out vec2 v_texcoord;
flat out int v_texpage;

void main() {
  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_texpage = int(a_texpage);
  v_texcoord = a_texcoord + a_unitquad * a_texsize;
}`,function(B){let O="";for(let C=1;C<B;C++)O+=` else if (v_texpage == ${C}) { outColor = texture(u_texture[${C}], v_texcoord); }`;return`#version 300 es
precision lowp float;

in vec2 v_texcoord;
flat in int v_texpage;

uniform sampler2D u_texture[${B}];

out vec4 outColor;

void main() {
  if (v_texpage == 0) {
    outColor = texture(u_texture[0], v_texcoord);
  } ${O}
}`}(p.TextureAtlas.maxAtlasPages))),this.register((0,n.toDisposable)(()=>l.deleteProgram(this._program))),this._projectionLocation=(0,_.throwIfFalsy)(l.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,_.throwIfFalsy)(l.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,_.throwIfFalsy)(l.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=l.createVertexArray(),l.bindVertexArray(this._vertexArrayObject);let S=new Float32Array([0,0,1,0,0,1,1,1]),b=l.createBuffer();this.register((0,n.toDisposable)(()=>l.deleteBuffer(b))),l.bindBuffer(l.ARRAY_BUFFER,b),l.bufferData(l.ARRAY_BUFFER,S,l.STATIC_DRAW),l.enableVertexAttribArray(0),l.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);let w=new Uint8Array([0,1,2,3]),y=l.createBuffer();this.register((0,n.toDisposable)(()=>l.deleteBuffer(y))),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,y),l.bufferData(l.ELEMENT_ARRAY_BUFFER,w,l.STATIC_DRAW),this._attributesBuffer=(0,_.throwIfFalsy)(l.createBuffer()),this.register((0,n.toDisposable)(()=>l.deleteBuffer(this._attributesBuffer))),l.bindBuffer(l.ARRAY_BUFFER,this._attributesBuffer),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,2,l.FLOAT,!1,i,0),l.vertexAttribDivisor(2,1),l.enableVertexAttribArray(3),l.vertexAttribPointer(3,2,l.FLOAT,!1,i,2*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(3,1),l.enableVertexAttribArray(4),l.vertexAttribPointer(4,1,l.FLOAT,!1,i,4*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(4,1),l.enableVertexAttribArray(5),l.vertexAttribPointer(5,2,l.FLOAT,!1,i,5*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(5,1),l.enableVertexAttribArray(6),l.vertexAttribPointer(6,2,l.FLOAT,!1,i,7*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(6,1),l.enableVertexAttribArray(1),l.vertexAttribPointer(1,2,l.FLOAT,!1,i,9*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(1,1),l.useProgram(this._program);let D=new Int32Array(p.TextureAtlas.maxAtlasPages);for(let B=0;B<p.TextureAtlas.maxAtlasPages;B++)D[B]=B;l.uniform1iv(this._textureLocation,D),l.uniformMatrix4fv(this._projectionLocation,!1,h.PROJECTION_MATRIX),this._atlasTextures=[];for(let B=0;B<p.TextureAtlas.maxAtlasPages;B++){let O=new h.GLTexture((0,_.throwIfFalsy)(l.createTexture()));this.register((0,n.toDisposable)(()=>l.deleteTexture(O.texture))),l.activeTexture(l.TEXTURE0+B),l.bindTexture(l.TEXTURE_2D,O.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),this._atlasTextures[B]=O}l.enable(l.BLEND),l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),this.handleResize()}beginFrame(){return!this._atlas||this._atlas.beginFrame()}updateCell(v,m,c,l,S,b,w,y){this._updateCell(this._vertices.attributes,v,m,c,l,S,b,w,y)}_updateCell(v,m,c,l,S,b,w,y,D){r=(c*this._terminal.cols+m)*f,l!==u.NULL_CELL_CODE&&l!==void 0?this._atlas&&(e=y&&y.length>1?this._atlas.getRasterizedGlyphCombinedChar(y,S,b,w):this._atlas.getRasterizedGlyph(l,S,b,w),o=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),S!==D&&e.offset.x>o?(s=e.offset.x-o,v[r]=-(e.offset.x-s)+this._dimensions.device.char.left,v[r+1]=-e.offset.y+this._dimensions.device.char.top,v[r+2]=(e.size.x-s)/this._dimensions.device.canvas.width,v[r+3]=e.size.y/this._dimensions.device.canvas.height,v[r+4]=e.texturePage,v[r+5]=e.texturePositionClipSpace.x+s/this._atlas.pages[e.texturePage].canvas.width,v[r+6]=e.texturePositionClipSpace.y,v[r+7]=e.sizeClipSpace.x-s/this._atlas.pages[e.texturePage].canvas.width,v[r+8]=e.sizeClipSpace.y):(v[r]=-e.offset.x+this._dimensions.device.char.left,v[r+1]=-e.offset.y+this._dimensions.device.char.top,v[r+2]=e.size.x/this._dimensions.device.canvas.width,v[r+3]=e.size.y/this._dimensions.device.canvas.height,v[r+4]=e.texturePage,v[r+5]=e.texturePositionClipSpace.x,v[r+6]=e.texturePositionClipSpace.y,v[r+7]=e.sizeClipSpace.x,v[r+8]=e.sizeClipSpace.y)):v.fill(0,r,r+f-1-2)}clear(){let v=this._terminal,m=v.cols*v.rows*f;this._vertices.count!==m?this._vertices.attributes=new Float32Array(m):this._vertices.attributes.fill(0);let c=0;for(;c<this._vertices.attributesBuffers.length;c++)this._vertices.count!==m?this._vertices.attributesBuffers[c]=new Float32Array(m):this._vertices.attributesBuffers[c].fill(0);this._vertices.count=m,c=0;for(let l=0;l<v.rows;l++)for(let S=0;S<v.cols;S++)this._vertices.attributes[c+9]=S/v.cols,this._vertices.attributes[c+10]=l/v.rows,c+=f}handleResize(){let v=this._gl;v.viewport(0,0,v.canvas.width,v.canvas.height),v.uniform2f(this._resolutionLocation,v.canvas.width,v.canvas.height),this.clear()}render(v){if(!this._atlas)return;let m=this._gl;m.useProgram(this._program),m.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;let c=this._vertices.attributesBuffers[this._activeBuffer],l=0;for(let S=0;S<v.lineLengths.length;S++){let b=S*this._terminal.cols*f,w=this._vertices.attributes.subarray(b,b+v.lineLengths[S]*f);c.set(w,l),l+=w.length}m.bindBuffer(m.ARRAY_BUFFER,this._attributesBuffer),m.bufferData(m.ARRAY_BUFFER,c.subarray(0,l),m.STREAM_DRAW);for(let S=0;S<this._atlas.pages.length;S++)this._atlas.pages[S].version!==this._atlasTextures[S].version&&this._bindAtlasPageTexture(m,this._atlas,S);m.drawElementsInstanced(m.TRIANGLE_STRIP,4,m.UNSIGNED_BYTE,0,l/f)}setAtlas(v){this._atlas=v;for(let m of this._atlasTextures)m.version=-1}_bindAtlasPageTexture(v,m,c){v.activeTexture(v.TEXTURE0+c),v.bindTexture(v.TEXTURE_2D,this._atlasTextures[c].texture),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,m.pages[c].canvas),v.generateMipmap(v.TEXTURE_2D),this._atlasTextures[c].version=m.pages[c].version}setDimensions(v){this._dimensions=v}}t.GlyphRenderer=d},742:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleRenderer=void 0;let h=a(381),u=a(310),n=a(859),_=a(237),p=a(374),f=8*Float32Array.BYTES_PER_ELEMENT,i=0,e=!1,r=0,o=0,s=0,d=0,g=0,v=0;class m extends n.Disposable{constructor(l,S,b,w){super(),this._terminal=l,this._gl=S,this._dimensions=b,this._themeService=w,this._vertices={count:0,attributes:new Float32Array(160)};let y=this._gl;this._program=(0,p.throwIfFalsy)((0,h.createProgram)(y,`#version 300 es
layout (location = 0) in vec2 a_position;
layout (location = 1) in vec2 a_size;
layout (location = 2) in vec4 a_color;
layout (location = 3) in vec2 a_unitquad;

uniform mat4 u_projection;

out vec4 v_color;

void main() {
  vec2 zeroToOne = a_position + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_color = a_color;
}`,`#version 300 es
precision lowp float;

in vec4 v_color;

out vec4 outColor;

void main() {
  outColor = v_color;
}`)),this.register((0,n.toDisposable)(()=>y.deleteProgram(this._program))),this._projectionLocation=(0,p.throwIfFalsy)(y.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=y.createVertexArray(),y.bindVertexArray(this._vertexArrayObject);let D=new Float32Array([0,0,1,0,0,1,1,1]),B=y.createBuffer();this.register((0,n.toDisposable)(()=>y.deleteBuffer(B))),y.bindBuffer(y.ARRAY_BUFFER,B),y.bufferData(y.ARRAY_BUFFER,D,y.STATIC_DRAW),y.enableVertexAttribArray(3),y.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);let O=new Uint8Array([0,1,2,3]),C=y.createBuffer();this.register((0,n.toDisposable)(()=>y.deleteBuffer(C))),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,C),y.bufferData(y.ELEMENT_ARRAY_BUFFER,O,y.STATIC_DRAW),this._attributesBuffer=(0,p.throwIfFalsy)(y.createBuffer()),this.register((0,n.toDisposable)(()=>y.deleteBuffer(this._attributesBuffer))),y.bindBuffer(y.ARRAY_BUFFER,this._attributesBuffer),y.enableVertexAttribArray(0),y.vertexAttribPointer(0,2,y.FLOAT,!1,f,0),y.vertexAttribDivisor(0,1),y.enableVertexAttribArray(1),y.vertexAttribPointer(1,2,y.FLOAT,!1,f,2*Float32Array.BYTES_PER_ELEMENT),y.vertexAttribDivisor(1,1),y.enableVertexAttribArray(2),y.vertexAttribPointer(2,4,y.FLOAT,!1,f,4*Float32Array.BYTES_PER_ELEMENT),y.vertexAttribDivisor(2,1),this._updateCachedColors(w.colors),this.register(this._themeService.onChangeColors(L=>{this._updateCachedColors(L),this._updateViewportRectangle()}))}render(){let l=this._gl;l.useProgram(this._program),l.bindVertexArray(this._vertexArrayObject),l.uniformMatrix4fv(this._projectionLocation,!1,h.PROJECTION_MATRIX),l.bindBuffer(l.ARRAY_BUFFER,this._attributesBuffer),l.bufferData(l.ARRAY_BUFFER,this._vertices.attributes,l.DYNAMIC_DRAW),l.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,l.UNSIGNED_BYTE,0,this._vertices.count)}handleResize(){this._updateViewportRectangle()}setDimensions(l){this._dimensions=l}_updateCachedColors(l){this._bgFloat=this._colorToFloat32Array(l.background)}_updateViewportRectangle(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}updateBackgrounds(l){let S=this._terminal,b=this._vertices,w,y,D,B,O,C,L,E,x,I,N,j=1;for(w=0;w<S.rows;w++){for(D=-1,B=0,O=0,C=!1,y=0;y<S.cols;y++)L=(w*S.cols+y)*u.RENDER_MODEL_INDICIES_PER_CELL,E=l.cells[L+u.RENDER_MODEL_BG_OFFSET],x=l.cells[L+u.RENDER_MODEL_FG_OFFSET],I=!!(67108864&x),(E!==B||x!==O&&(C||I))&&((B!==0||C&&O!==0)&&(N=8*j++,this._updateRectangle(b,N,O,B,D,y,w)),D=y,B=E,O=x,C=I);(B!==0||C&&O!==0)&&(N=8*j++,this._updateRectangle(b,N,O,B,D,S.cols,w))}b.count=j}_updateRectangle(l,S,b,w,y,D,B){if(e=!1,67108864&b)switch(50331648&b){case 16777216:case 33554432:i=this._themeService.colors.ansi[255&b].rgba;break;case 50331648:i=(16777215&b)<<8;break;default:i=this._themeService.colors.foreground.rgba}else switch(50331648&w){case 16777216:case 33554432:i=this._themeService.colors.ansi[255&w].rgba;break;case 50331648:i=(16777215&w)<<8;break;default:i=this._themeService.colors.background.rgba,e=!0}l.attributes.length<S+4&&(l.attributes=(0,h.expandFloat32Array)(l.attributes,this._terminal.rows*this._terminal.cols*8)),r=y*this._dimensions.device.cell.width,o=B*this._dimensions.device.cell.height,s=(i>>24&255)/255,d=(i>>16&255)/255,g=(i>>8&255)/255,v=!e&&134217728&w?_.DIM_OPACITY:1,this._addRectangle(l.attributes,S,r,o,(D-y)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,s,d,g,v)}_addRectangle(l,S,b,w,y,D,B,O,C,L){l[S]=b/this._dimensions.device.canvas.width,l[S+1]=w/this._dimensions.device.canvas.height,l[S+2]=y/this._dimensions.device.canvas.width,l[S+3]=D/this._dimensions.device.canvas.height,l[S+4]=B,l[S+5]=O,l[S+6]=C,l[S+7]=L}_addRectangleFloat(l,S,b,w,y,D,B){l[S]=b/this._dimensions.device.canvas.width,l[S+1]=w/this._dimensions.device.canvas.height,l[S+2]=y/this._dimensions.device.canvas.width,l[S+3]=D/this._dimensions.device.canvas.height,l[S+4]=B[0],l[S+5]=B[1],l[S+6]=B[2],l[S+7]=B[3]}_colorToFloat32Array(l){return new Float32Array([(l.rgba>>24&255)/255,(l.rgba>>16&255)/255,(l.rgba>>8&255)/255,(255&l.rgba)/255])}}t.RectangleRenderer=m},310:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderModel=t.COMBINED_CHAR_BIT_MASK=t.RENDER_MODEL_EXT_OFFSET=t.RENDER_MODEL_FG_OFFSET=t.RENDER_MODEL_BG_OFFSET=t.RENDER_MODEL_INDICIES_PER_CELL=void 0;let h=a(296);t.RENDER_MODEL_INDICIES_PER_CELL=4,t.RENDER_MODEL_BG_OFFSET=1,t.RENDER_MODEL_FG_OFFSET=2,t.RENDER_MODEL_EXT_OFFSET=3,t.COMBINED_CHAR_BIT_MASK=2147483648,t.RenderModel=class{constructor(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,h.createSelectionRenderModel)()}resize(u,n){let _=u*n*t.RENDER_MODEL_INDICIES_PER_CELL;_!==this.cells.length&&(this.cells=new Uint32Array(_),this.lineLengths=new Uint32Array(n))}clear(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}},666:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JoinedCellData=t.WebglRenderer=void 0;let h=a(820),u=a(274),n=a(627),_=a(56),p=a(374),f=a(147),i=a(782),e=a(855),r=a(345),o=a(859),s=a(965),d=a(742),g=a(461),v=a(733),m=a(310);class c extends o.Disposable{constructor(b,w,y,D,B,O,C,L,E){super(),this._terminal=b,this._characterJoinerService=w,this._charSizeService=y,this._coreBrowserService=D,this._decorationService=O,this._optionsService=C,this._themeService=L,this._model=new m.RenderModel,this._workCell=new i.CellData,this._onChangeTextureAtlas=this.register(new r.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new r.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new r.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onRequestRedraw=this.register(new r.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onContextLoss=this.register(new r.EventEmitter),this.onContextLoss=this._onContextLoss.event,this.register(this._themeService.onChangeColors(()=>this._handleColorChange())),this._cellColorResolver=new u.CellColorResolver(this._terminal,this._model.selection,this._decorationService,this._coreBrowserService,this._themeService),this._core=this._terminal._core,this._renderLayers=[new v.LinkRenderLayer(this._core.screenElement,2,this._terminal,this._core.linkifier2,this._coreBrowserService,C,this._themeService),new g.CursorRenderLayer(b,this._core.screenElement,3,this._onRequestRedraw,this._coreBrowserService,B,C,this._themeService)],this.dimensions=(0,p.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this.register(C.onOptionChange(()=>this._handleOptionsChanged())),this._canvas=document.createElement("canvas");let x={antialias:!1,depth:!1,preserveDrawingBuffer:E};if(this._gl=this._canvas.getContext("webgl2",x),!this._gl)throw new Error("WebGL2 not supported "+this._gl);this.register((0,h.addDisposableDomListener)(this._canvas,"webglcontextlost",I=>{console.log("webglcontextlost event received"),I.preventDefault(),this._contextRestorationTimeout=setTimeout(()=>{this._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),this._onContextLoss.fire(I)},3e3)})),this.register((0,h.addDisposableDomListener)(this._canvas,"webglcontextrestored",I=>{console.warn("webglcontextrestored event received"),clearTimeout(this._contextRestorationTimeout),this._contextRestorationTimeout=void 0,(0,n.removeTerminalFromCache)(this._terminal),this._initializeWebGLState(),this._requestRedrawViewport()})),this.register((0,_.observeDevicePixelDimensions)(this._canvas,this._coreBrowserService.window,(I,N)=>this._setCanvasDevicePixelDimensions(I,N))),this._core.screenElement.appendChild(this._canvas),[this._rectangleRenderer,this._glyphRenderer]=this._initializeWebGLState(),this._isAttached=this._coreBrowserService.window.document.body.contains(this._core.screenElement),this.register((0,o.toDisposable)(()=>{var I;for(let N of this._renderLayers)N.dispose();(I=this._canvas.parentElement)===null||I===void 0||I.removeChild(this._canvas),(0,n.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){var b;return(b=this._charAtlas)===null||b===void 0?void 0:b.pages[0].canvas}_handleColorChange(){this._refreshCharAtlas(),this._clearModel(!0)}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}handleResize(b,w){this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(let y of this._renderLayers)y.resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width=`${this.dimensions.css.canvas.width}px`,this._canvas.style.height=`${this.dimensions.css.canvas.height}px`,this._core.screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._core.screenElement.style.height=`${this.dimensions.css.canvas.height}px`,this._rectangleRenderer.setDimensions(this.dimensions),this._rectangleRenderer.handleResize(),this._glyphRenderer.setDimensions(this.dimensions),this._glyphRenderer.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}handleCharSizeChanged(){this.handleResize(this._terminal.cols,this._terminal.rows)}handleBlur(){for(let b of this._renderLayers)b.handleBlur(this._terminal);this._requestRedrawViewport()}handleFocus(){for(let b of this._renderLayers)b.handleFocus(this._terminal);this._requestRedrawViewport()}handleSelectionChanged(b,w,y){for(let D of this._renderLayers)D.handleSelectionChanged(this._terminal,b,w,y);this._model.selection.update(this._terminal,b,w,y),this._requestRedrawViewport()}handleCursorMove(){for(let b of this._renderLayers)b.handleCursorMove(this._terminal)}_handleOptionsChanged(){this._updateDimensions(),this._refreshCharAtlas()}_initializeWebGLState(){var b,w;return(b=this._rectangleRenderer)===null||b===void 0||b.dispose(),(w=this._glyphRenderer)===null||w===void 0||w.dispose(),this._rectangleRenderer=this.register(new d.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService)),this._glyphRenderer=this.register(new s.GlyphRenderer(this._terminal,this._gl,this.dimensions)),this.handleCharSizeChanged(),[this._rectangleRenderer,this._glyphRenderer]}_refreshCharAtlas(){var b;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);let w=(0,n.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==w&&((b=this._charAtlasDisposable)===null||b===void 0||b.dispose(),this._onChangeTextureAtlas.fire(w.pages[0].canvas),this._charAtlasDisposable=(0,o.getDisposeArrayDisposable)([(0,r.forwardEvent)(w.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,r.forwardEvent)(w.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=w,this._charAtlas.warmUp(),this._glyphRenderer.setAtlas(this._charAtlas)}_clearModel(b){this._model.clear(),b&&this._glyphRenderer.clear()}clearTextureAtlas(){var b;(b=this._charAtlas)===null||b===void 0||b.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}clear(){this._clearModel(!0);for(let b of this._renderLayers)b.reset(this._terminal)}registerCharacterJoiner(b){return-1}deregisterCharacterJoiner(b){return!1}renderRows(b,w){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(let y of this._renderLayers)y.handleGridChanged(this._terminal,b,w);this._glyphRenderer.beginFrame()&&this._clearModel(!0),this._updateModel(b,w),this._rectangleRenderer.render(),this._glyphRenderer.render(this._model)}_updateModel(b,w){let y=this._core,D,B,O,C,L,E,x,I,N,j,H,z,R,A=this._workCell;for(B=b;B<=w&&(O=B+y.buffer.ydisp,C=y.buffer.lines.get(O),C);B++)for(this._model.lineLengths[B]=0,L=this._characterJoinerService.getJoinedCharacters(O),z=0;z<y.cols;z++)if(D=this._cellColorResolver.result.bg,C.loadCell(z,A),z===0&&(D=this._cellColorResolver.result.bg),E=!1,x=z,L.length>0&&z===L[0][0]&&(E=!0,I=L.shift(),A=new l(A,C.translateToString(!0,I[0],I[1]),I[1]-I[0]),x=I[1]-1),N=A.getChars(),j=A.getCode(),H=(B*y.cols+z)*m.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(A,z,O),j!==e.NULL_CELL_CODE&&(this._model.lineLengths[B]=z+1),(this._model.cells[H]!==j||this._model.cells[H+m.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[H+m.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[H+m.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(N.length>1&&(j|=m.COMBINED_CHAR_BIT_MASK),this._model.cells[H]=j,this._model.cells[H+m.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[H+m.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[H+m.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,this._glyphRenderer.updateCell(z,B,j,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,N,D),E))for(A=this._workCell,z++;z<x;z++)R=(B*y.cols+z)*m.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.updateCell(z,B,e.NULL_CELL_CODE,0,0,0,e.NULL_CELL_CHAR,0),this._model.cells[R]=e.NULL_CELL_CODE,this._model.cells[R+m.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[R+m.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[R+m.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;this._rectangleRenderer.updateBackgrounds(this._model)}_updateDimensions(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}_setCanvasDevicePixelDimensions(b,w){this._canvas.width===b&&this._canvas.height===w||(this._canvas.width=b,this._canvas.height=w,this._requestRedrawViewport())}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}}t.WebglRenderer=c;class l extends f.AttributeData{constructor(b,w,y){super(),this.content=0,this.combinedData="",this.fg=b.fg,this.bg=b.bg,this.combinedData=w,this._width=y}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(b){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=l},381:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTexture=t.expandFloat32Array=t.createShader=t.createProgram=t.PROJECTION_MATRIX=void 0;let h=a(374);function u(n,_,p){let f=(0,h.throwIfFalsy)(n.createShader(_));if(n.shaderSource(f,p),n.compileShader(f),n.getShaderParameter(f,n.COMPILE_STATUS))return f;console.error(n.getShaderInfoLog(f)),n.deleteShader(f)}t.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),t.createProgram=function(n,_,p){let f=(0,h.throwIfFalsy)(n.createProgram());if(n.attachShader(f,(0,h.throwIfFalsy)(u(n,n.VERTEX_SHADER,_))),n.attachShader(f,(0,h.throwIfFalsy)(u(n,n.FRAGMENT_SHADER,p))),n.linkProgram(f),n.getProgramParameter(f,n.LINK_STATUS))return f;console.error(n.getProgramInfoLog(f)),n.deleteProgram(f)},t.createShader=u,t.expandFloat32Array=function(n,_){let p=Math.min(2*n.length,_),f=new Float32Array(p);for(let i=0;i<n.length;i++)f[i]=n[i];return f},t.GLTexture=class{constructor(n){this.texture=n,this.version=-1}}},592:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;let h=a(627),u=a(237),n=a(374),_=a(859);class p extends _.Disposable{constructor(i,e,r,o,s,d,g,v){super(),this._container=e,this._alpha=s,this._coreBrowserService=d,this._optionsService=g,this._themeService=v,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${r}-layer`),this._canvas.style.zIndex=o.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this.register(this._themeService.onChangeColors(m=>{this._refreshCharAtlas(i,m),this.reset(i)})),this.register((0,_.toDisposable)(()=>{var m;this._canvas.remove(),(m=this._charAtlas)===null||m===void 0||m.dispose()}))}_initCanvas(){this._ctx=(0,n.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(i){}handleFocus(i){}handleCursorMove(i){}handleGridChanged(i,e,r){}handleSelectionChanged(i,e,r,o=!1){}_setTransparency(i,e){if(e===this._alpha)return;let r=this._canvas;this._alpha=e,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,r),this._refreshCharAtlas(i,this._themeService.colors),this.handleGridChanged(i,0,i.rows-1)}_refreshCharAtlas(i,e){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,h.acquireTextureAtlas)(i,this._optionsService.rawOptions,e,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}resize(i,e){this._deviceCellWidth=e.device.cell.width,this._deviceCellHeight=e.device.cell.height,this._deviceCharWidth=e.device.char.width,this._deviceCharHeight=e.device.char.height,this._deviceCharLeft=e.device.char.left,this._deviceCharTop=e.device.char.top,this._canvas.width=e.device.canvas.width,this._canvas.height=e.device.canvas.height,this._canvas.style.width=`${e.css.canvas.width}px`,this._canvas.style.height=`${e.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(i,this._themeService.colors)}_fillCells(i,e,r,o){this._ctx.fillRect(i*this._deviceCellWidth,e*this._deviceCellHeight,r*this._deviceCellWidth,o*this._deviceCellHeight)}_fillBottomLineAtCells(i,e,r=1){this._ctx.fillRect(i*this._deviceCellWidth,(e+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,r*this._deviceCellWidth,this._coreBrowserService.dpr)}_fillLeftLineAtCell(i,e,r){this._ctx.fillRect(i*this._deviceCellWidth,e*this._deviceCellHeight,this._coreBrowserService.dpr*r,this._deviceCellHeight)}_strokeRectAtCell(i,e,r,o){this._ctx.lineWidth=this._coreBrowserService.dpr,this._ctx.strokeRect(i*this._deviceCellWidth+this._coreBrowserService.dpr/2,e*this._deviceCellHeight+this._coreBrowserService.dpr/2,r*this._deviceCellWidth-this._coreBrowserService.dpr,o*this._deviceCellHeight-this._coreBrowserService.dpr)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(i,e,r,o){this._alpha?this._ctx.clearRect(i*this._deviceCellWidth,e*this._deviceCellHeight,r*this._deviceCellWidth,o*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(i*this._deviceCellWidth,e*this._deviceCellHeight,r*this._deviceCellWidth,o*this._deviceCellHeight))}_fillCharTrueColor(i,e,r,o){this._ctx.font=this._getFont(i,!1,!1),this._ctx.textBaseline=u.TEXT_BASELINE,this._clipCell(r,o,e.getWidth()),this._ctx.fillText(e.getChars(),r*this._deviceCellWidth+this._deviceCharLeft,o*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_clipCell(i,e,r){this._ctx.beginPath(),this._ctx.rect(i*this._deviceCellWidth,e*this._deviceCellHeight,r*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(i,e,r){return`${r?"italic":""} ${e?i.options.fontWeightBold:i.options.fontWeight} ${i.options.fontSize*this._coreBrowserService.dpr}px ${i.options.fontFamily}`}}t.BaseRenderLayer=p},461:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CursorRenderLayer=void 0;let h=a(592),u=a(782),n=a(859);class _ extends h.BaseRenderLayer{constructor(i,e,r,o,s,d,g,v){super(i,e,"cursor",r,!0,s,g,v),this._onRequestRefreshRowsEvent=o,this._coreService=d,this._cell=new u.CellData,this._state={x:0,y:0,isFocused:!1,style:"",width:0},this._cursorRenderers={bar:this._renderBarCursor.bind(this),block:this._renderBlockCursor.bind(this),underline:this._renderUnderlineCursor.bind(this)},this._handleOptionsChanged(i),this.register(g.onOptionChange(()=>this._handleOptionsChanged(i))),this.register((0,n.toDisposable)(()=>{var m;(m=this._cursorBlinkStateManager)===null||m===void 0||m.dispose(),this._cursorBlinkStateManager=void 0}))}resize(i,e){super.resize(i,e),this._state={x:0,y:0,isFocused:!1,style:"",width:0}}reset(i){var e;this._clearCursor(),(e=this._cursorBlinkStateManager)===null||e===void 0||e.restartBlinkAnimation(i),this._handleOptionsChanged(i)}handleBlur(i){var e;(e=this._cursorBlinkStateManager)===null||e===void 0||e.pause(),this._onRequestRefreshRowsEvent.fire({start:i.buffer.active.cursorY,end:i.buffer.active.cursorY})}handleFocus(i){var e;(e=this._cursorBlinkStateManager)===null||e===void 0||e.resume(i),this._onRequestRefreshRowsEvent.fire({start:i.buffer.active.cursorY,end:i.buffer.active.cursorY})}_handleOptionsChanged(i){var e;i.options.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new p(()=>{this._render(i,!0)},this._coreBrowserService)):((e=this._cursorBlinkStateManager)===null||e===void 0||e.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRefreshRowsEvent.fire({start:i.buffer.active.cursorY,end:i.buffer.active.cursorY})}handleCursorMove(i){var e;(e=this._cursorBlinkStateManager)===null||e===void 0||e.restartBlinkAnimation(i)}handleGridChanged(i,e,r){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(i,!1):this._cursorBlinkStateManager.restartBlinkAnimation(i)}_render(i,e){if(!this._coreService.isCursorInitialized||this._coreService.isCursorHidden)return void this._clearCursor();let r=i.buffer.active.baseY+i.buffer.active.cursorY,o=r-i.buffer.active.viewportY,s=Math.min(i.buffer.active.cursorX,i.cols-1);if(o<0||o>=i.rows)this._clearCursor();else if(i._core.buffer.lines.get(r).loadCell(s,this._cell),this._cell.content!==void 0){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css;let d=i.options.cursorStyle;return d&&d!=="block"?this._cursorRenderers[d](i,s,o,this._cell):this._renderBlurCursor(i,s,o,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=o,this._state.isFocused=!1,this._state.style=d,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===s&&this._state.y===o&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===i.options.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[i.options.cursorStyle||"block"](i,s,o,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=o,this._state.isFocused=!1,this._state.style=i.options.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}_clearCursor(){this._state&&(this._coreBrowserService.dpr<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})}_renderBarCursor(i,e,r,o){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillLeftLineAtCell(e,r,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()}_renderBlockCursor(i,e,r,o){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillCells(e,r,o.getWidth(),1),this._ctx.fillStyle=this._themeService.colors.cursorAccent.css,this._fillCharTrueColor(i,o,e,r),this._ctx.restore()}_renderUnderlineCursor(i,e,r,o){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillBottomLineAtCells(e,r),this._ctx.restore()}_renderBlurCursor(i,e,r,o){this._ctx.save(),this._ctx.strokeStyle=this._themeService.colors.cursor.css,this._strokeRectAtCell(e,r,o.getWidth(),1),this._ctx.restore()}}t.CursorRenderLayer=_;class p{constructor(i,e){this._renderCallback=i,this._coreBrowserService=e,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(i){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(i=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){let e=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,e>0)return void this._restartInterval(e)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){let e=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(e)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},i)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(i){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation(i)}}},733:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;let h=a(197),u=a(237),n=a(592);class _ extends n.BaseRenderLayer{constructor(f,i,e,r,o,s,d){super(e,f,"link",i,!0,o,s,d),this.register(r.onShowLinkUnderline(g=>this._handleShowLinkUnderline(g))),this.register(r.onHideLinkUnderline(g=>this._handleHideLinkUnderline(g)))}resize(f,i){super.resize(f,i),this._state=void 0}reset(f){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);let f=this._state.y2-this._state.y1-1;f>0&&this._clearCells(0,this._state.y1+1,this._state.cols,f),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(f){if(f.fg===u.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:f.fg!==void 0&&(0,h.is256Color)(f.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[f.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,f.y1===f.y2)this._fillBottomLineAtCells(f.x1,f.y1,f.x2-f.x1);else{this._fillBottomLineAtCells(f.x1,f.y1,f.cols-f.x1);for(let i=f.y1+1;i<f.y2;i++)this._fillBottomLineAtCells(0,i,f.cols);this._fillBottomLineAtCells(0,f.y2,f.x2)}this._state=f}_handleHideLinkUnderline(f){this._clearCurrentLink()}}t.LinkRenderLayer=_},820:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(a,h,u,n){a.addEventListener(h,u,n);let _=!1;return{dispose:()=>{_||(_=!0,a.removeEventListener(h,u,n))}}}},274:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellColorResolver=void 0;let a,h=0,u=0,n=!1,_=!1,p=!1;t.CellColorResolver=class{constructor(f,i,e,r,o){this._terminal=f,this._selectionRenderModel=i,this._decorationService=e,this._coreBrowserService=r,this._themeService=o,this.result={fg:0,bg:0,ext:0}}resolve(f,i,e){this.result.bg=f.bg,this.result.fg=f.fg,this.result.ext=268435456&f.bg?f.extended.ext:0,u=0,h=0,_=!1,n=!1,p=!1,a=this._themeService.colors,this._decorationService.forEachDecorationAtCell(i,e,"bottom",r=>{r.backgroundColorRGB&&(u=r.backgroundColorRGB.rgba>>8&16777215,_=!0),r.foregroundColorRGB&&(h=r.foregroundColorRGB.rgba>>8&16777215,n=!0)}),p=this._selectionRenderModel.isCellSelected(this._terminal,i,e),p&&(u=(this._coreBrowserService.isFocused?a.selectionBackgroundOpaque:a.selectionInactiveBackgroundOpaque).rgba>>8&16777215,_=!0,a.selectionForeground&&(h=a.selectionForeground.rgba>>8&16777215,n=!0)),this._decorationService.forEachDecorationAtCell(i,e,"top",r=>{r.backgroundColorRGB&&(u=r.backgroundColorRGB.rgba>>8&16777215,_=!0),r.foregroundColorRGB&&(h=r.foregroundColorRGB.rgba>>8&16777215,n=!0)}),_&&(u=p?-16777216&f.bg&-134217729|u|50331648:-16777216&f.bg|u|50331648),n&&(h=-16777216&f.fg&-67108865|h|50331648),67108864&this.result.fg&&(_&&!n&&(h=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&a.background.rgba>>8|50331648,n=!0),!_&&n&&(u=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&a.foreground.rgba>>8|50331648,_=!0)),a=void 0,this.result.bg=_?u:this.result.bg,this.result.fg=n?h:this.result.fg}}},627:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireTextureAtlas=void 0;let h=a(509),u=a(197),n=[];t.acquireTextureAtlas=function(_,p,f,i,e,r,o,s){let d=(0,u.generateConfig)(i,e,r,o,p,f,s);for(let m=0;m<n.length;m++){let c=n[m],l=c.ownedBy.indexOf(_);if(l>=0){if((0,u.configEquals)(c.config,d))return c.atlas;c.ownedBy.length===1?(c.atlas.dispose(),n.splice(m,1)):c.ownedBy.splice(l,1);break}}for(let m=0;m<n.length;m++){let c=n[m];if((0,u.configEquals)(c.config,d))return c.ownedBy.push(_),c.atlas}let g=_._core,v={atlas:new h.TextureAtlas(document,d,g.unicodeService),config:d,ownedBy:[_]};return n.push(v),v.atlas},t.removeTerminalFromCache=function(_){for(let p=0;p<n.length;p++){let f=n[p].ownedBy.indexOf(_);if(f!==-1){n[p].ownedBy.length===1?(n[p].atlas.dispose(),n.splice(p,1)):n[p].ownedBy.splice(f,1);break}}}},197:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;let h=a(160);t.generateConfig=function(u,n,_,p,f,i,e){let r={foreground:i.foreground,background:i.background,cursor:h.NULL_COLOR,cursorAccent:h.NULL_COLOR,selectionForeground:h.NULL_COLOR,selectionBackgroundTransparent:h.NULL_COLOR,selectionBackgroundOpaque:h.NULL_COLOR,selectionInactiveBackgroundTransparent:h.NULL_COLOR,selectionInactiveBackgroundOpaque:h.NULL_COLOR,ansi:i.ansi.slice(),contrastCache:i.contrastCache};return{customGlyphs:f.customGlyphs,devicePixelRatio:e,letterSpacing:f.letterSpacing,lineHeight:f.lineHeight,deviceCellWidth:u,deviceCellHeight:n,deviceCharWidth:_,deviceCharHeight:p,fontFamily:f.fontFamily,fontSize:f.fontSize,fontWeight:f.fontWeight,fontWeightBold:f.fontWeightBold,allowTransparency:f.allowTransparency,drawBoldTextInBrightColors:f.drawBoldTextInBrightColors,minimumContrastRatio:f.minimumContrastRatio,colors:r}},t.configEquals=function(u,n){for(let _=0;_<u.colors.ansi.length;_++)if(u.colors.ansi[_].rgba!==n.colors.ansi[_].rgba)return!1;return u.devicePixelRatio===n.devicePixelRatio&&u.customGlyphs===n.customGlyphs&&u.lineHeight===n.lineHeight&&u.letterSpacing===n.letterSpacing&&u.fontFamily===n.fontFamily&&u.fontSize===n.fontSize&&u.fontWeight===n.fontWeight&&u.fontWeightBold===n.fontWeightBold&&u.allowTransparency===n.allowTransparency&&u.deviceCharWidth===n.deviceCharWidth&&u.deviceCharHeight===n.deviceCharHeight&&u.drawBoldTextInBrightColors===n.drawBoldTextInBrightColors&&u.minimumContrastRatio===n.minimumContrastRatio&&u.colors.foreground.rgba===n.colors.foreground.rgba&&u.colors.background.rgba===n.colors.background.rgba},t.is256Color=function(u){return(50331648&u)==16777216||(50331648&u)==33554432}},237:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;let h=a(399);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},860:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.powerlineDefinitions=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;let h=a(374);t.blockElementDefinitions={"\u2580":[{x:0,y:0,w:8,h:4}],"\u2581":[{x:0,y:7,w:8,h:1}],"\u2582":[{x:0,y:6,w:8,h:2}],"\u2583":[{x:0,y:5,w:8,h:3}],"\u2584":[{x:0,y:4,w:8,h:4}],"\u2585":[{x:0,y:3,w:8,h:5}],"\u2586":[{x:0,y:2,w:8,h:6}],"\u2587":[{x:0,y:1,w:8,h:7}],"\u2588":[{x:0,y:0,w:8,h:8}],"\u2589":[{x:0,y:0,w:7,h:8}],"\u258A":[{x:0,y:0,w:6,h:8}],"\u258B":[{x:0,y:0,w:5,h:8}],"\u258C":[{x:0,y:0,w:4,h:8}],"\u258D":[{x:0,y:0,w:3,h:8}],"\u258E":[{x:0,y:0,w:2,h:8}],"\u258F":[{x:0,y:0,w:1,h:8}],"\u2590":[{x:4,y:0,w:4,h:8}],"\u2594":[{x:0,y:0,w:8,h:1}],"\u2595":[{x:7,y:0,w:1,h:8}],"\u2596":[{x:0,y:4,w:4,h:4}],"\u2597":[{x:4,y:4,w:4,h:4}],"\u2598":[{x:0,y:0,w:4,h:4}],"\u2599":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u259A":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"\u259B":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"\u259C":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"\u259D":[{x:4,y:0,w:4,h:4}],"\u259E":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"\u259F":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u{1FB70}":[{x:1,y:0,w:1,h:8}],"\u{1FB71}":[{x:2,y:0,w:1,h:8}],"\u{1FB72}":[{x:3,y:0,w:1,h:8}],"\u{1FB73}":[{x:4,y:0,w:1,h:8}],"\u{1FB74}":[{x:5,y:0,w:1,h:8}],"\u{1FB75}":[{x:6,y:0,w:1,h:8}],"\u{1FB76}":[{x:0,y:1,w:8,h:1}],"\u{1FB77}":[{x:0,y:2,w:8,h:1}],"\u{1FB78}":[{x:0,y:3,w:8,h:1}],"\u{1FB79}":[{x:0,y:4,w:8,h:1}],"\u{1FB7A}":[{x:0,y:5,w:8,h:1}],"\u{1FB7B}":[{x:0,y:6,w:8,h:1}],"\u{1FB7C}":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB7D}":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7E}":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7F}":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB80}":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB81}":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB82}":[{x:0,y:0,w:8,h:2}],"\u{1FB83}":[{x:0,y:0,w:8,h:3}],"\u{1FB84}":[{x:0,y:0,w:8,h:5}],"\u{1FB85}":[{x:0,y:0,w:8,h:6}],"\u{1FB86}":[{x:0,y:0,w:8,h:7}],"\u{1FB87}":[{x:6,y:0,w:2,h:8}],"\u{1FB88}":[{x:5,y:0,w:3,h:8}],"\u{1FB89}":[{x:3,y:0,w:5,h:8}],"\u{1FB8A}":[{x:2,y:0,w:6,h:8}],"\u{1FB8B}":[{x:1,y:0,w:7,h:8}],"\u{1FB95}":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"\u{1FB96}":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"\u{1FB97}":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};let u={"\u2591":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"\u2592":[[1,0],[0,0],[0,1],[0,0]],"\u2593":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"\u2500":{1:"M0,.5 L1,.5"},"\u2501":{3:"M0,.5 L1,.5"},"\u2502":{1:"M.5,0 L.5,1"},"\u2503":{3:"M.5,0 L.5,1"},"\u250C":{1:"M0.5,1 L.5,.5 L1,.5"},"\u250F":{3:"M0.5,1 L.5,.5 L1,.5"},"\u2510":{1:"M0,.5 L.5,.5 L.5,1"},"\u2513":{3:"M0,.5 L.5,.5 L.5,1"},"\u2514":{1:"M.5,0 L.5,.5 L1,.5"},"\u2517":{3:"M.5,0 L.5,.5 L1,.5"},"\u2518":{1:"M.5,0 L.5,.5 L0,.5"},"\u251B":{3:"M.5,0 L.5,.5 L0,.5"},"\u251C":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2523":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2524":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252B":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252C":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2533":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2534":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253B":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253C":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u254B":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u2574":{1:"M.5,.5 L0,.5"},"\u2578":{3:"M.5,.5 L0,.5"},"\u2575":{1:"M.5,.5 L.5,0"},"\u2579":{3:"M.5,.5 L.5,0"},"\u2576":{1:"M.5,.5 L1,.5"},"\u257A":{3:"M.5,.5 L1,.5"},"\u2577":{1:"M.5,.5 L.5,1"},"\u257B":{3:"M.5,.5 L.5,1"},"\u2550":{1:(i,e)=>`M0,${.5-e} L1,${.5-e} M0,${.5+e} L1,${.5+e}`},"\u2551":{1:(i,e)=>`M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"\u2552":{1:(i,e)=>`M.5,1 L.5,${.5-e} L1,${.5-e} M.5,${.5+e} L1,${.5+e}`},"\u2553":{1:(i,e)=>`M${.5-i},1 L${.5-i},.5 L1,.5 M${.5+i},.5 L${.5+i},1`},"\u2554":{1:(i,e)=>`M1,${.5-e} L${.5-i},${.5-e} L${.5-i},1 M1,${.5+e} L${.5+i},${.5+e} L${.5+i},1`},"\u2555":{1:(i,e)=>`M0,${.5-e} L.5,${.5-e} L.5,1 M0,${.5+e} L.5,${.5+e}`},"\u2556":{1:(i,e)=>`M${.5+i},1 L${.5+i},.5 L0,.5 M${.5-i},.5 L${.5-i},1`},"\u2557":{1:(i,e)=>`M0,${.5+e} L${.5-i},${.5+e} L${.5-i},1 M0,${.5-e} L${.5+i},${.5-e} L${.5+i},1`},"\u2558":{1:(i,e)=>`M.5,0 L.5,${.5+e} L1,${.5+e} M.5,${.5-e} L1,${.5-e}`},"\u2559":{1:(i,e)=>`M1,.5 L${.5-i},.5 L${.5-i},0 M${.5+i},.5 L${.5+i},0`},"\u255A":{1:(i,e)=>`M1,${.5-e} L${.5+i},${.5-e} L${.5+i},0 M1,${.5+e} L${.5-i},${.5+e} L${.5-i},0`},"\u255B":{1:(i,e)=>`M0,${.5+e} L.5,${.5+e} L.5,0 M0,${.5-e} L.5,${.5-e}`},"\u255C":{1:(i,e)=>`M0,.5 L${.5+i},.5 L${.5+i},0 M${.5-i},.5 L${.5-i},0`},"\u255D":{1:(i,e)=>`M0,${.5-e} L${.5-i},${.5-e} L${.5-i},0 M0,${.5+e} L${.5+i},${.5+e} L${.5+i},0`},"\u255E":{1:(i,e)=>`M.5,0 L.5,1 M.5,${.5-e} L1,${.5-e} M.5,${.5+e} L1,${.5+e}`},"\u255F":{1:(i,e)=>`M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1 M${.5+i},.5 L1,.5`},"\u2560":{1:(i,e)=>`M${.5-i},0 L${.5-i},1 M1,${.5+e} L${.5+i},${.5+e} L${.5+i},1 M1,${.5-e} L${.5+i},${.5-e} L${.5+i},0`},"\u2561":{1:(i,e)=>`M.5,0 L.5,1 M0,${.5-e} L.5,${.5-e} M0,${.5+e} L.5,${.5+e}`},"\u2562":{1:(i,e)=>`M0,.5 L${.5-i},.5 M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"\u2563":{1:(i,e)=>`M${.5+i},0 L${.5+i},1 M0,${.5+e} L${.5-i},${.5+e} L${.5-i},1 M0,${.5-e} L${.5-i},${.5-e} L${.5-i},0`},"\u2564":{1:(i,e)=>`M0,${.5-e} L1,${.5-e} M0,${.5+e} L1,${.5+e} M.5,${.5+e} L.5,1`},"\u2565":{1:(i,e)=>`M0,.5 L1,.5 M${.5-i},.5 L${.5-i},1 M${.5+i},.5 L${.5+i},1`},"\u2566":{1:(i,e)=>`M0,${.5-e} L1,${.5-e} M0,${.5+e} L${.5-i},${.5+e} L${.5-i},1 M1,${.5+e} L${.5+i},${.5+e} L${.5+i},1`},"\u2567":{1:(i,e)=>`M.5,0 L.5,${.5-e} M0,${.5-e} L1,${.5-e} M0,${.5+e} L1,${.5+e}`},"\u2568":{1:(i,e)=>`M0,.5 L1,.5 M${.5-i},.5 L${.5-i},0 M${.5+i},.5 L${.5+i},0`},"\u2569":{1:(i,e)=>`M0,${.5+e} L1,${.5+e} M0,${.5-e} L${.5-i},${.5-e} L${.5-i},0 M1,${.5-e} L${.5+i},${.5-e} L${.5+i},0`},"\u256A":{1:(i,e)=>`M.5,0 L.5,1 M0,${.5-e} L1,${.5-e} M0,${.5+e} L1,${.5+e}`},"\u256B":{1:(i,e)=>`M0,.5 L1,.5 M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"\u256C":{1:(i,e)=>`M0,${.5+e} L${.5-i},${.5+e} L${.5-i},1 M1,${.5+e} L${.5+i},${.5+e} L${.5+i},1 M0,${.5-e} L${.5-i},${.5-e} L${.5-i},0 M1,${.5-e} L${.5+i},${.5-e} L${.5+i},0`},"\u2571":{1:"M1,0 L0,1"},"\u2572":{1:"M0,0 L1,1"},"\u2573":{1:"M1,0 L0,1 M0,0 L1,1"},"\u257C":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u257D":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"\u257E":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u257F":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u250D":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u250E":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2511":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"\u2512":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2515":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"\u2516":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2519":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"\u251A":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"\u251D":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"\u251E":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u251F":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2520":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2521":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2522":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"\u2525":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"\u2526":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2527":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2528":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"\u2529":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"\u252A":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"\u252D":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u252E":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u252F":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"\u2530":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2531":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2532":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2535":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u2536":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u2537":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"\u2538":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2539":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u253A":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"\u253D":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u253E":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u253F":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"\u2540":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2541":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2542":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2543":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u2544":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2545":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2546":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2547":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"\u2548":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2549":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u254A":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u254C":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u254D":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u2504":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2505":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2508":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u2509":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u254E":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u254F":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u2506":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u2507":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u250A":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u250B":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u256D":{1:(i,e)=>`M.5,1 L.5,${.5+e/.15*.5} C.5,${.5+e/.15*.5},.5,.5,1,.5`},"\u256E":{1:(i,e)=>`M.5,1 L.5,${.5+e/.15*.5} C.5,${.5+e/.15*.5},.5,.5,0,.5`},"\u256F":{1:(i,e)=>`M.5,0 L.5,${.5-e/.15*.5} C.5,${.5-e/.15*.5},.5,.5,0,.5`},"\u2570":{1:(i,e)=>`M.5,0 L.5,${.5-e/.15*.5} C.5,${.5-e/.15*.5},.5,.5,1,.5`}},t.powerlineDefinitions={"\uE0B0":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"\uE0B1":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0B2":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"\uE0B3":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0B4":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"\uE0B5":{d:"M0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:1,rightPadding:1},"\uE0B6":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"\uE0B7":{d:"M1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:1,leftPadding:1},"\uE0B8":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"\uE0B9":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0BA":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"\uE0BC":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"\uE0BD":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0BE":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},t.powerlineDefinitions["\uE0BB"]=t.powerlineDefinitions["\uE0B9"],t.powerlineDefinitions["\uE0BF"]=t.powerlineDefinitions["\uE0BD"],t.tryDrawCustomChar=function(i,e,r,o,s,d,g,v){let m=t.blockElementDefinitions[e];if(m)return function(b,w,y,D,B,O){for(let C=0;C<w.length;C++){let L=w[C],E=B/8,x=O/8;b.fillRect(y+L.x*E,D+L.y*x,L.w*E,L.h*x)}}(i,m,r,o,s,d),!0;let c=u[e];if(c)return function(b,w,y,D,B,O){let C=n.get(w);C||(C=new Map,n.set(w,C));let L=b.fillStyle;if(typeof L!="string")throw new Error(`Unexpected fillStyle type "${L}"`);let E=C.get(L);if(!E){let x=w[0].length,I=w.length,N=document.createElement("canvas");N.width=x,N.height=I;let j=(0,h.throwIfFalsy)(N.getContext("2d")),H=new ImageData(x,I),z,R,A,T;if(L.startsWith("#"))z=parseInt(L.slice(1,3),16),R=parseInt(L.slice(3,5),16),A=parseInt(L.slice(5,7),16),T=L.length>7&&parseInt(L.slice(7,9),16)||1;else{if(!L.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${L}" when drawing pattern glyph`);[z,R,A,T]=L.substring(5,L.length-1).split(",").map(F=>parseFloat(F))}for(let F=0;F<I;F++)for(let U=0;U<x;U++)H.data[4*(F*x+U)]=z,H.data[4*(F*x+U)+1]=R,H.data[4*(F*x+U)+2]=A,H.data[4*(F*x+U)+3]=w[F][U]*(255*T);j.putImageData(H,0,0),E=(0,h.throwIfFalsy)(b.createPattern(N,null)),C.set(L,E)}b.fillStyle=E,b.fillRect(y,D,B,O)}(i,c,r,o,s,d),!0;let l=t.boxDrawingDefinitions[e];if(l)return function(b,w,y,D,B,O,C){b.strokeStyle=b.fillStyle;for(let[L,E]of Object.entries(w)){let x;b.beginPath(),b.lineWidth=C*Number.parseInt(L),x=typeof E=="function"?E(.15,.15/O*B):E;for(let I of x.split(" ")){let N=I[0],j=p[N];if(!j){console.error(`Could not find drawing instructions for "${N}"`);continue}let H=I.substring(1).split(",");H[0]&&H[1]&&j(b,f(H,B,O,y,D,!0,C))}b.stroke(),b.closePath()}}(i,l,r,o,s,d,v),!0;let S=t.powerlineDefinitions[e];return!!S&&(function(b,w,y,D,B,O,C,L){var E,x;let I=new Path2D;I.rect(y,D,B,O),b.clip(I),b.beginPath();let N=C/12;b.lineWidth=L*N;for(let j of w.d.split(" ")){let H=j[0],z=p[H];if(!z){console.error(`Could not find drawing instructions for "${H}"`);continue}let R=j.substring(1).split(",");R[0]&&R[1]&&z(b,f(R,B,O,y,D,!1,L,((E=w.leftPadding)!==null&&E!==void 0?E:0)*(N/2),((x=w.rightPadding)!==null&&x!==void 0?x:0)*(N/2)))}w.type===1?(b.strokeStyle=b.fillStyle,b.stroke()):b.fill(),b.closePath()}(i,S,r,o,s,d,g,v),!0)};let n=new Map;function _(i,e,r=0){return Math.max(Math.min(i,e),r)}let p={C:(i,e)=>i.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5]),L:(i,e)=>i.lineTo(e[0],e[1]),M:(i,e)=>i.moveTo(e[0],e[1])};function f(i,e,r,o,s,d,g,v=0,m=0){let c=i.map(l=>parseFloat(l)||parseInt(l));if(c.length<2)throw new Error("Too few arguments for instruction");for(let l=0;l<c.length;l+=2)c[l]*=e-v*g-m*g,d&&c[l]!==0&&(c[l]=_(Math.round(c[l]+.5)-.5,e,0)),c[l]+=o+v*g;for(let l=1;l<c.length;l+=2)c[l]*=r,d&&c[l]!==0&&(c[l]=_(Math.round(c[l]+.5)-.5,r,0)),c[l]+=s;return c}},56:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.observeDevicePixelDimensions=void 0;let h=a(859);t.observeDevicePixelDimensions=function(u,n,_){let p=new n.ResizeObserver(f=>{let i=f.find(o=>o.target===u);if(!i)return;if(!("devicePixelContentBoxSize"in i))return p?.disconnect(),void(p=void 0);let e=i.devicePixelContentBoxSize[0].inlineSize,r=i.devicePixelContentBoxSize[0].blockSize;e>0&&r>0&&_(e,r)});try{p.observe(u,{box:["device-pixel-content-box"]})}catch{p.disconnect(),p=void 0}return(0,h.toDisposable)(()=>p?.disconnect())}},374:(k,t)=>{function a(h){return 57508<=h&&h<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderDimensions=t.excludeFromContrastRatioDemands=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(h){if(!h)throw new Error("value must not be falsy");return h},t.isPowerlineGlyph=a,t.isRestrictedPowerlineGlyph=function(h){return 57520<=h&&h<=57527},t.excludeFromContrastRatioDemands=function(h){return a(h)||function(u){return 9472<=u&&u<=9631}(h)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;class a{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(u,n,_,p=!1){if(this.selectionStart=n,this.selectionEnd=_,!n||!_||n[0]===_[0]&&n[1]===_[1])return void this.clear();let f=n[1]-u.buffer.active.viewportY,i=_[1]-u.buffer.active.viewportY,e=Math.max(f,0),r=Math.min(i,u.rows-1);e>=u.rows||r<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=p,this.viewportStartRow=f,this.viewportEndRow=i,this.viewportCappedStartRow=e,this.viewportCappedEndRow=r,this.startCol=n[0],this.endCol=_[0])}isCellSelected(u,n,_){return!!this.hasSelection&&(_-=u.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?n>=this.startCol&&_>=this.viewportCappedStartRow&&n<this.endCol&&_<=this.viewportCappedEndRow:n<this.startCol&&_>=this.viewportCappedStartRow&&n>=this.endCol&&_<=this.viewportCappedEndRow:_>this.viewportStartRow&&_<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&_===this.viewportStartRow&&n>=this.startCol&&n<this.endCol||this.viewportStartRow<this.viewportEndRow&&_===this.viewportEndRow&&n<this.endCol||this.viewportStartRow<this.viewportEndRow&&_===this.viewportStartRow&&n>=this.startCol)}}t.createSelectionRenderModel=function(){return new a}},509:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAtlas=void 0;let h=a(237),u=a(855),n=a(147),_=a(160),p=a(860),f=a(374),i=a(485),e=a(385),r=a(345),o={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},s;class d{constructor(l,S,b){this._document=l,this._config=S,this._unicodeService=b,this._didWarmUp=!1,this._cacheMap=new i.FourKeyMap,this._cacheMapCombined=new i.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new n.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new r.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new r.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=m(l,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,f.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}get pages(){return this._pages}dispose(){for(let l of this.pages)l.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){let l=new e.IdleTaskQueue;for(let S=33;S<126;S++)l.enqueue(()=>{if(!this._cacheMap.get(S,u.DEFAULT_COLOR,u.DEFAULT_COLOR,u.DEFAULT_EXT)){let b=this._drawToCache(S,u.DEFAULT_COLOR,u.DEFAULT_COLOR,u.DEFAULT_EXT);this._cacheMap.set(S,u.DEFAULT_COLOR,u.DEFAULT_COLOR,u.DEFAULT_EXT,b)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(let l of this._pages)l.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){d.maxAtlasPages&&this._pages.length>=Math.max(4,d.maxAtlasPages/2)&&queueMicrotask(()=>{let S=this._pages.filter(C=>2*C.canvas.width<=(d.maxTextureSize||4096)).sort((C,L)=>L.canvas.width!==C.canvas.width?L.canvas.width-C.canvas.width:L.percentageUsed-C.percentageUsed),b=-1,w=0;for(let C=0;C<S.length;C++)if(S[C].canvas.width!==w)b=C,w=S[C].canvas.width;else if(C-b==3)break;let y=S.slice(b,b+4),D=y.map(C=>C.glyphs[0].texturePage).sort((C,L)=>C>L?1:-1),B=D[0],O=this._mergePages(y,B);O.version++,this._pages[B]=O;for(let C=D.length-1;C>=1;C--)this._deletePage(D[C]);this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(O.canvas)});let l=new g(this._document,this._textureSize);return this._pages.push(l),this._activePages.push(l),this._onAddTextureAtlasCanvas.fire(l.canvas),l}_mergePages(l,S){let b=2*l[0].canvas.width,w=new g(this._document,b,l);for(let[y,D]of l.entries()){let B=y*D.canvas.width%b,O=Math.floor(y/2)*D.canvas.height;w.ctx.drawImage(D.canvas,B,O);for(let L of D.glyphs)L.texturePage=S,L.sizeClipSpace.x=L.size.x/b,L.sizeClipSpace.y=L.size.y/b,L.texturePosition.x+=B,L.texturePosition.y+=O,L.texturePositionClipSpace.x=L.texturePosition.x/b,L.texturePositionClipSpace.y=L.texturePosition.y/b;this._onRemoveTextureAtlasCanvas.fire(D.canvas);let C=this._activePages.indexOf(D);C!==-1&&this._activePages.splice(C,1)}return w}_deletePage(l){this._pages.splice(l,1);for(let S=l;S<this._pages.length;S++){let b=this._pages[S];for(let w of b.glyphs)w.texturePage--;b.version++}}getRasterizedGlyphCombinedChar(l,S,b,w){return this._getFromCacheMap(this._cacheMapCombined,l,S,b,w)}getRasterizedGlyph(l,S,b,w){return this._getFromCacheMap(this._cacheMap,l,S,b,w)}_getFromCacheMap(l,S,b,w,y){return s=l.get(S,b,w,y),s||(s=this._drawToCache(S,b,w,y),l.set(S,b,w,y,s)),s}_getColorFromAnsiIndex(l){if(l>=this._config.colors.ansi.length)throw new Error("No color found for idx "+l);return this._config.colors.ansi[l]}_getBackgroundColor(l,S,b,w){if(this._config.allowTransparency)return _.NULL_COLOR;let y;switch(l){case 16777216:case 33554432:y=this._getColorFromAnsiIndex(S);break;case 50331648:let D=n.AttributeData.toColorRGB(S);y=_.rgba.toColor(D[0],D[1],D[2]);break;default:y=b?this._config.colors.foreground:this._config.colors.background}return w&&(y=_.color.blend(this._config.colors.background,_.color.multiplyOpacity(y,h.DIM_OPACITY))),y}_getForegroundColor(l,S,b,w,y,D,B,O,C,L){let E=this._getMinimumContrastColor(l,S,b,w,y,D,!1,C,L);if(E)return E;let x;switch(y){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&C&&D<8&&(D+=8),x=this._getColorFromAnsiIndex(D);break;case 50331648:let I=n.AttributeData.toColorRGB(D);x=_.rgba.toColor(I[0],I[1],I[2]);break;default:x=B?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(x=_.color.opaque(x)),O&&(x=_.color.multiplyOpacity(x,h.DIM_OPACITY)),x}_resolveBackgroundRgba(l,S,b){switch(l){case 16777216:case 33554432:return this._getColorFromAnsiIndex(S).rgba;case 50331648:return S<<8;default:return b?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(l,S,b,w){switch(l){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&w&&S<8&&(S+=8),this._getColorFromAnsiIndex(S).rgba;case 50331648:return S<<8;default:return b?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(l,S,b,w,y,D,B,O,C){if(this._config.minimumContrastRatio===1||C)return;let L=this._config.colors.contrastCache.getColor(l,w);if(L!==void 0)return L||void 0;let E=this._resolveBackgroundRgba(S,b,B),x=this._resolveForegroundRgba(y,D,B,O),I=_.rgba.ensureContrastRatio(E,x,this._config.minimumContrastRatio);if(!I)return void this._config.colors.contrastCache.setColor(l,w,null);let N=_.rgba.toColor(I>>24&255,I>>16&255,I>>8&255);return this._config.colors.contrastCache.setColor(l,w,N),N}_drawToCache(l,S,b,w){let y=typeof l=="number"?String.fromCharCode(l):l,D=this._config.deviceCellWidth*Math.max(y.length,2)+4;this._tmpCanvas.width<D&&(this._tmpCanvas.width=D);let B=this._config.deviceCellHeight+8;if(this._tmpCanvas.height<B&&(this._tmpCanvas.height=B),this._tmpCtx.save(),this._workAttributeData.fg=b,this._workAttributeData.bg=S,this._workAttributeData.extended.ext=w,this._workAttributeData.isInvisible())return o;let O=!!this._workAttributeData.isBold(),C=!!this._workAttributeData.isInverse(),L=!!this._workAttributeData.isDim(),E=!!this._workAttributeData.isItalic(),x=!!this._workAttributeData.isUnderline(),I=!!this._workAttributeData.isStrikethrough(),N=this._workAttributeData.getFgColor(),j=this._workAttributeData.getFgColorMode(),H=this._workAttributeData.getBgColor(),z=this._workAttributeData.getBgColorMode();if(C){let G=N;N=H,H=G;let J=j;j=z,z=J}let R=this._getBackgroundColor(z,H,C,L);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=R.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";let A=O?this._config.fontWeightBold:this._config.fontWeight,T=E?"italic":"";this._tmpCtx.font=`${T} ${A} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=h.TEXT_BASELINE;let F=y.length===1&&(0,f.isPowerlineGlyph)(y.charCodeAt(0)),U=y.length===1&&(0,f.isRestrictedPowerlineGlyph)(y.charCodeAt(0)),V=this._getForegroundColor(S,z,H,b,j,N,C,L,O,(0,f.excludeFromContrastRatioDemands)(y.charCodeAt(0)));this._tmpCtx.fillStyle=V.css;let $=U?0:4,te=!1;this._config.customGlyphs!==!1&&(te=(0,p.tryDrawCustomChar)(this._tmpCtx,y,$,$,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let ie,Q=!F;if(ie=typeof l=="number"?this._unicodeService.wcwidth(l):this._unicodeService.getStringCellWidth(l),x){this._tmpCtx.save();let G=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),J=G%2==1?.5:0;if(this._tmpCtx.lineWidth=G,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())Q=!1,this._tmpCtx.strokeStyle=`rgb(${n.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{Q=!1;let ae=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&ae<8&&(ae+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(ae).css}this._tmpCtx.beginPath();let oe=$,re=Math.ceil($+this._config.deviceCharHeight)-J,_e=$+this._config.deviceCharHeight+G-J,ue=Math.ceil($+this._config.deviceCharHeight+2*G)-J;for(let ae=0;ae<ie;ae++){this._tmpCtx.save();let se=oe+ae*this._config.deviceCellWidth,he=oe+(ae+1)*this._config.deviceCellWidth,ye=se+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(se,re),this._tmpCtx.lineTo(he,re),this._tmpCtx.moveTo(se,ue),this._tmpCtx.lineTo(he,ue);break;case 3:let ve=G<=1?ue:Math.ceil($+this._config.deviceCharHeight-G/2)-J,pe=G<=1?re:Math.ceil($+this._config.deviceCharHeight+G/2)-J,Te=new Path2D;Te.rect(se,re,this._config.deviceCellWidth,ue-re),this._tmpCtx.clip(Te),this._tmpCtx.moveTo(se-this._config.deviceCellWidth/2,_e),this._tmpCtx.bezierCurveTo(se-this._config.deviceCellWidth/2,pe,se,pe,se,_e),this._tmpCtx.bezierCurveTo(se,ve,ye,ve,ye,_e),this._tmpCtx.bezierCurveTo(ye,pe,he,pe,he,_e),this._tmpCtx.bezierCurveTo(he,ve,he+this._config.deviceCellWidth/2,ve,he+this._config.deviceCellWidth/2,_e);break;case 4:this._tmpCtx.setLineDash([2*this._config.devicePixelRatio,this._config.devicePixelRatio]),this._tmpCtx.moveTo(se,re),this._tmpCtx.lineTo(he,re);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(se,re),this._tmpCtx.lineTo(he,re);break;default:this._tmpCtx.moveTo(se,re),this._tmpCtx.lineTo(he,re)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!te&&this._config.fontSize>=12&&!this._config.allowTransparency&&y!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";let ae=this._tmpCtx.measureText(y);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in ae&&ae.actualBoundingBoxDescent>0){this._tmpCtx.save();let se=new Path2D;se.rect(oe,re-Math.ceil(G/2),this._config.deviceCellWidth,ue-re+Math.ceil(G/2)),this._tmpCtx.clip(se),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=R.css,this._tmpCtx.strokeText(y,$,$+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(te||this._tmpCtx.fillText(y,$,$+this._config.deviceCharHeight),y==="_"&&!this._config.allowTransparency){let G=v(this._tmpCtx.getImageData($,$,this._config.deviceCellWidth,this._config.deviceCellHeight),R,V,Q);if(G)for(let J=1;J<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=R.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(y,$,$+this._config.deviceCharHeight-J),G=v(this._tmpCtx.getImageData($,$,this._config.deviceCellWidth,this._config.deviceCellHeight),R,V,Q),G);J++);}if(I){let G=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),J=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=G,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo($,$+Math.floor(this._config.deviceCharHeight/2)-J),this._tmpCtx.lineTo($+this._config.deviceCharWidth*ie,$+Math.floor(this._config.deviceCharHeight/2)-J),this._tmpCtx.stroke()}this._tmpCtx.restore();let X=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height),ge;if(ge=this._config.allowTransparency?function(G){for(let J=0;J<G.data.length;J+=4)if(G.data[J+3]>0)return!1;return!0}(X):v(X,R,V,Q),ge)return o;let Z=this._findGlyphBoundingBox(X,this._workBoundingBox,D,U,te,$),K,Y;for(;;){if(this._activePages.length===0){let G=this._createNewPage();K=G,Y=G.currentRow,Y.height=Z.size.y;break}K=this._activePages[this._activePages.length-1],Y=K.currentRow;for(let G of this._activePages)Z.size.y<=G.currentRow.height&&(K=G,Y=G.currentRow);for(let G=this._activePages.length-1;G>=0;G--)for(let J of this._activePages[G].fixedRows)J.height<=Y.height&&Z.size.y<=J.height&&(K=this._activePages[G],Y=J);if(Y.y+Z.size.y>=K.canvas.height||Y.height>Z.size.y+2){let G=!1;if(K.currentRow.y+K.currentRow.height+Z.size.y>=K.canvas.height){let J;for(let oe of this._activePages)if(oe.currentRow.y+oe.currentRow.height+Z.size.y<oe.canvas.height){J=oe;break}if(J)K=J;else{let oe=this._createNewPage();K=oe,Y=oe.currentRow,Y.height=Z.size.y,G=!0}}G||(K.currentRow.height>0&&K.fixedRows.push(K.currentRow),Y={x:0,y:K.currentRow.y+K.currentRow.height,height:Z.size.y},K.fixedRows.push(Y),K.currentRow={x:0,y:Y.y+Y.height,height:0})}if(Y.x+Z.size.x<=K.canvas.width)break;Y===K.currentRow?(Y.x=0,Y.y+=Y.height,Y.height=0):K.fixedRows.splice(K.fixedRows.indexOf(Y),1)}return Z.texturePage=this._pages.indexOf(K),Z.texturePosition.x=Y.x,Z.texturePosition.y=Y.y,Z.texturePositionClipSpace.x=Y.x/K.canvas.width,Z.texturePositionClipSpace.y=Y.y/K.canvas.height,Z.sizeClipSpace.x/=K.canvas.width,Z.sizeClipSpace.y/=K.canvas.height,Y.height=Math.max(Y.height,Z.size.y),Y.x+=Z.size.x,K.ctx.putImageData(X,Z.texturePosition.x-this._workBoundingBox.left,Z.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,Z.size.x,Z.size.y),K.addGlyph(Z),K.version++,Z}_findGlyphBoundingBox(l,S,b,w,y,D){S.top=0;let B=w?this._config.deviceCellHeight:this._tmpCanvas.height,O=w?this._config.deviceCellWidth:b,C=!1;for(let L=0;L<B;L++){for(let E=0;E<O;E++){let x=L*this._tmpCanvas.width*4+4*E+3;if(l.data[x]!==0){S.top=L,C=!0;break}}if(C)break}S.left=0,C=!1;for(let L=0;L<D+O;L++){for(let E=0;E<B;E++){let x=E*this._tmpCanvas.width*4+4*L+3;if(l.data[x]!==0){S.left=L,C=!0;break}}if(C)break}S.right=O,C=!1;for(let L=D+O-1;L>=D;L--){for(let E=0;E<B;E++){let x=E*this._tmpCanvas.width*4+4*L+3;if(l.data[x]!==0){S.right=L,C=!0;break}}if(C)break}S.bottom=B,C=!1;for(let L=B-1;L>=0;L--){for(let E=0;E<O;E++){let x=L*this._tmpCanvas.width*4+4*E+3;if(l.data[x]!==0){S.bottom=L,C=!0;break}}if(C)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:S.right-S.left+1,y:S.bottom-S.top+1},sizeClipSpace:{x:S.right-S.left+1,y:S.bottom-S.top+1},offset:{x:-S.left+D+(w||y?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-S.top+D+(w||y?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}t.TextureAtlas=d;class g{constructor(l,S,b){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],b)for(let w of b)this._glyphs.push(...w.glyphs),this._usedPixels+=w._usedPixels;this.canvas=m(l,S,S),this.ctx=(0,f.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(l){this._glyphs.push(l),this._usedPixels+=l.size.x*l.size.y}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function v(c,l,S,b){let w=l.rgba>>>24,y=l.rgba>>>16&255,D=l.rgba>>>8&255,B=S.rgba>>>24,O=S.rgba>>>16&255,C=S.rgba>>>8&255,L=Math.floor((Math.abs(w-B)+Math.abs(y-O)+Math.abs(D-C))/12),E=!0;for(let x=0;x<c.data.length;x+=4)c.data[x]===w&&c.data[x+1]===y&&c.data[x+2]===D||b&&Math.abs(c.data[x]-w)+Math.abs(c.data[x+1]-y)+Math.abs(c.data[x+2]-D)<L?c.data[x+3]=0:E=!1;return E}function m(c,l,S){let b=c.createElement("canvas");return b.width=l,b.height=S,b}},160:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;let h=a(399),u=0,n=0,_=0,p=0;var f,i,e;function r(s){let d=s.toString(16);return d.length<2?"0"+d:d}function o(s,d){return s<d?(d+.05)/(s+.05):(s+.05)/(d+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(s){s.toCss=function(d,g,v,m){return m!==void 0?`#${r(d)}${r(g)}${r(v)}${r(m)}`:`#${r(d)}${r(g)}${r(v)}`},s.toRgba=function(d,g,v,m=255){return(d<<24|g<<16|v<<8|m)>>>0}}(f=t.channels||(t.channels={})),function(s){function d(g,v){return p=Math.round(255*v),[u,n,_]=e.toChannels(g.rgba),{css:f.toCss(u,n,_,p),rgba:f.toRgba(u,n,_,p)}}s.blend=function(g,v){if(p=(255&v.rgba)/255,p===1)return{css:v.css,rgba:v.rgba};let m=v.rgba>>24&255,c=v.rgba>>16&255,l=v.rgba>>8&255,S=g.rgba>>24&255,b=g.rgba>>16&255,w=g.rgba>>8&255;return u=S+Math.round((m-S)*p),n=b+Math.round((c-b)*p),_=w+Math.round((l-w)*p),{css:f.toCss(u,n,_),rgba:f.toRgba(u,n,_)}},s.isOpaque=function(g){return(255&g.rgba)==255},s.ensureContrastRatio=function(g,v,m){let c=e.ensureContrastRatio(g.rgba,v.rgba,m);if(c)return e.toColor(c>>24&255,c>>16&255,c>>8&255)},s.opaque=function(g){let v=(255|g.rgba)>>>0;return[u,n,_]=e.toChannels(v),{css:f.toCss(u,n,_),rgba:v}},s.opacity=d,s.multiplyOpacity=function(g,v){return p=255&g.rgba,d(g,p*v/255)},s.toColorRGB=function(g){return[g.rgba>>24&255,g.rgba>>16&255,g.rgba>>8&255]}}(t.color||(t.color={})),function(s){let d,g;if(!h.isNode){let v=document.createElement("canvas");v.width=1,v.height=1;let m=v.getContext("2d",{willReadFrequently:!0});m&&(d=m,d.globalCompositeOperation="copy",g=d.createLinearGradient(0,0,1,1))}s.toColor=function(v){if(v.match(/#[\da-f]{3,8}/i))switch(v.length){case 4:return u=parseInt(v.slice(1,2).repeat(2),16),n=parseInt(v.slice(2,3).repeat(2),16),_=parseInt(v.slice(3,4).repeat(2),16),e.toColor(u,n,_);case 5:return u=parseInt(v.slice(1,2).repeat(2),16),n=parseInt(v.slice(2,3).repeat(2),16),_=parseInt(v.slice(3,4).repeat(2),16),p=parseInt(v.slice(4,5).repeat(2),16),e.toColor(u,n,_,p);case 7:return{css:v,rgba:(parseInt(v.slice(1),16)<<8|255)>>>0};case 9:return{css:v,rgba:parseInt(v.slice(1),16)>>>0}}let m=v.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(m)return u=parseInt(m[1]),n=parseInt(m[2]),_=parseInt(m[3]),p=Math.round(255*(m[5]===void 0?1:parseFloat(m[5]))),e.toColor(u,n,_,p);if(!d||!g)throw new Error("css.toColor: Unsupported css format");if(d.fillStyle=g,d.fillStyle=v,typeof d.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(d.fillRect(0,0,1,1),[u,n,_,p]=d.getImageData(0,0,1,1).data,p!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:f.toRgba(u,n,_,p),css:v}}}(t.css||(t.css={})),function(s){function d(g,v,m){let c=g/255,l=v/255,S=m/255;return .2126*(c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4))+.7152*(l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4))+.0722*(S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4))}s.relativeLuminance=function(g){return d(g>>16&255,g>>8&255,255&g)},s.relativeLuminance2=d}(i=t.rgb||(t.rgb={})),function(s){function d(v,m,c){let l=v>>24&255,S=v>>16&255,b=v>>8&255,w=m>>24&255,y=m>>16&255,D=m>>8&255,B=o(i.relativeLuminance2(w,y,D),i.relativeLuminance2(l,S,b));for(;B<c&&(w>0||y>0||D>0);)w-=Math.max(0,Math.ceil(.1*w)),y-=Math.max(0,Math.ceil(.1*y)),D-=Math.max(0,Math.ceil(.1*D)),B=o(i.relativeLuminance2(w,y,D),i.relativeLuminance2(l,S,b));return(w<<24|y<<16|D<<8|255)>>>0}function g(v,m,c){let l=v>>24&255,S=v>>16&255,b=v>>8&255,w=m>>24&255,y=m>>16&255,D=m>>8&255,B=o(i.relativeLuminance2(w,y,D),i.relativeLuminance2(l,S,b));for(;B<c&&(w<255||y<255||D<255);)w=Math.min(255,w+Math.ceil(.1*(255-w))),y=Math.min(255,y+Math.ceil(.1*(255-y))),D=Math.min(255,D+Math.ceil(.1*(255-D))),B=o(i.relativeLuminance2(w,y,D),i.relativeLuminance2(l,S,b));return(w<<24|y<<16|D<<8|255)>>>0}s.ensureContrastRatio=function(v,m,c){let l=i.relativeLuminance(v>>8),S=i.relativeLuminance(m>>8);if(o(l,S)<c){if(S<l){let y=d(v,m,c),D=o(l,i.relativeLuminance(y>>8));if(D<c){let B=g(v,m,c);return D>o(l,i.relativeLuminance(B>>8))?y:B}return y}let b=g(v,m,c),w=o(l,i.relativeLuminance(b>>8));if(w<c){let y=d(v,m,c);return w>o(l,i.relativeLuminance(y>>8))?b:y}return b}},s.reduceLuminance=d,s.increaseLuminance=g,s.toChannels=function(v){return[v>>24&255,v>>16&255,v>>8&255,255&v]},s.toColor=function(v,m,c,l){return{css:f.toCss(v,m,c,l),rgba:f.toRgba(v,m,c,l)}}}(e=t.rgba||(t.rgba={})),t.toPaddedHex=r,t.contrastRatio=o},345:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===a)return void this._listeners.splice(h,1)}}})),this._event}fire(a,h){let u=[];for(let n=0;n<this._listeners.length;n++)u.push(this._listeners[n]);for(let n=0;n<u.length;n++)u[n].call(void 0,a,h)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},t.forwardEvent=function(a,h){return a(u=>h.fire(u))}},859:(k,t)=>{function a(h){for(let u of h)u.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){let u=this._disposables.indexOf(h);u!==-1&&this._disposables.splice(u,1)}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=a,t.getDisposeArrayDisposable=function(h){return{dispose:()=>a(h)}}},485:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(u,n,_){this._data[u]||(this._data[u]={}),this._data[u][n]=_}get(u,n){return this._data[u]?this._data[u][n]:void 0}clear(){this._data={}}}t.TwoKeyMap=a,t.FourKeyMap=class{constructor(){this._data=new a}set(h,u,n,_,p){this._data.get(h,u)||this._data.set(h,u,new a),this._data.get(h,u).set(n,_,p)}get(h,u,n,_){var p;return(p=this._data.get(h,u))===null||p===void 0?void 0:p.get(n,_)}clear(){this._data.clear()}}},399:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=typeof navigator>"u";let a=t.isNode?"node":navigator.userAgent,h=t.isNode?"node":navigator.platform;t.isFirefox=a.includes("Firefox"),t.isLegacyEdge=a.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(a),t.getSafariVersion=function(){if(!t.isSafari)return 0;let u=a.match(/Version\/(\d+)/);return u===null||u.length<2?0:parseInt(u[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),t.isIpad=h==="iPad",t.isIphone=h==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),t.isLinux=h.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(a)},385:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;let h=a(399);class u{constructor(){this._tasks=[],this._i=0}enqueue(p){this._tasks.push(p),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(p){this._idleCallback=void 0;let f=0,i=0,e=p.timeRemaining(),r=0;for(;this._i<this._tasks.length;){if(f=Date.now(),this._tasks[this._i]()||this._i++,f=Math.max(1,Date.now()-f),i=Math.max(f,i),r=p.timeRemaining(),1.5*i>r)return e-f<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(e-f))}ms`),void this._start();e=r}this.clear()}}class n extends u{_requestCallback(p){return setTimeout(()=>p(this._createDeadline(16)))}_cancelCallback(p){clearTimeout(p)}_createDeadline(p){let f=Date.now()+p;return{timeRemaining:()=>Math.max(0,f-Date.now())}}}t.PriorityTaskQueue=n,t.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends u{_requestCallback(_){return requestIdleCallback(_)}_cancelCallback(_){cancelIdleCallback(_)}}:n,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(_){this._queue.clear(),this._queue.enqueue(_)}flush(){this._queue.flush()}}},147:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(n){return[n>>>16&255,n>>>8&255,255&n]}static fromColorRGB(n){return(255&n[0])<<16|(255&n[1])<<8|255&n[2]}clone(){let n=new a;return n.fg=this.fg,n.bg=this.bg,n.extended=this.extended.clone(),n}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}t.AttributeData=a;class h{constructor(n=0,_=0){this._ext=0,this._urlId=0,this._ext=n,this._urlId=_}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(n){this._ext=n}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(n){this._ext&=-469762049,this._ext|=n<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(n){this._ext&=-67108864,this._ext|=67108863&n}get urlId(){return this._urlId}set urlId(n){this._urlId=n}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}t.ExtendedAttrs=h},782:(k,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;let h=a(133),u=a(855),n=a(147);class _ extends n.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new n.ExtendedAttrs,this.combinedData=""}static fromCharData(f){let i=new _;return i.setFromCharData(f),i}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(f){this.fg=f[u.CHAR_DATA_ATTR_INDEX],this.bg=0;let i=!1;if(f[u.CHAR_DATA_CHAR_INDEX].length>2)i=!0;else if(f[u.CHAR_DATA_CHAR_INDEX].length===2){let e=f[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=e&&e<=56319){let r=f[u.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(e-55296)+r-56320+65536|f[u.CHAR_DATA_WIDTH_INDEX]<<22:i=!0}else i=!0}else this.content=f[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|f[u.CHAR_DATA_WIDTH_INDEX]<<22;i&&(this.combinedData=f[u.CHAR_DATA_CHAR_INDEX],this.content=2097152|f[u.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=_},855:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},133:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},t.utf32ToString=function(a,h=0,u=a.length){let n="";for(let _=h;_<u;++_){let p=a[_];p>65535?(p-=65536,n+=String.fromCharCode(55296+(p>>10))+String.fromCharCode(p%1024+56320)):n+=String.fromCharCode(p)}return n},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,h){let u=a.length;if(!u)return 0;let n=0,_=0;if(this._interim){let p=a.charCodeAt(_++);56320<=p&&p<=57343?h[n++]=1024*(this._interim-55296)+p-56320+65536:(h[n++]=this._interim,h[n++]=p),this._interim=0}for(let p=_;p<u;++p){let f=a.charCodeAt(p);if(55296<=f&&f<=56319){if(++p>=u)return this._interim=f,n;let i=a.charCodeAt(p);56320<=i&&i<=57343?h[n++]=1024*(f-55296)+i-56320+65536:(h[n++]=f,h[n++]=i)}else f!==65279&&(h[n++]=f)}return n}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,h){let u=a.length;if(!u)return 0;let n,_,p,f,i=0,e=0,r=0;if(this.interim[0]){let d=!1,g=this.interim[0];g&=(224&g)==192?31:(240&g)==224?15:7;let v,m=0;for(;(v=63&this.interim[++m])&&m<4;)g<<=6,g|=v;let c=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,l=c-m;for(;r<l;){if(r>=u)return 0;if(v=a[r++],(192&v)!=128){r--,d=!0;break}this.interim[m++]=v,g<<=6,g|=63&v}d||(c===2?g<128?r--:h[i++]=g:c===3?g<2048||g>=55296&&g<=57343||g===65279||(h[i++]=g):g<65536||g>1114111||(h[i++]=g)),this.interim.fill(0)}let o=u-4,s=r;for(;s<u;){for(;!(!(s<o)||128&(n=a[s])||128&(_=a[s+1])||128&(p=a[s+2])||128&(f=a[s+3]));)h[i++]=n,h[i++]=_,h[i++]=p,h[i++]=f,s+=4;if(n=a[s++],n<128)h[i++]=n;else if((224&n)==192){if(s>=u)return this.interim[0]=n,i;if(_=a[s++],(192&_)!=128){s--;continue}if(e=(31&n)<<6|63&_,e<128){s--;continue}h[i++]=e}else if((240&n)==224){if(s>=u)return this.interim[0]=n,i;if(_=a[s++],(192&_)!=128){s--;continue}if(s>=u)return this.interim[0]=n,this.interim[1]=_,i;if(p=a[s++],(192&p)!=128){s--;continue}if(e=(15&n)<<12|(63&_)<<6|63&p,e<2048||e>=55296&&e<=57343||e===65279)continue;h[i++]=e}else if((248&n)==240){if(s>=u)return this.interim[0]=n,i;if(_=a[s++],(192&_)!=128){s--;continue}if(s>=u)return this.interim[0]=n,this.interim[1]=_,i;if(p=a[s++],(192&p)!=128){s--;continue}if(s>=u)return this.interim[0]=n,this.interim[1]=_,this.interim[2]=p,i;if(f=a[s++],(192&f)!=128){s--;continue}if(e=(7&n)<<18|(63&_)<<12|(63&p)<<6|63&f,e<65536||e>1114111)continue;h[i++]=e}}return i}}}},M={};function P(k){var t=M[k];if(t!==void 0)return t.exports;var a=M[k]={exports:{}};return q[k](a,a.exports,P),a.exports}var W={};return(()=>{var k=W;Object.defineProperty(k,"__esModule",{value:!0}),k.WebglAddon=void 0;let t=P(345),a=P(859),h=P(399),u=P(666);class n extends a.Disposable{constructor(p){if(h.isSafari&&(0,h.getSafariVersion)()<16)throw new Error("Webgl2 is only supported on Safari 16 and above");super(),this._preserveDrawingBuffer=p,this._onChangeTextureAtlas=this.register(new t.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new t.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new t.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onContextLoss=this.register(new t.EventEmitter),this.onContextLoss=this._onContextLoss.event}activate(p){let f=p._core;if(!p.element)return void this.register(f.onWillOpen(()=>this.activate(p)));this._terminal=p;let i=f.coreService,e=f.optionsService,r=f,o=r._renderService,s=r._characterJoinerService,d=r._charSizeService,g=r._coreBrowserService,v=r._decorationService,m=r._themeService;this._renderer=this.register(new u.WebglRenderer(p,s,d,g,i,v,e,m,this._preserveDrawingBuffer)),this.register((0,t.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,t.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,t.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,t.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),o.setRenderer(this._renderer),this.register((0,a.toDisposable)(()=>{let c=this._terminal._core._renderService;c.setRenderer(this._terminal._core._createRenderer()),c.handleResize(p.cols,p.rows)}))}get textureAtlas(){var p;return(p=this._renderer)===null||p===void 0?void 0:p.textureAtlas}clearTextureAtlas(){var p;(p=this._renderer)===null||p===void 0||p.clearTextureAtlas()}}k.WebglAddon=n})(),W})()})});var Fe=ce((be,Ae)=>{(function(q,M){typeof be=="object"&&typeof Ae=="object"?Ae.exports=M():typeof define=="function"&&define.amd?define([],M):typeof be=="object"?be.WebLinksAddon=M():q.WebLinksAddon=M()})(self,function(){return(()=>{"use strict";var q={6:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkComputer=t.WebLinkProvider=void 0,t.WebLinkProvider=class{constructor(h,u,n,_={}){this._terminal=h,this._regex=u,this._handler=n,this._options=_}provideLinks(h,u){let n=a.computeLink(h,this._regex,this._terminal,this._handler);u(this._addCallbacks(n))}_addCallbacks(h){return h.map(u=>(u.leave=this._options.leave,u.hover=(n,_)=>{if(this._options.hover){let{range:p}=u;this._options.hover(n,_,p)}},u))}};class a{static computeLink(u,n,_,p){let f=new RegExp(n.source,(n.flags||"")+"g"),[i,e]=a._getWindowedLineStrings(u-1,_),r=i.join(""),o,s=[];for(;o=f.exec(r);){let d=o[0];try{let S=new URL(d),b=decodeURI(S.toString());if(d!==b&&d+"/"!==b)continue}catch{continue}let[g,v]=a._mapStrIdx(_,e,0,o.index),[m,c]=a._mapStrIdx(_,g,v,d.length);if(g===-1||v===-1||m===-1||c===-1)continue;let l={start:{x:v+1,y:g+1},end:{x:c,y:m+1}};s.push({range:l,text:d,activate:p})}return s}static _getWindowedLineStrings(u,n){let _,p=u,f=u,i=0,e="",r=[];if(_=n.buffer.active.getLine(u)){let o=_.translateToString(!0);if(_.isWrapped&&o[0]!==" "){for(i=0;(_=n.buffer.active.getLine(--p))&&i<2048&&(e=_.translateToString(!0),i+=e.length,r.push(e),_.isWrapped&&e.indexOf(" ")===-1););r.reverse()}for(r.push(o),i=0;(_=n.buffer.active.getLine(++f))&&_.isWrapped&&i<2048&&(e=_.translateToString(!0),i+=e.length,r.push(e),e.indexOf(" ")===-1););}return[r,p]}static _mapStrIdx(u,n,_,p){let f=u.buffer.active,i=f.getNullCell(),e=_;for(;p;){let r=f.getLine(n);if(!r)return[-1,-1];for(let o=e;o<r.length;++o){r.getCell(o,i);let s=i.getChars();if(i.getWidth()&&(p-=s.length||1,o===r.length-1&&s==="")){let d=f.getLine(n+1);d&&d.isWrapped&&(d.getCell(0,i),i.getWidth()===2&&(p+=1))}if(p<0)return[n,o]}n++,e=0}return[n,e]}}t.LinkComputer=a}},M={};function P(k){var t=M[k];if(t!==void 0)return t.exports;var a=M[k]={exports:{}};return q[k](a,a.exports,P),a.exports}var W={};return(()=>{var k=W;Object.defineProperty(k,"__esModule",{value:!0}),k.WebLinksAddon=void 0;let t=P(6),a=/https?:[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function h(u,n){let _=window.open();if(_){try{_.opener=null}catch{}_.location.href=n}else console.warn("Opening link blocked as opener could not be cleared")}k.WebLinksAddon=class{constructor(u=h,n={}){this._handler=u,this._options=n}activate(u){this._terminal=u;let n=this._options,_=n.urlRegex||a;this._linkProvider=this._terminal.registerLinkProvider(new t.WebLinkProvider(this._terminal,_,this._handler,n))}dispose(){var u;(u=this._linkProvider)===null||u===void 0||u.dispose()}}})(),W})()})});var He=ce((fe,Re)=>{(function(q,M){typeof fe=="object"&&typeof Re=="object"?Re.exports=M():typeof define=="function"&&define.amd?define([],M):typeof fe=="object"?fe.Unicode11Addon=M():q.Unicode11Addon=M()})(fe,function(){return(()=>{"use strict";var q={433:(k,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV11=void 0;let a=[[768,879],[1155,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1541],[1552,1562],[1564,1564],[1611,1631],[1648,1648],[1750,1757],[1759,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2045,2045],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2259,2306],[2362,2362],[2364,2364],[2369,2376],[2381,2381],[2385,2391],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2558,2558],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2641,2641],[2672,2673],[2677,2677],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2810,2815],[2817,2817],[2876,2876],[2879,2879],[2881,2884],[2893,2893],[2902,2902],[2914,2915],[2946,2946],[3008,3008],[3021,3021],[3072,3072],[3076,3076],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3201],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],[3405,3405],[3426,3427],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],[4226,4226],[4229,4230],[4237,4237],[4253,4253],[4448,4607],[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6158],[6277,6278],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6683,6683],[6742,6742],[6744,6750],[6752,6752],[6754,6754],[6757,6764],[6771,6780],[6783,6783],[6832,6846],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],[7142,7142],[7144,7145],[7149,7149],[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],[7405,7405],[7412,7412],[7416,7417],[7616,7673],[7675,7679],[8203,8207],[8234,8238],[8288,8292],[8294,8303],[8400,8432],[11503,11505],[11647,11647],[11744,11775],[12330,12333],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],[43010,43010],[43014,43014],[43019,43019],[43045,43046],[43204,43205],[43232,43249],[43263,43263],[43302,43309],[43335,43345],[43392,43394],[43443,43443],[43446,43449],[43452,43453],[43493,43493],[43561,43566],[43569,43570],[43573,43574],[43587,43587],[43596,43596],[43644,43644],[43696,43696],[43698,43700],[43703,43704],[43710,43711],[43713,43713],[43756,43757],[43766,43766],[44005,44005],[44008,44008],[44013,44013],[64286,64286],[65024,65039],[65056,65071],[65279,65279],[65529,65531]],h=[[66045,66045],[66272,66272],[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[68325,68326],[68900,68903],[69446,69456],[69633,69633],[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69821,69821],[69837,69837],[69888,69890],[69927,69931],[69933,69940],[70003,70003],[70016,70017],[70070,70078],[70089,70092],[70191,70193],[70196,70196],[70198,70199],[70206,70206],[70367,70367],[70371,70378],[70400,70401],[70459,70460],[70464,70464],[70502,70508],[70512,70516],[70712,70719],[70722,70724],[70726,70726],[70750,70750],[70835,70840],[70842,70842],[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],[71229,71229],[71231,71232],[71339,71339],[71341,71341],[71344,71349],[71351,71351],[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[72148,72151],[72154,72155],[72160,72160],[72193,72202],[72243,72248],[72251,72254],[72263,72263],[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],[72767,72767],[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],[73018,73018],[73020,73021],[73023,73029],[73031,73031],[73104,73105],[73109,73109],[73111,73111],[73459,73460],[78896,78904],[92912,92916],[92976,92982],[94031,94031],[94095,94098],[113821,113822],[113824,113827],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],[121461,121461],[121476,121476],[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[123184,123190],[123628,123631],[125136,125142],[125252,125258],[917505,917505],[917536,917631],[917760,917999]],u=[[4352,4447],[8986,8987],[9001,9002],[9193,9196],[9200,9200],[9203,9203],[9725,9726],[9748,9749],[9800,9811],[9855,9855],[9875,9875],[9889,9889],[9898,9899],[9917,9918],[9924,9925],[9934,9934],[9940,9940],[9962,9962],[9970,9971],[9973,9973],[9978,9978],[9981,9981],[9989,9989],[9994,9995],[10024,10024],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10133,10135],[10160,10160],[10175,10175],[11035,11036],[11088,11088],[11093,11093],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12288,12329],[12334,12350],[12353,12438],[12443,12543],[12549,12591],[12593,12686],[12688,12730],[12736,12771],[12784,12830],[12832,12871],[12880,19903],[19968,42124],[42128,42182],[43360,43388],[44032,55203],[63744,64255],[65040,65049],[65072,65106],[65108,65126],[65128,65131],[65281,65376],[65504,65510]],n=[[94176,94179],[94208,100343],[100352,101106],[110592,110878],[110928,110930],[110948,110951],[110960,111355],[126980,126980],[127183,127183],[127374,127374],[127377,127386],[127488,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],[127988,127988],[127992,128062],[128064,128064],[128066,128252],[128255,128317],[128331,128334],[128336,128359],[128378,128378],[128405,128406],[128420,128420],[128507,128591],[128640,128709],[128716,128716],[128720,128722],[128725,128725],[128747,128748],[128756,128762],[128992,129003],[129293,129393],[129395,129398],[129402,129442],[129445,129450],[129454,129482],[129485,129535],[129648,129651],[129656,129658],[129664,129666],[129680,129685],[131072,196605],[196608,262141]],_;function p(f,i){let e,r=0,o=i.length-1;if(f<i[0][0]||f>i[o][1])return!1;for(;o>=r;)if(e=r+o>>1,f>i[e][1])r=e+1;else{if(!(f<i[e][0]))return!0;o=e-1}return!1}t.UnicodeV11=class{constructor(){if(this.version="11",!_){_=new Uint8Array(65536),_.fill(1),_[0]=0,_.fill(0,1,32),_.fill(0,127,160);for(let f=0;f<a.length;++f)_.fill(0,a[f][0],a[f][1]+1);for(let f=0;f<u.length;++f)_.fill(2,u[f][0],u[f][1]+1)}}wcwidth(f){return f<32?0:f<127?1:f<65536?_[f]:p(f,h)?0:p(f,n)?2:1}}}},M={};function P(k){var t=M[k];if(t!==void 0)return t.exports;var a=M[k]={exports:{}};return q[k](a,a.exports,P),a.exports}var W={};return(()=>{var k=W;Object.defineProperty(k,"__esModule",{value:!0}),k.Unicode11Addon=void 0;let t=P(433);k.Unicode11Addon=class{activate(a){a.unicode.register(new t.UnicodeV11)}dispose(){}}})(),W})()})});var $e=ce((we,ke)=>{(function(q,M){typeof we=="object"&&typeof ke=="object"?ke.exports=M():typeof define=="function"&&define.amd?define([],M):typeof we=="object"?we.AttachAddon=M():q.AttachAddon=M()})(self,function(){return(()=>{"use strict";var q={};return(()=>{var M=q;function P(W,k,t){return W.addEventListener(k,t),{dispose:()=>{t&&W.removeEventListener(k,t)}}}Object.defineProperty(M,"__esModule",{value:!0}),M.AttachAddon=void 0,M.AttachAddon=class{constructor(W,k){this._disposables=[],this._socket=W,this._socket.binaryType="arraybuffer",this._bidirectional=!(k&&k.bidirectional===!1)}activate(W){this._disposables.push(P(this._socket,"message",k=>{let t=k.data;W.write(typeof t=="string"?t:new Uint8Array(t))})),this._bidirectional&&(this._disposables.push(W.onData(k=>this._sendData(k))),this._disposables.push(W.onBinary(k=>this._sendBinary(k)))),this._disposables.push(P(this._socket,"close",()=>this.dispose())),this._disposables.push(P(this._socket,"error",()=>this.dispose()))}dispose(){for(let W of this._disposables)W.dispose()}_sendData(W){this._checkOpenSocket()&&this._socket.send(W)}_sendBinary(W){if(!this._checkOpenSocket())return;let k=new Uint8Array(W.length);for(let t=0;t<W.length;++t)k[t]=255&W.charCodeAt(t);this._socket.send(k)}_checkOpenSocket(){switch(this._socket.readyState){case WebSocket.OPEN:return!0;case WebSocket.CONNECTING:throw new Error("Attach addon was loaded before socket was open");case WebSocket.CLOSING:return console.warn("Attach addon socket is closing"),!1;case WebSocket.CLOSED:throw new Error("Attach addon socket is closed");default:throw new Error("Unexpected socket state")}}}})(),q})()})});var le={id:"bajrangcoder.acodex",name:"AcodeX - Terminal",main:"dist/main.js",version:"2.3.0",readme:"readme.md",icon:"icon.png",files:[],minVersionCode:290,author:{name:"Raunak Raj",email:"bajrangcoders@gmail.com",github:"bajrangCoder"}};var ee={snazzy:{background:"#282A36",foreground:"#EFF0EB",cursor:"#EFF0EB",black:"#0C0D13",red:"#FF5C57",green:"#5AF78E",yellow:"#F3F99D",blue:"#57C7FF",magenta:"#FF6AC1",cyan:"#9AEDFE",white:"#EFF0EB",brightBlack:"#686868",brightRed:"#FF5C57",brightGreen:"#5AF78E",brightYellow:"#F3F99D",brightBlue:"#57C7FF",brightMagenta:"#FF6AC1",brightCyan:"#9AEDFE",brightWhite:"#EFF0EB"},xterm:{foreground:"#F8F8F8",background:"#2D2E2C",selectionBackground:"#5DA5D533",black:"#1E1E1D",brightBlack:"#262625",red:"#CE5C5C",brightRed:"#FF7272",green:"#5BCC5B",brightGreen:"#72FF72",yellow:"#CCCC5B",brightYellow:"#FFFF72",blue:"#5D5DD3",brightBlue:"#7279FF",magenta:"#BC5ED1",brightMagenta:"#E572FF",cyan:"#5DA5D5",brightCyan:"#72F0FF",white:"#F8F8F8",brightWhite:"#FFFFFF"},sapphire:{background:"#1c2431",foreground:"#cccccc",selectionBackground:"#399ef440",black:"#666666",blue:"#399ef4",brightBlack:"#666666",brightBlue:"#399ef4",brightCyan:"#21c5c7",brightGreen:"#4eb071",brightMagenta:"#b168df",brightRed:"#da6771",brightWhite:"#efefef",brightYellow:"#fff099",cyan:"#21c5c7",green:"#4eb071",magenta:"#b168df",red:"#da6771",white:"#efefef",yellow:"#fff099"},light:{background:"#ffffff",foreground:"#333333",cursor:"#333333",cursorAccent:"#ffffff",selectionBackground:"#add6ff",black:"#000000",blue:"#0451a5",brightBlack:"#666666",brightBlue:"#0451a5",brightCyan:"#0598bc",brightGreen:"#14ce14",brightMagenta:"#bc05bc",brightRed:"#cd3131",brightWhite:"#a5a5a5",brightYellow:"#b5ba00",cyan:"#0598bc",green:"#00bc00",magenta:"#bc05bc",red:"#cd3131",white:"#555555",yellow:"#949800"},custom:{background:"#1c2431",foreground:"#cccccc",cursor:"#ffffff",cursorAccent:"#fff",selectionBackground:"#399ef440",black:"#666666",blue:"#399ef4",brightBlack:"#666666",brightBlue:"#399ef4",brightCyan:"#21c5c7",brightGreen:"#4eb071",brightMagenta:"#b168df",brightRed:"#da6771",brightWhite:"#efefef",brightYellow:"#fff099",cyan:"#21c5c7",green:"#4eb071",magenta:"#b168df",red:"#da6771",white:"#efefef",yellow:"#fff099"},ayuDark:{background:"#090D13",foreground:"#FEFEFE",cursor:"#E96B72",black:"#00050D",red:"#E96B72",green:"#90B261",yellow:"#F8AE4E",blue:"#52BCF9",magenta:"#F9E893",cyan:"#8FE0C5",white:"#C6C6C6",brightBlack:"#676767",brightRed:"#EF7077",brightGreen:"#C1D84B",brightYellow:"#FEB353",brightBlue:"#58C1FE",brightMagenta:"#FEED98",brightCyan:"#94E5CA",brightWhite:"#FEFEFE"},catppuccin:{background:"#1E1D2F",foreground:"#D9E0EE",cursor:"#D9E0EE",black:"#6E6C7E",red:"#F28FAD",green:"#ABE9B3",yellow:"#FAE3B0",blue:"#96CDFB",magenta:"#F5C2E7",cyan:"#89DCEB",white:"#C3BAC6",brightBlack:"#988BA2",brightRed:"#F28FAD",brightGreen:"#ABE9B3",brightYellow:"#FAE3B0",brightBlue:"#96CDFB",brightMagenta:"#F5C2E7",brightCyan:"#89DCEB",brightWhite:"#D9E0EE"},oneDark:{background:"#1E2127",foreground:"#5C6370",cursor:"#5C6370",black:"#000000",red:"#E06C75",green:"#98C379",yellow:"#D19A66",blue:"#61AFEF",magenta:"#C678DD",cyan:"#56B6C2",white:"#ABB2BF",brightBlack:"#5C6370",brightRed:"#E06C75",brightGreen:"#98C379",brightYellow:"#D19A66",brightBlue:"#61AFEF",brightMagenta:"#C678DD",brightCyan:"#56B6C2",brightWhite:"#FFFEFE"},material:{background:"#1E282C",foreground:"#C3C7D1",cursor:"#657B83",black:"#073641",red:"#EB606B",green:"#C3E88D",yellow:"#F7EB95",blue:"#80CBC3",magenta:"#FF2490",cyan:"#AEDDFF",white:"#FFFFFF",brightBlack:"#002B36",brightRed:"#EB606B",brightGreen:"#C3E88D",brightYellow:"#F7EB95",brightBlue:"#7DC6BF",brightMagenta:"#6C71C3",brightCyan:"#34434D",brightWhite:"#FFFFFF"},nekonakoDjancoeg:{background:"#2a2c3a",foreground:"#eeeeee",cursor:"#fd6b85",black:"#2f343f",red:"#fd6b85",green:"#63e0be",yellow:"#fed270",blue:"#67d4f2",magenta:"#ff8167",cyan:"#63e0be",white:"#eeeeee",brightBlack:"#4f4f5b",brightRed:"#fd6b85",brightGreen:"#63e0be",brightYellow:"#fed270",brightBlue:"#67d4f2",brightMagenta:"#ff8167",brightCyan:"#63e0be",brightWhite:"#eeeeee"},dracula:{background:"#282a36",foreground:"#94A3A5",cursor:"#94A3A5",black:"#44475a",red:"#ff5555",green:"#50fa7b",yellow:"#ffb86c",blue:"#8be9fd",magenta:"#bd93f9",cyan:"#ff79c6",white:"#94A3A5",brightBlack:"#000000",brightRed:"#ff5555",brightGreen:"#50fa7b",brightYellow:"#ffb86c",brightBlue:"#8be9fd",brightMagenta:"#bd93f9",brightCyan:"#ff79c6",brightWhite:"#ffffff"},ayuMirage:{background:"#1F2430",foreground:"#E5E0CE",cursor:"#E96B72",black:"#00050D",red:"#E96B72",green:"#90B261",yellow:"#F8AE4E",blue:"#52BCF9",magenta:"#F9E893",cyan:"#8FE0C5",white:"#C6C6C6",brightBlack:"#676767",brightRed:"#EF7077",brightGreen:"#C1D84B",brightYellow:"#FEB353",brightBlue:"#58C1FE",brightMagenta:"#FEED98",brightCyan:"#94E5CA",brightWhite:"#FEFEFE"},siduckOneDark:{background:"#1e222a",foreground:"#c8ccd4",cursor:"#e06c75",black:"#1e222a",red:"#e06c75",green:"#98c379",yellow:"#e5c07b",blue:"#61afef",magenta:"#c678dd",cyan:"#56b6c2",white:"#D8DEE9",brightBlack:"#545862",brightRed:"#e06c75",brightGreen:"#98c379",brightYellow:"#e5c07b",brightBlue:"#61afef",brightMagenta:"#c678dd",brightCyan:"#56b6c2",brightWhite:"#c8ccd4"},elementary:{background:"#101010",foreground:"#f2f2f2",cursor:"#f2f2f2",black:"#303030",red:"#e1321a",green:"#6ab017",yellow:"#ffc005",blue:"#004f9e",magenta:"#ec0048",cyan:"#2aa7e7",white:"#f2f2f2",brightBlack:"#5d5d5d",brightRed:"#ff361e",brightGreen:"#7bc91f",brightYellow:"#ffd00a",brightBlue:"#0071ff",brightMagenta:"#ff1d62",brightCyan:"#4bb8fd",brightWhite:"#a020f0"},ayuLight:{background:"#FEFEFE",foreground:"#090D13",cursor:"#E96B72",black:"#00050D",red:"#E96B72",green:"#90B261",yellow:"#F8AE4E",blue:"#52BCF9",magenta:"#F9E893",cyan:"#8FE0C5",white:"#c6c6c694",brightBlack:"#676767",brightRed:"#EF7077",brightGreen:"#C1D84B",brightYellow:"#FEB353",brightBlue:"#58C1FE",brightMagenta:"#FEED98",brightCyan:"#94E5CA",brightWhite:"#dacaca"},everblush:{name:"Everblush",background:"#141b1e",foreground:"#dadada",cursor:"#3b4244",black:"#232a2d",red:"#e57474",green:"#8ccf7e",yellow:"#e5c76b",blue:"#67b0e8",magenta:"#c47fd5",cyan:"#6cbfbf",white:"#b3b9b8",brightBlack:"#2d3437",brightRed:"#ef7e7e",brightGreen:"#96d988",brightYellow:"#f4d67a",brightBlue:"#71baf2",brightMagenta:"#ce89df",brightCyan:"#67cbe7",brightWhite:"#bdc3c2"}};var Ne=de(Oe()),We=de(Ie()),Ue=de(Pe()),ze=de(Fe()),je=de(He()),qe=de($e()),Ai=acode.require("alert"),Qe=acode.require("confirm"),Ri=acode.require("prompt"),ne=acode.require("settings"),ki=acode.require("helpers"),Di=acode.require("fsOperation"),et=acode.require("toInternalUrl"),tt=acode.require("select"),{editor:Ti}=editorManager,De=class{isDragging=!1;startY;startHeight;isFlotBtnDragging=!1;btnStartPosX;btnStartPosY;isTerminalMinimized=!1;isTerminalOpened=!1;previousTerminalHeight;pid;terminal=null;socket=null;$fitAddon=void 0;ALLOW_TRANSPRANCY=!1;CURSOR_BLINK=!0;SHOW_ARROW_BTN=!1;CURSOR_STYLE=["block","underline","bar"];FONT_SIZE=10;FONT_FAMILY=ne.get("editorFont");SCROLLBACK=1e3;SCROLL_SENSITIVITY=1e3;themeList=["ayuDark","ayuLight","ayuMirage","catppuccin","dracula","elementary","everblush","light","material","nekonakoDjancoeg","oneDark","sapphire","siduckOneDark","snazzy","xterm","custom"];constructor(){ne.value[le.id]?this.settings.port||(delete ne.value[le.id],ne.update(!1),this._saveSetting()):this._saveSetting()}async init(M,P,W){try{this.xtermCss=tag("link",{rel:"stylesheet",href:this.baseUrl+"xterm.css"}),this.$style=tag("link",{rel:"stylesheet",href:this.baseUrl+"main.css"}),this.$fontStyles=tag("link",{rel:"stylesheet",href:this.baseUrl+"fonts.css"}),this._loadCustomFontStyleSheet(),document.head.append(this.xtermCss,this.$style,this.$fontStyles),editorManager.editor.commands.addCommand({name:"acodex:open_terminal",description:"Open Terminal",bindKey:{win:"Ctrl-K"},exec:()=>{this.openTerminalPanel(270,this.settings.port)}}),editorManager.editor.commands.addCommand({name:"acodex:close_terminal",description:"Close Terminal",bindKey:{win:"Ctrl-J"},exec:this.closeTerminal.bind(this)}),this.$terminalContainer=tag("div",{className:"terminal-container"}),this.$terminalHeader=tag("div",{className:"terminal-header"}),this.$terminalTitle=tag("h3",{textContent:"AcodeX 1",className:"terminal-title"});let k=tag("div",{className:"control-btn"}),t=tag("button",{className:"add-session-btn"});t.innerHTML='<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" height="1.5em" width="1.5em"><path fill="currentColor" d="M24 38q-.65 0-1.075-.425-.425-.425-.425-1.075v-11h-11q-.65 0-1.075-.425Q10 24.65 10 24q0-.65.425-1.075.425-.425 1.075-.425h11v-11q0-.65.425-1.075Q23.35 10 24 10q.65 0 1.075.425.425.425.425 1.075v11h11q.65 0 1.075.425Q38 23.35 38 24q0 .65-.425 1.075-.425.425-1.075.425h-11v11q0 .65-.425 1.075Q24.65 38 24 38Z"/></svg>',this.$cdBtn=tag("button",{className:"cd-btn"}),this.$cdBtn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-folder2-open" viewBox="0 0 16 16"><path d="M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v.64c.57.265.94.876.856 1.546l-.64 5.124A2.5 2.5 0 0 1 12.733 15H3.266a2.5 2.5 0 0 1-2.481-2.19l-.64-5.124A1.5 1.5 0 0 1 1 6.14V3.5zM2 6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5a.5.5 0 0 0-.5.5V6zm-.367 1a.5.5 0 0 0-.496.562l.64 5.124A1.5 1.5 0 0 0 3.266 14h9.468a1.5 1.5 0 0 0 1.489-1.314l.64-5.124A.5.5 0 0 0 14.367 7H1.633z"/></svg>',this.$hideTermBtn=tag("button",{className:"hide-terminal-btn"}),this.$hideTermBtn.innerHTML='<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" height="1.5em" width="1.5em"><path fill="currentColor" d="M15.5 25.5q-.65 0-1.075-.425Q14 24.65 14 24q0-.65.425-1.075.425-.425 1.075-.425h17q.65 0 1.075.425Q34 23.35 34 24q0 .65-.425 1.075-.425.425-1.075.425Z"/></svg>',this.$closeTermBtn=tag("button",{className:"close-terminal-btn"}),this.$closeTermBtn.innerHTML='<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" height="1.5em" width="1.5em"><path fill="currentColor" d="M24 26.1 13.5 36.6q-.45.45-1.05.45-.6 0-1.05-.45-.45-.45-.45-1.05 0-.6.45-1.05L21.9 24 11.4 13.5q-.45-.45-.45-1.05 0-.6.45-1.05.45-.45 1.05-.45.6 0 1.05.45L24 21.9l10.5-10.5q.45-.45 1.05-.45.6 0 1.05.45.45.45.45 1.05 0 .6-.45 1.05L26.1 24l10.5 10.5q.45.45.45 1.05 0 .6-.45 1.05-.45.45-1.05.45-.6 0-1.05-.45Z"/></svg>',k.append(t,this.$cdBtn,this.$hideTermBtn,this.$closeTermBtn),this.$terminalHeader.append(this.$terminalTitle,k),this.$terminalContent=tag("div",{className:"terminal-content"}),this.$terminalContainer.append(this.$terminalHeader,this.$terminalContent),this.$showTermBtn=tag("button",{className:"show-terminal-btn"}),this.$showTermBtn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-terminal" viewBox="0 0 16 16"><path d="M6 9a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 6 9zM3.854 4.146a.5.5 0 1 0-.708.708L4.793 6.5 3.146 8.146a.5.5 0 1 0 .708.708l2-2a.5.5 0 0 0 0-.708l-2-2z"/><path d="M2 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2zm12 1a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h12z"/></svg>',app.get("main")&&app.get("main").append(this.$terminalContainer,this.$showTermBtn),this.$showTermBtn.classList.add("hide"),this.$terminalContainer.classList.add("hide"),this.$cacheFile=P,this.$terminalHeader.addEventListener("mousedown",this.startDragging.bind(this)),this.$terminalHeader.addEventListener("touchstart",this.startDragging.bind(this)),t.addEventListener("click",this.createSession.bind(this)),this.$terminalTitle.addEventListener("click",async a=>{let h,u=await this.$cacheFile.readFile("utf8"),n=JSON.parse(u);Array.isArray(n)?h=n.map(f=>f.name):h=[];let _={hideOnSelect:!0,default:localStorage.getItem("AcodeX_Current_Session")},p=await tt("AcodeX Sessions",h,_);p&&this.changeSession(p)}),this.$closeTermBtn.addEventListener("click",this.closeTerminal.bind(this)),this.$hideTermBtn.addEventListener("click",this.minimise.bind(this)),this.$cdBtn.addEventListener("click",this._cdToActiveDir.bind(this)),this.$showTermBtn.addEventListener("mousedown",this.startDraggingFlotingBtn.bind(this)),document.addEventListener("mousemove",this.dragFlotButton.bind(this)),document.addEventListener("mouseup",this.stopDraggingFlotBtn.bind(this)),this.$showTermBtn.addEventListener("touchstart",this.startDraggingFlotingBtn.bind(this)),document.addEventListener("touchmove",this.dragFlotButton.bind(this)),document.addEventListener("touchend",this.stopDraggingFlotBtn.bind(this)),this.$showTermBtn.addEventListener("click",this.maxmise.bind(this)),window.addEventListener("mousemove",this.drag.bind(this)),window.addEventListener("touchmove",this.drag.bind(this)),window.addEventListener("mouseup",this.stopDragging.bind(this)),window.addEventListener("touchend",this.stopDragging.bind(this)),window.addEventListener("resize",()=>{if(!this.$terminalContainer.classList.contains("hide")||this.$terminalContainer.style.height!="0px"){let a=document.querySelector("#root header").offsetHeight+document.querySelector("#root ul").offsetHeight,h=document.querySelector("#quick-tools").offsetHeight,u=window.innerHeight-(a+h),n=parseInt(this.$terminalContainer.style.height),_=Math.min(n,u);this.$terminalContainer.style.height=_+"px",localStorage.getItem("AcodeX_Is_Opened")==="true"&&this.$fitAddon!==void 0&&this._updateTerminalHeight(),localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight)}if(!this.$showTermBtn.classList.contains("hide")){let a=document.querySelector("#root header").offsetHeight+document.querySelector("#root ul").offsetHeight,h=window.innerHeight-a-this.$showTermBtn.offsetHeight,u=parseInt(this.$showTermBtn.style.bottom);this.$showTermBtn.style.bottom=Math.max(0,Math.min(h,u))+"px"}}),localStorage.getItem("AcodeX_Is_Opened")==="true"&&localStorage.getItem("AcodeX_Current_Session")&&await this.openTerminalPanel(localStorage.getItem("AcodeX_Terminal_Cont_Height")||270,this.settings.port),acode.define("acodex",{execute:a=>{try{if(!this.isTerminalOpened)return;this.socket.send(a+"\r")}catch(h){throw Error(h)}},isMinimized:()=>this.isTerminalMinimized,isTerminalOpened:()=>this.isTerminalOpened,maximiseTerminal:()=>{this.isTerminalOpened&&this.isTerminalMinimized&&this.maxmise()},openTerminal:(a=270,h=this.settings.port)=>{this.isTerminalOpened||this.createTerminal(a,h)},createSession:()=>{this.isTerminalOpened&&this.createSession()},closeTerminal:()=>{this.isTerminalOpened&&this.closeTerminal()},convertAcodeUriToTermReadable:a=>this._convertPath(a),addTheme:(a,h)=>{this.themeList.push(a),ee[a]=h},applyTheme:a=>{this.settings.theme=a,ne.update()}})}catch(k){console.log(k)}}async openTerminalPanel(M,P){P&&(document.querySelector(".terminal-container")||app.get("main").append(this.$terminalContainer,this.$showTermBtn),this.settings.port=P,ne.update(!1),this.$terminalContainer.classList.remove("hide"),this.isTerminalOpened=!0,this.$terminalContainer.style.height=M+"px",this.$terminalContent.style.width="100%",this.$terminalContent.style.height=`calc(100% - ${this.$terminalContainer.offsetHeight}px)`,this.settings.transparency?(this.$terminalContainer.style.background="transparent",this.$terminalContainer.style.backdropFilter=`blur(${this.settings.blurValue})`,this.$terminalHeader.style.background="transparent",this.$terminalHeader.style.backdropFilter=`blur(${this.settings.blurValue})`):(this.$terminalContainer.style.background="var(--popup-background-color)",this.$terminalHeader.style.background="var(--primary-color)"),localStorage.getItem("AcodeX_Current_Session")?this.changeSession(localStorage.getItem("AcodeX_Current_Session"),!0):(this.$terminalContent.innerHTML="",this.createSession()))}async createXtermTerminal(M){if(this.$terminal=this.terminalObj,this.$fitAddon=new We.FitAddon,this.$webglAddon=new Ue.WebglAddon,this.$unicode11Addon=new je.Unicode11Addon,this.$webLinkAddon=new ze.WebLinksAddon((P,W)=>{system.openInBrowser(W)}),this.$terminal.loadAddon(this.$fitAddon),this.$terminal.loadAddon(this.$unicode11Addon),this.$terminal.loadAddon(this.$webLinkAddon),this.$fitAddon.fit(),this.$webglAddon)try{this.$terminal.loadAddon(this.$webglAddon),this.$terminal.open(this.$terminalContent)}catch(P){window.toast("error during loading webgl addon: "+P,4e3),this.$webglAddon.dispose(),this.$webglAddon=void 0}this.$terminal.element||this.$terminal.open(this.$terminalContent),this.$terminal.focus(),this._updateTerminalHeight()}async attachSocketToXterm(M,P){this.$terminal.onResize(W=>{if(!P)return;let k=W.cols,t=W.rows,a="http://localhost:"+M+"/terminals/"+P+"/size?cols="+k+"&rows="+t;fetch(a,{method:"POST"})}),this.socket=new WebSocket(`ws://localhost:${M}/terminals/${P}`),this.socket.onopen=()=>{this.$attachAddon=new qe.AttachAddon(this.socket),this.$terminal.loadAddon(this.$attachAddon),this.$terminal.unicode.activeVersion="11",this._updateTerminalHeight(),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),localStorage.getItem("AcodeX_Terminal_Is_Minimised")==="true"&&this.minimise(),this.$terminal.focus(),this._updateTerminalHeight()},this.socket.onerror=W=>{acode.alert("AcodeX Error",JSON.stringify(W))}}async createSession(){let M,P=await this.$cacheFile.readFile("utf8"),W=P?JSON.parse(P):[];if(W.length===0){if(this.createXtermTerminal(this.settings.port),M=await this._generateProcessId(),!M)return;W=[{name:"AcodeX1",pid:M}]}else{this._hideTerminalSession();let a=`AcodeX${W.reduce((h,u)=>{let _=u.name.match(/^AcodeX(\d+)$/);if(_){let p=parseInt(_[1],10);return Math.max(h,p)}return h},0)+1}`;if(this.createXtermTerminal(this.settings.port),M=await this._generateProcessId(),!M)return;W.push({name:a,pid:M})}await Promise.all([this.$cacheFile.writeFile(W),this.attachSocketToXterm(this.settings.port,M)]),this._updateTerminalHeight(),localStorage.setItem("AcodeX_Current_Session",W[W.length-1].name),this.$terminalTitle.textContent=W[W.length-1].name,window.toast(`Created Session: ${W[W.length-1].name}`,3e3)}_hideTerminalSession(){this.$terminal.dispose(),this.$terminal=null,this.socket.close(),this.socket=null,this.$attachAddon.dispose(),this.$fitAddon.dispose(),this.$unicode11Addon.dispose(),this.$webLinkAddon.dispose(),this.$webglAddon.dispose(),this.$attachAddon=void 0,this.$fitAddon=void 0,this.$unicode11Addon=void 0,this.$webLinkAddon=void 0,this.$webglAddon=void 0,this.$terminalContent.innerHTML=""}async _generateProcessId(){try{return await(await fetch("http://localhost:"+this.settings.port+"/terminals?cols="+this.$terminal.cols+"&rows="+this.$terminal.rows,{method:"POST"})).text()}catch{this.$terminalContainer.classList.contains("hide")||this.$terminalContainer.classList.add("hide"),this.$showTermBtn.classList.contains("hide")||this.$showTermBtn.classList.add("hide"),this.isTerminalMinimized=!1,this.isTerminalOpened=!1,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),this.$terminalContainer.style.height=this.previousTerminalHeight,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),localStorage.removeItem("AcodeX_Current_Session"),window.toast("Start the acodex server in termux first!",4e3)}}async changeSession(M,P=!1){if(P){this.createXtermTerminal(this.settings.port);let W=await this._getPidBySessionName(M);if(!W)return;this.attachSocketToXterm(this.settings.port,W),localStorage.setItem("AcodeX_Current_Session",M),this.$terminalTitle.textContent=M}else{if(M===localStorage.getItem("AcodeX_Current_Session"))return;this._hideTerminalSession(),this.createXtermTerminal(this.settings.port);let W=await this._getPidBySessionName(M);if(!W)return;this.attachSocketToXterm(this.settings.port,W),localStorage.setItem("AcodeX_Current_Session",M),this.$terminalTitle.textContent=M}}async _getPidBySessionName(M){let P=await this.$cacheFile.readFile("utf8"),W=P?JSON.parse(P):[];if(Array.isArray(W)){let k=W.find(t=>t.name===M);return k?k.pid:(console.log(`Error: Session '${M}' not found in JSON file.`),null)}else return console.log("Error: Sessions data is not an array in JSON file."),null}_saveSetting(){ne.value[le.id]={port:8767,transparency:this.ALLOW_TRANSPRANCY,blurValue:"4px",cursorBlink:this.CURSOR_BLINK,cursorStyle:this.CURSOR_STYLE[0],fontSize:this.FONT_SIZE,fontFamily:this.FONT_FAMILY,customFontStyleSheet:"",scrollBack:this.SCROLLBACK,scrollSensitivity:this.SCROLL_SENSITIVITY,theme:"sapphire",background:ee.sapphire.background,foreground:ee.sapphire.foreground,cursor:ee.sapphire.cursor||"",cursorAccent:ee.sapphire.cursorAccent||"",selectionBackground:ee.sapphire.selectionBackground,black:ee.sapphire.black,blue:ee.sapphire.blue,brightBlack:ee.sapphire.brightBlack,brightBlue:ee.sapphire.brightBlue,brightCyan:ee.sapphire.brightCyan,brightGreen:ee.sapphire.brightGreen,brightMagenta:ee.sapphire.brightMagenta,brightRed:ee.sapphire.brightWhite,brightWhite:ee.sapphire.brightWhite,brightYellow:ee.sapphire.brightYellow,cyan:ee.sapphire.cyan,green:ee.sapphire.green,magenta:ee.sapphire.magenta,red:ee.sapphire.red,white:ee.sapphire.white,yellow:ee.sapphire.yellow},ne.update(!1)}_loadCustomFontStyleSheet(){if(this.settings.customFontStyleSheet!="")if(document.querySelector("#customFontAcodeXStyleSheet"))document.querySelector("#customFontAcodeXStyleSheet").href=this.settings.customFontStyleSheet;else{let M=tag("link",{href:this.settings.customFontStyleSheet,rel:"stylesheet",id:"customFontAcodeXStyleSheet"});document.head.append(M)}}_updateTerminalHeight(){let M=this.$terminalHeader.offsetHeight;this.$terminalContent.style.height=`calc(100% - ${M}px)`,this.$terminalContent.style.width="100%",localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),this.$fitAddon.fit()}async _getLastSessionName(){try{let M=await this.$cacheFile.readFile("utf8"),P=M?JSON.parse(M):[];return Array.isArray(P)&&P.length>0?P[P.length-1].name:(console.error("Error: No sessions found in JSON file or sessions data is not an array."),null)}catch(M){return console.error("Error reading or parsing JSON file:",M),null}}async closeTerminal(){if(await Qe("Warning","Are you sure ?")&&this.$terminal!=null&&localStorage.getItem("AcodeX_Current_Session")){let P=await this._getPidBySessionName(localStorage.getItem("AcodeX_Current_Session"));fetch(`http://localhost:${this.settings.port}/terminals/${P}/terminate`,{method:"POST"}).then(async W=>{if(W.ok){let k=await this.$cacheFile.readFile("utf8"),t=k?JSON.parse(k):[];if(t=t.filter(a=>a.name!==localStorage.getItem("AcodeX_Current_Session")),await this.$cacheFile.writeFile(t),t.length>0){let a=await this._getLastSessionName();this.changeSession(a)}else this._hideTerminalSession(),this.$terminalContainer.classList.contains("hide")||this.$terminalContainer.classList.add("hide"),this.$showTermBtn.classList.contains("hide")||this.$showTermBtn.classList.add("hide"),this.isTerminalMinimized=!1,this.isTerminalOpened=!1,localStorage.removeItem("AcodeX_Current_Session"),localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),this.$terminalContainer.style.height=this.previousTerminalHeight,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight)}else acode.alert("AcodeX Error",`Failed to close terminal ${this.pid}.`)}).catch(async W=>{this.$terminalContainer.classList.contains("hide")||this.$terminalContainer.classList.add("hide"),this.$showTermBtn.classList.contains("hide")||this.$showTermBtn.classList.add("hide"),this.isTerminalMinimized=!1,this.isTerminalOpened=!1,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),this.$terminalContainer.style.height=this.previousTerminalHeight,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),localStorage.removeItem("AcodeX_Current_Session"),await this.$cacheFile.writeFile(""),acode.alert("AcodeX Server","Disconnected from server because server gets closed \u{1F61E}!"),console.error(`Error while closing terminal ${this.pid}: ${W}`)})}}startDraggingFlotingBtn(M){try{this.isFlotBtnDragging=!0,this.$showTermBtn.style.border="2px solid #fff",M.type==="touchstart"?(this.btnStartPosX=M.touches[0].clientX,this.btnStartPosY=M.touches[0].clientY):(this.btnStartPosX=M.clientX,this.btnStartPosY=M.clientY)}catch(P){window.alert(P)}}dragFlotButton(M){try{if(!this.isFlotBtnDragging)return;M.preventDefault();let P,W;M.type==="touchmove"?(P=M.touches[0].clientX,W=M.touches[0].clientY):(P=M.clientX,W=M.clientY);let k=this.btnStartPosX-P,t=this.btnStartPosY-W;this.btnStartPosX=P,this.btnStartPosY=W;let a=window.innerHeight-(this.$showTermBtn.offsetTop+this.$showTermBtn.offsetHeight)+t,h=this.$showTermBtn.offsetLeft-k,u=document.querySelector("#root header").offsetHeight+document.querySelector("#root ul").offsetHeight,n=window.innerWidth-this.$showTermBtn.offsetWidth,_=window.innerHeight-u-this.$showTermBtn.offsetHeight;this.$showTermBtn.style.bottom=Math.max(0,Math.min(_,a))+"px",this.$showTermBtn.style.left=Math.max(0,Math.min(n,h))+"px"}catch(P){window.alert(P)}}stopDraggingFlotBtn(){try{this.isFlotBtnDragging=!1,this.$showTermBtn.style.border="none"}catch(M){window.alert(M)}}startDragging(M){M.type==="touchstart"?this.startY=M.touches[0].clientY:(M.preventDefault(),this.startY=M.clientY),this.startHeight=this.$terminalContainer.clientHeight,this.isDragging=!0,this.$terminalContainer.style.borderTop="2px solid var(--link-text-color)"}drag(M){if(!this.isDragging)return;M.preventDefault();let P;M.type==="touchmove"?P=M.touches[0].clientY:P=M.clientY;let W=P-this.startY,k=this.startHeight-W,t=document.querySelector("#root header").offsetHeight+document.querySelector("#root ul").offsetHeight,a=document.querySelector("#quick-tools").offsetHeight,h=window.innerHeight-(t+a);k=Math.max(100,Math.min(k,h)),this.$terminalContainer.style.height=k+"px",localStorage.setItem("AcodeX_Terminal_Cont_Height",k),this._updateTerminalHeight()}stopDragging(M){this.isDragging=!1,this.$terminalContainer.style.borderTop="1px solid var(--popup-border-color)"}minimise(){try{this.isTerminalMinimized||(this.previousTerminalHeight=window.getComputedStyle(this.$terminalContainer).height,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),this.$terminalContainer.style.height=0,this.isTerminalMinimized=!0,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),this.$showTermBtn.classList.remove("hide"))}catch(M){window.alert(M)}}maxmise(){this.isTerminalMinimized&&(parseInt(localStorage.getItem("AcodeX_Terminal_Cont_Height"))<=50?this.$terminalContainer.style.height="50px":this.$terminalContainer.style.height=localStorage.getItem("AcodeX_Terminal_Cont_Height")+"px",this.$terminalContent.style.height=`calc(100% - ${this.$terminalContainer.offsetHeight}px)`,this.$fitAddon.fit(),localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),this.$showTermBtn.classList.add("hide"),this.isTerminalMinimized=!1,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),this._updateTerminalHeight())}_convertPath(M){return M.startsWith("content://com.termux.documents/tree")?M.split("::")[1].substring(0,M.split("::")[1].lastIndexOf("/")).replace(/^\/data\/data\/com\.termux\/files\/home/,"$HOME"):M.startsWith("file:///storage/emulated/0/")?"/sdcard"+M.substr(26).replace(/\.[^/.]+$/,"").split("/").slice(0,-1).join("/")+"/":M.startsWith("content://com.android.externalstorage.documents/tree/primary")?"/sdcard/"+M.split("::primary:")[1].substring(0,M.split("::primary:")[1].lastIndexOf("/")):!1}async _cdToActiveDir(){let{activeFile:M}=editorManager,P=this._convertPath(M.uri);if(!P){window.toast("unsupported path type.",3e3);return}this.socket.send(`cd "${P}"\r`)}async destroy(){this.$style.remove(),this.xtermCss.remove(),editorManager.editor.commands.removeCommand("terminal:open_terminal"),editorManager.editor.commands.removeCommand("terminal:close_terminal"),this.$terminalContainer.remove(),this.$showTermBtn.remove(),document.removeEventListener("mousemove",this.dragFlotButton.bind(this)),document.removeEventListener("mouseup",this.stopDraggingFlotBtn.bind(this)),document.removeEventListener("touchmove",this.dragFlotButton.bind(this)),document.removeEventListener("touchend",this.stopDraggingFlotBtn.bind(this)),window.removeEventListener("mousemove",this.drag),window.removeEventListener("touchmove",this.drag),window.removeEventListener("mouseup",this.stopDragging),window.removeEventListener("touchend",this.stopDragging),localStorage.removeItem("AcodeX_Terminal_Is_Minimised"),localStorage.removeItem("AcodeX_Current_Session"),localStorage.removeItem("AcodeX_Terminal_Cont_Height"),localStorage.removeItem("AcodeX_Is_Opened")}async setCustomFontFile(){let{url:M}=await acode.fileBrowser("file","select custom font stylesheet");if(!M)return;let P=this._convertPath(M);if(P.startsWith("/sdcard"))P=P.replace("/sdcard","file:///storage/emulated/0");else if(P.startsWith("$HOME"))return;let W=M.split("/"),k=W[W.length-1];P=P+"/"+k;let t=await et(P);this.settings.customFontStyleSheet=t,ne.update()}async applyTheme(M){let P=ee[M];this.settings.theme=M,this.settings.background=P.background,this.settings.foreground=P.foreground,this.settings.cursor=P.cursor||"#fff",this.settings.cursorAccent=P.cursorAccent||"#fff",this.settings.selectionBackground=P.selectionBackground,this.settings.black=P.black,this.settings.blue=P.blue,this.settings.brightBlack=P.brightBlack,this.settings.brightBlue=P.brightBlue,this.settings.brightCyan=P.brightCyan,this.settings.brightGreen=P.brightGreen,this.settings.brightMagenta=P.brightMagenta,this.settings.brightRed=P.brightRed,this.settings.brightWhite=P.brightWhite,this.settings.brightYellow=P.brightYellow,this.settings.cyan=P.cyan,this.settings.green=P.green,this.settings.magenta=P.magenta,this.settings.red=P.red,this.settings.white=P.white,this.settings.yellow=P.yellow,ne.update()}hexToTransparentRGBA(M,P){M=M.replace("#","");let W=parseInt(M.substring(0,2),16),k=parseInt(M.substring(2,4),16),t=parseInt(M.substring(4,6),16);return`rgba(${W}, ${k}, ${t}, ${P})`}get terminalObj(){return new Ne.Terminal({allowTransparency:this.settings.transparency,allowProposedApi:!0,scrollOnUserInput:!0,cursorBlink:this.settings.cursorBlink,cursorStyle:this.settings.cursorStyle,scrollBack:this.settings.scrollBack,scrollSensitivity:this.settings.scrollSensitivity,fontSize:this.settings.fontSize,fontFamily:this.settings.fontFamily,theme:{background:this.settings.transparency?this.hexToTransparentRGBA(this.settings.background,.5):this.settings.background,foreground:this.settings.foreground,selectionBackground:this.settings.selectionBackground,cursor:this.settings.cursor,cursorAccent:this.settings.cursorAccent,black:this.settings.black,blue:this.settings.blue,brightBlack:this.settings.brightBlack,brightBlue:this.settings.brightBlue,brightCyan:this.settings.brightCyan,brightGreen:this.settings.brightGreen,brightMagenta:this.settings.brightMagenta,brightRed:this.settings.brightRed,brightWhite:this.settings.brightWhite,brightYellow:this.settings.brightYellow,cyan:this.settings.cyan,green:this.settings.green,magenta:this.settings.magenta,red:this.settings.red,white:this.settings.white,yellow:this.settings.yellow}})}async clearCache(){await this.$cacheFile.writeFile(""),window.toast("Cache cleared \u{1F525}",3e3)}get fontsList(){return[[this.FONT_FAMILY,"Default Editor Font","file file_type_font",!0],["Fira Code Bold Nerd Font","Fira Code Bold Nerd Font","file file_type_font",!0],["Fira Code Medium Nerd Font","Fira Code Medium Nerd Font","file file_type_font",!0],["JetBrains Mono Bold Nerd Font","JetBrains Mono Bold Nerd Font","file file_type_font",!0],["JetBrains Mono Medium Nerd Font","JetBrains Mono Medium Nerd Font","file file_type_font",!0],["VictorMonoNerdFont Bold","VictorMonoNerdFont Bold","file file_type_font",!0],["VictorMonoNerdFont BoldItalic","VictorMonoNerdFont BoldItalic","file file_type_font",!0],["VictorMonoNerdFont Medium","VictorMonoNerdFont Medium","file file_type_font",!0],["VictorMonoNerdFont Italic","VictorMonoNerdFont Italic","file file_type_font",!0],["SauceCodeProNerdFont Bold","SauceCodeProNerdFont Bold","file file_type_font",!0],["SauceCodeProNerdFont Medium","SauceCodeProNerdFont Medium","file file_type_font",!0],["MesloLGS NF Bold Italic","MesloLGS NF Bold Italic","file file_type_font",!0],["MesloLGS NF Bold","MesloLGS NF Bold","file file_type_font",!0],["MesloLGS NF Italic","MesloLGS NF Italic","file file_type_font",!0],["MesloLGS NF Regular","MesloLGS NF Regular","file file_type_font",!0]]}get settingsObj(){return this.settings.theme==="custom"?{list:[{key:"port",text:"Server Port",value:this.settings.port,info:"Port which is displayed on termux when starting the server",prompt:"Server Port",promptType:"number",promptOption:[{required:!0}]},{key:"blurValue",text:"Blur Value(in px)",value:this.settings.blurValue,info:"Blur value for terminal in transparent mode",prompt:"Blur Value",promptType:"text",promptOption:[{required:!0}]},{key:"clearCache",text:"Clear Cache",info:"Helps in clearing cache which contains session details in case of any problems or bug"},{index:4,key:"customFontStyleSheet",text:"Custom Font Stylesheet file",info:"Select css file in which you have to define about your custom font.",value:this.settings.customFontStyleSheet},{key:"transparency",text:"Allow Transparent Terminal",info:"Makes terminal transparent but it will also led to slightly performance decrement",checkbox:!!this.settings.transparency},{index:0,key:"cursorBlink",text:"Cursor Blink",info:"Whether the cursor blinks.",checkbox:!!this.settings.cursorBlink},{index:1,key:"cursorStyle",text:"Cursor Style",value:this.settings.cursorStyle,info:"The style of the cursor.",select:[this.CURSOR_STYLE[0],this.CURSOR_STYLE[1],this.CURSOR_STYLE[2]]},{index:2,key:"fontSize",text:"Font Size",value:this.settings.fontSize,info:"The font size used to render text.",prompt:"Font Size",promptType:"text",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:3,key:"fontFamily",text:"Font Family",value:this.settings.fontFamily,info:"The font family used to render text.",select:this.fontsList},{index:5,key:"scrollBack",text:"Scroll Back",value:this.settings.scrollBack,info:"The amount of scrollback in the terminal. Scrollback is the amount of rows that are retained when lines are scrolled beyond the initial viewport.",prompt:"Scroll Back",promptType:"number",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:6,key:"scrollSensitivity",text:"Scroll Sensitivity",value:this.settings.scrollSensitivity,info:"The scrolling speed multiplier used for adjusting normal scrolling speed.",prompt:"Scroll Sensitivity",promptType:"number",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:7,key:"theme",text:"Theme",value:this.settings.theme,info:"Theme of terminal.",select:this.themeList},{index:8,key:"background",text:"Background Color",value:this.settings.background,color:this.settings.background},{index:8,key:"foreground",text:"Foreground Color",value:this.settings.foreground,color:this.settings.foreground},{index:9,key:"selectionBackground",text:"Selection Background Color",value:this.settings.selectionBackground,color:this.settings.selectionBackground},{key:"cursor",text:"Cursor Color",value:this.settings.cursor,color:this.settings.cursor},{key:"cursorAccent",text:"Cursor Accent Color",value:this.settings.cursorAccent,color:this.settings.cursorAccent},{index:10,key:"black",text:"Black Color",value:this.settings.black,color:this.settings.black},{index:11,key:"blue",text:"Blue Color",value:this.settings.blue,color:this.settings.blue},{index:12,key:"brightBlack",text:"Bright Black Color",value:this.settings.brightBlack,color:this.settings.brightBlack},{index:13,key:"brightBlue",text:"Bright Blue Color",value:this.settings.brightBlue,color:this.settings.brightBlue},{index:14,key:"brightCyan",text:"Bright Cyan Color",value:this.settings.brightCyan,color:this.settings.brightCyan},{index:15,key:"brightGreen",text:"Bright Green Color",value:this.settings.brightGreen,color:this.settings.brightGreen},{index:16,key:"brightMagenta",text:"Bright Magenta Color",value:this.settings.brightMagenta,color:this.settings.brightMagenta},{index:17,key:"brightRed",text:"Bright Red Color",value:this.settings.brightRed,color:this.settings.brightRed},{index:18,key:"brightWhite",text:"Bright White Color",value:this.settings.brightWhite,color:this.settings.brightWhite},{index:19,key:"brightYellow",text:"Bright Yellow Color",value:this.settings.brightYellow,color:this.settings.brightYellow},{index:20,key:"cyan",text:"Cyan Color",value:this.settings.cyan,color:this.settings.cyan},{index:21,key:"green",text:"Green Color",value:this.settings.green,color:this.settings.green},{index:22,key:"magenta",text:"Magenta Color",value:this.settings.magenta,color:this.settings.magenta},{index:23,key:"red",text:"Red Color",value:this.settings.red,color:this.settings.red},{index:24,key:"white",text:"White Color",value:this.settings.white,color:this.settings.white},{index:25,key:"yellow",text:"Yellow Color",value:this.settings.yellow,color:this.settings.yellow}],cb:(M,P)=>{M==="customFontStyleSheet"?this.setCustomFontFile():M==="theme"?(this.applyTheme(P),acode.alert("Warning","Make sure to restart app if you want any change in theme Settings.")):M==="clearCache"?this.clearCache():(this.settings[M]=P,ne.update())}}:{list:[{key:"port",text:"Server Port",value:this.settings.port,info:"Port which is displayed on termux when starting the server",prompt:"Server Port",promptType:"number",promptOption:[{required:!0}]},{key:"blurValue",text:"Blur Value(in px)",value:this.settings.blurValue,info:"Blur value for terminal in transparent mode",prompt:"Blur Value",promptType:"text",promptOption:[{required:!0}]},{key:"clearCache",text:"Clear Cache",info:"Helps in clearing cache which contains session details in case of any problems or bug"},{key:"transparency",text:"Allow Transparent Terminal",info:"Makes terminal transparent but it will also led to slightly performance decrement",checkbox:!!this.settings.transparency},{index:7,key:"customFontStyleSheet",text:"Custom Font Stylesheet file",info:"Select css file in which you have to define about your custom font.",value:this.settings.customFontStyleSheet},{index:0,key:"cursorBlink",text:"Cursor Blink",info:"Whether the cursor blinks.",checkbox:!!this.settings.cursorBlink},{index:1,key:"cursorStyle",text:"Cursor Style",value:this.settings.cursorStyle,info:"The style of the cursor.",select:[this.CURSOR_STYLE[0],this.CURSOR_STYLE[1],this.CURSOR_STYLE[2]]},{index:2,key:"fontSize",text:"Font Size",value:this.settings.fontSize,info:"The font size used to render text.",prompt:"Font Size",promptType:"text",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:3,key:"fontFamily",text:"Font Family",value:this.settings.fontFamily,info:"The font family used to render text.",select:this.fontsList},{index:4,key:"scrollBack",text:"Scroll Back",value:this.settings.scrollBack,info:"The amount of scrollback in the terminal. Scrollback is the amount of rows that are retained when lines are scrolled beyond the initial viewport.",prompt:"Scroll Back",promptType:"number",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:5,key:"scrollSensitivity",text:"Scroll Sensitivity",value:this.settings.scrollSensitivity,info:"The scrolling speed multiplier used for adjusting normal scrolling speed.",prompt:"Scroll Sensitivity",promptType:"number",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:6,key:"theme",text:"Theme",value:this.settings.theme,info:"Theme of terminal.",select:this.themeList}],cb:(M,P)=>{M==="customFontStyleSheet"?this.setCustomFontFile():M==="theme"?(this.applyTheme(P),acode.alert("Warning","Make sure to restart app if you want any change in theme Settings.")):M==="clearCache"?this.clearCache():(this.settings[M]=P,ne.update())}}}get settings(){return ne.value[le.id]}};if(window.acode){let q=new De;acode.setPluginInit(le.id,async(M,P,{cacheFileUrl:W,cacheFile:k})=>{M.endsWith("/")||(M+="/"),q.baseUrl=M,await q.init(P,k,W)},q.settingsObj),acode.setPluginUnmount(le.id,()=>{q.destroy()})}})();
